/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */
//>>built
require({cache:{"esri/layers/FeatureType":function(){define("esri/layers/FeatureType",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/lang","esri/symbols/jsonUtils","esri/layers/RangeDomain","esri/layers/CodedValueDomain","esri/layers/InheritedDomain","esri/layers/FeatureTemplate"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){var _c=_1(null,{declaredClass:"esri.layers.FeatureType",constructor:function(_d){if(_d&&_2.isObject(_d)){this.id=_d.id;this.name=_d.name;var _e=_d.symbol;if(_e){this.symbol=_7.fromJson(_e);}var _f=_d.domains,_10,i;var _11=this.domains={};for(_10 in _f){if(_f.hasOwnProperty(_10)){var _12=_f[_10];switch(_12.type){case "range":_11[_10]=new _8(_12);break;case "codedValue":_11[_10]=new _9(_12);break;case "inherited":_11[_10]=new _a(_12);break;}}}var _13=_d.templates;if(_13){var _14=this.templates=[];for(i=0;i<_13.length;i++){_14.push(new _b(_13[i]));}}}},toJson:function(){var _15={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16,_17=this.domains,_18=this.templates,_19=_6.fixJson;if(_17){var _1a=_15.domains={};for(_16 in _17){if(_17.hasOwnProperty(_16)){_1a[_16]=_17[_16]&&_17[_16].toJson();}}_19(_1a);}if(_18){_15.templates=_3.map(_18,function(_1b){return _1b.toJson();});}return _19(_15);}});if(_4("extend-esri")){_2.setObject("layers.FeatureType",_c,_5);}return _c;});},"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n","dijit/form/ComboBoxMixin":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/ComboBoxMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/kernel","dojo/_base/lang","dojo/store/util/QueryResults","./_AutoCompleterMixin","./_ComboBoxMenu","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(_1c,_1d,_1e,_1f,_20,_21,_22,_23,_24){return _1c("dijit.form.ComboBoxMixin",[_23,_21],{dropDownClass:_22,hasDownArrow:true,templateString:_24,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},_setHasDownArrowAttr:function(val){this._set("hasDownArrow",val);this._buttonNode.style.display=val?"":"none";},_showResultList:function(){this.displayMessage("");this.inherited(arguments);},_setStoreAttr:function(_25){if(!_25.get){_1f.mixin(_25,{_oldAPI:true,get:function(id){var _26=new _1d();this.fetchItemByIdentity({identity:id,onItem:function(_27){_26.resolve(_27);},onError:function(_28){_26.reject(_28);}});return _26.promise;},query:function(_29,_2a){var _2b=new _1d(function(){_2c.abort&&_2c.abort();});_2b.total=new _1d();var _2c=this.fetch(_1f.mixin({query:_29,onBegin:function(_2d){_2b.total.resolve(_2d);},onComplete:function(_2e){_2b.resolve(_2e);},onError:function(_2f){_2b.reject(_2f);}},_2a));return _20(_2b);}});}this._set("store",_25);},postMixInProperties:function(){var _30=this.params.store||this.store;if(_30){this._setStoreAttr(_30);}this.inherited(arguments);if(!this.params.store&&!this.store._oldAPI){var _31=this.declaredClass;_1f.mixin(this.store,{getValue:function(_32,_33){_1e.deprecated(_31+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return _32[_33];},getLabel:function(_34){_1e.deprecated(_31+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return _34.name;},fetch:function(_35){_1e.deprecated(_31+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");var _36=["dojo/data/ObjectStore"];require(_36,_1f.hitch(this,function(_37){new _37({objectStore:this}).fetch(_35);}));}});}}});});},"dijit/form/RangeBoundTextBox":function(){define("dijit/form/RangeBoundTextBox",["dojo/_base/declare","dojo/i18n","./MappedTextBox"],function(_38,_39,_3a){var _3b=_38("dijit.form.RangeBoundTextBox",_3a,{rangeMessage:"",rangeCheck:function(_3c,_3d){return ("min" in _3d?(this.compare(_3c,_3d.min)>=0):true)&&("max" in _3d?(this.compare(_3c,_3d.max)<=0):true);},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints);},_isDefinitelyOutOfRange:function(){var val=this.get("value");if(val==null){return false;}var _3e=false;if("min" in this.constraints){var min=this.constraints.min;_3e=this.compare(val,((typeof min=="number")&&min>=0&&val!=0)?0:min)<0;}if(!_3e&&("max" in this.constraints)){var max=this.constraints.max;_3e=this.compare(val,((typeof max!="number")||max>0)?max:0)>0;}return _3e;},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange();},isValid:function(_3f){return this.inherited(arguments)&&((this._isEmpty(this.textbox.value)&&!this.required)||this.isInRange(_3f));},getErrorMessage:function(_40){var v=this.get("value");if(v!=null&&v!==""&&(typeof v!="number"||!isNaN(v))&&!this.isInRange(_40)){return this.rangeMessage;}return this.inherited(arguments);},postMixInProperties:function(){this.inherited(arguments);if(!this.rangeMessage){this.messages=_39.getLocalization("dijit.form","validate",this.lang);this.rangeMessage=this.messages.rangeMessage;}},applyTextDir:function(){}});return _3b;});},"esri/dijit/editing/tools/Reshape":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","esri/layers/FeatureLayer","esri/tasks/query","esri/toolbars/draw","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_41,_42,_43,_44,has,_45,_46,_47,_48,_49){var _4a=_41([_48],{declaredClass:"esri.dijit.editing.tools.Reshape",id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:_47.POLYLINE,_enabled:true,_label:"NLS_reshapeLbl",activate:function(){_44.disconnect(this._rConnect);this._rConnect=_44.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_44.disconnect(this._rConnect);delete this._rConnect;},_onDrawEnd:function(_4b){var _4c=this._settings.layers;var _4d=new _46();_4d.geometry=_4b;var _4e=this._reshapeLayers=_43.filter(_4c,function(_4f){return (_4f.geometryType==="esriGeometryPolygon"||"esriGeometryPolyline");});this._settings.editor._selectionHelper.selectFeatures(_4e,_4d,_45.SELECTION_NEW,_42.hitch(this,"_reshape",_4d));},_reshape:function(_50,_51){var _52=[];var _53=_51;if(_53.length!==1){return;}this._settings.geometryService.reshape(_53[0].geometry,_50.geometry,_42.hitch(this,function(_54){var _55=[_53[0].setGeometry(_54)];this.onApplyEdits([{layer:_53[0].getLayer(),updates:_55}],_42.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}));}});if(has("extend-esri")){_42.setObject("dijit.editing.tools.Reshape",_4a,_49);}return _4a;});},"esri/dijit/editing/tools/Cut":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/DeferredList","esri/graphicsUtils","esri/graphic","esri/tasks/query","esri/layers/FeatureLayer","esri/toolbars/draw","esri/dijit/editing/Cut","esri/dijit/editing/tools/ToggleToolBase","esri/kernel"],function(_56,_57,_58,_59,has,_5a,_5b,_5c,_5d,_5e,_5f,Cut,_60,_61){var _62=_56([_60],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:_5f.POLYLINE,_enabled:true,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(_59.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments);},deactivate:function(){this.inherited(arguments);_58.forEach(this._cutConnects,_59.disconnect);this._cutConnects=[];this._edits=[];},_onDrawEnd:function(_63){var _64=this._settings.layers;var _65=this._cutLayers=_58.filter(_64,function(_66){return ((_66.geometryType==="esriGeometryPolygon")||(_66.geometryType==="esriGeometryPolyline")&&_66.visible&&_66._isMapAtVisibleScale());});this._cutConnects=this._cutConnects.concat(_58.map(_65,_57.hitch(this,function(_67){return _59.connect(_67,"onEditsComplete",_57.hitch(this,function(_68,_69,_6a){if(this._settings.undoRedoManager){var _6b=this._settings.undoRedoManager;_58.forEach(this._edits,_57.hitch(this,function(_6c){_6b.add(new Cut({featureLayer:_6c.layer,addedGraphics:_6c.adds,preUpdatedGraphics:_6c.preUpdates,postUpdatedGraphics:_6c.updates}));}),this);}this.onFinished();}));})));var _6d=new _5d();_6d.geometry=_63;_58.forEach(_65,function(_6e,idx){this._settings.editor._selectionHelper.selectFeatures([_6e],_6d,_5e.SELECTION_NEW,_57.hitch(this,"_cutFeatures",_6e,_6d));},this);},_cutFeatures:function(_6f,_70,_71){if(!_71||!_71.length){return;}this._edits=[];var _72=[];_72.push(this._settings.geometryService.cut(_5b.getGeometries(_71),_70.geometry,_57.hitch(this,"_cutHandler",_6f,_71)));var _73=new _5a(_72).addCallback(_57.hitch(this,function(){this.onApplyEdits(this._edits);}));},_cutHandler:function(_74,_75,_76){var _77=[];var _78=[];var _79=_58.map(_75,function(_7a){return new _5c(_57.clone(_7a.toJson()));});var _7b;var _7c;_58.forEach(_76.cutIndexes,function(_7d,i){if(_7b!=_7d){_7b=_7d;_78.push(_75[_7d].setGeometry(_76.geometries[i]));}else{_7c=new _5c(_76.geometries[i],null,_57.mixin({},_75[_7d].attributes),null);_7c.attributes[_75[0].getLayer().objectIdField]=null;_77.push(_7c);}},this);this._edits.push({layer:_74,adds:_77,updates:_78,preUpdates:_79});}});if(has("extend-esri")){_57.setObject("dijit.editing.tools.Cut",_62,_61);}return _62;});},"dijit/_Contained":function(){define("dijit/_Contained",["dojo/_base/declare","./registry"],function(_7e,_7f){return _7e("dijit._Contained",null,{_getSibling:function(_80){var _81=this.domNode;do{_81=_81[_80+"Sibling"];}while(_81&&_81.nodeType!=1);return _81&&_7f.byNode(_81);},getPreviousSibling:function(){return this._getSibling("previous");},getNextSibling:function(){return this._getSibling("next");},getIndexInParent:function(){var p=this.getParent();if(!p||!p.getIndexOfChild){return -1;}return p.getIndexOfChild(this);}});});},"esri/toolbars/_Box":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/matrix","esri/kernel","esri/lang","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/webMercatorUtils","esri/geometry/jsonUtils","esri/graphic"],function(_82,_83,_84,_85,has,_86,_87,_88,_89,_8a,_8b,_8c,_8d,_8e,_8f){var BOX=_82(null,{declaredClass:"esri.toolbars._Box",constructor:function(_90,map,_91,_92,_93,_94){this._graphic=_90;this._map=map;this._toolbar=_91;this._scale=_92;this._rotate=_93;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=_94;var _95=_91._options;this._markerSymbol=_95.boxHandleSymbol;this._lineSymbol=_95.boxLineSymbol;this._moveStartHandler=_83.hitch(this,this._moveStartHandler);this._firstMoveHandler=_83.hitch(this,this._firstMoveHandler);this._moveStopHandler=_83.hitch(this,this._moveStopHandler);this._moveHandler=_83.hitch(this,this._moveHandler);this._init();},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null;},refresh:function(){this._draw();},suspend:function(){_84.forEach(this._getAllGraphics(),function(g){g.hide();});},resume:function(){_84.forEach(this._getAllGraphics(),function(g){g.show();});this._draw();},_init:function(){this._draw();},_cleanUp:function(){if(this._connects){_84.forEach(this._connects,_85.disconnect);}var _96=this._toolbar._scratchGL;if(this._anchors){_84.forEach(this._anchors,function(_97){_96.remove(_97.graphic);var mov=_97.moveable;if(mov){mov.destroy();}});}if(this._box){_96.remove(this._box);}this._box=this._anchors=this._connects=null;},_draw:function(){if(!this._graphic.getDojoShape()){this._cleanUp();return;}var map=this._map,_98=this._toolbar._scratchGL;var _99=this._getBoxCoords();var _9a=new _8c(map.spatialReference);var _9b=_83.clone(_84.filter(_99,function(pt,_9c){return (_9c!==8&&_9c%2===0);}));if(_9b[0]){_9b.push([_9b[0][0],_9b[0][1]]);}_9a.addPath(_9b);if(this._rotate){_9a.addPath([_99[1],_99[8]]);}if(this._box){this._box.setGeometry(_9a);}else{this._box=new _8f(_9a,this._lineSymbol);_98.add(this._box);}if(this._anchors){_84.forEach(this._anchors,function(_9d,_9e){if(!this._scale){_9e=8;}var _9f=new _8b(_99[_9e],map.spatialReference);_9d.graphic.setGeometry(_9f);var mov=_9d.moveable,_a0=_9d.graphic.getDojoShape();if(_a0){if(!mov){_9d.moveable=this._getMoveable(_9d.graphic,_9e);}else{if(_a0!==mov.shape){mov.destroy();_9d.moveable=this._getMoveable(_9d.graphic,_9e);}}}},this);}else{this._anchors=[];this._connects=[];_84.forEach(_99,function(_a1,_a2){if(!this._scale&&_a2<8){return;}_a1=new _8b(_a1,map.spatialReference);var _a3=new _8f(_a1,this._markerSymbol);_98.add(_a3);this._anchors.push({graphic:_a3,moveable:this._getMoveable(_a3,_a2)});},this);}},_getBoxCoords:function(_a4){var _a5=this._graphic,map=this._map,_a6=this._getTransformedBoundingBox(_a5),_a7=[],pt,_a8,_a9;_84.forEach(_a6,function(_aa,_ab,arr){pt=_aa;_a8=arr[_ab+1];if(!_a8){_a8=arr[0];}_a9={x:(pt.x+_a8.x)/2,y:(pt.y+_a8.y)/2};if(!_a4){pt=map.toMap(pt);_a9=map.toMap(_a9);}_a7.push([pt.x,pt.y]);_a7.push([_a9.x,_a9.y]);});if(this._rotate){var _ac=_83.clone(_a7[1]);_ac=_a4?{x:_ac[0],y:_ac[1]}:map.toScreen({x:_ac[0],y:_ac[1],spatialReference:map.spatialReference});_ac.y-=this._toolbar._options.rotateHandleOffset;if(!_a4){_ac=map.toMap(_ac);}_a7.push([_ac.x,_ac.y]);}return _a7;},_getTransformedBoundingBox:function(_ad){var map=this._map,_ae=_ad.geometry.getExtent(),_af=_ad.geometry.spatialReference,_b0=new _8b(_ae.xmin,_ae.ymax,_af),_b1=new _8b(_ae.xmax,_ae.ymin,_af);_b0=map.toScreen(_b0);_b1=map.toScreen(_b1);return [{x:_b0.x,y:_b0.y},{x:_b1.x,y:_b0.y},{x:_b1.x,y:_b1.y},{x:_b0.x,y:_b1.y}];},_getAllGraphics:function(){var _b2=[this._box];if(this._anchors){_84.forEach(this._anchors,function(_b3){_b2.push(_b3.graphic);});}_b2=_84.filter(_b2,_8a.isDefined);return _b2;},_getMoveable:function(_b4,_b5){var _b6=_b4.getDojoShape();if(!_b6){return;}var _b7=new _87(_b6);_b7._index=_b5;this._connects.push(_85.connect(_b7,"onMoveStart",this._moveStartHandler));this._connects.push(_85.connect(_b7,"onFirstMove",this._firstMoveHandler));this._connects.push(_85.connect(_b7,"onMoveStop",this._moveStopHandler));_b7.onMove=this._moveHandler;var _b8=_b6.getEventSource();if(_b8){_86.set(_b8,"cursor",this._toolbar._cursors["box"+_b5]);}return _b7;},_moveStartHandler:function(_b9){this._toolbar["on"+(_b9.host._index===8?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic);},_firstMoveHandler:function(_ba){var _bb=_ba.host._index,_bc=(this._wrapOffset=_ba.host.shape._wrapOffsets[0]||0),_bd=this._graphic.getLayer()._div.getTransform(),mx=_88,_be,_bf,_c0,_c1=_84.map(this._getBoxCoords(true),function(arr){return {x:arr[0]+_bc,y:arr[1]};});_c0={x:_c1[1].x,y:_c1[3].y};this._centerCoord=mx.multiplyPoint(mx.invert(_bd),_c0);if(_bb===8){_be=mx.multiplyPoint(mx.invert(_bd),_c1[1]);this._startLine=[this._centerCoord,_be];this._moveLine=_83.clone(this._startLine);}else{_be=mx.multiplyPoint(mx.invert(_bd),_c1[_bb]);_bf=mx.multiplyPoint(mx.invert(_bd),_c1[(_bb+4)%8]);this._firstMoverToCenter=Math.sqrt((_be.x-this._centerCoord.x)*(_be.x-this._centerCoord.x)+(_be.y-this._centerCoord.y)*(_be.y-this._centerCoord.y));this._startBox=_bf;this._startBox.width=(_c1[4].x-_c1[0].x);this._startBox.height=(_c1[4].y-_c1[0].y);this._moveBox=_83.clone(this._startBox);this._xfactor=_be.x>_bf.x?1:-1;this._yfactor=_be.y>_bf.y?1:-1;if(_bb===1||_bb===5){this._xfactor=0;}else{if(_bb===3||_bb===7){this._yfactor=0;}}}this._toolbar._beginOperation("BOX");this._toolbar["on"+(_bb===8?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic);},_moveHandler:function(_c2,_c3){var _c4=_c2.host._index,_c5=this._defaultEventArgs,_c6,_c7,tx,pt,_c8,_c9,_ca,_cb=0,_cc=0,_cd,_ce,_cf;_c5.angle=0;_c5.scaleX=1;_c5.scaleY=1;if(_c4===8){_c6=this._startLine;_c7=this._moveLine;pt=_c7[1];pt.x+=_c3.dx;pt.y+=_c3.dy;_c8=this._getAngle(_c6,_c7);tx=_88.rotategAt(_c8,_c6[0]);this._graphic.getDojoShape().setTransform(tx);_c5.transform=tx;_c5.angle=_c8;_c5.around=_c6[0];}else{_c6=this._startBox;_c7=this._moveBox;_c7.width+=(_c3.dx*this._xfactor);_c7.height+=(_c3.dy*this._yfactor);if(this._uniformScaling){_cd=_c7.x+this._xfactor*_c7.width;_ce=_c7.y+this._yfactor*_c7.height;_cf=Math.sqrt((_cd-this._centerCoord.x)*(_cd-this._centerCoord.x)+(_ce-this._centerCoord.y)*(_ce-this._centerCoord.y));_c9=_ca=_cf/this._firstMoverToCenter;_cb=this._xfactor*_c6.width/2;_cc=this._yfactor*_c6.height/2;}else{_c9=_c7.width/_c6.width;_ca=_c7.height/_c6.height;}if(isNaN(_c9)||_c9===Infinity||_c9===-Infinity){_c9=1;}if(isNaN(_ca)||_ca===Infinity||_ca===-Infinity){_ca=1;}tx=_88.scaleAt(_c9,_ca,_c6.x+_cb,_c6.y+_cc);this._graphic.getDojoShape().setTransform(tx);_c5.transform=tx;_c5.scaleX=_c9;_c5.scaleY=_ca;_c5.around={x:_c6.x+_cb,y:_c6.y+_cc};}this._toolbar["on"+(_c4===8?this._rotateEvent:this._scaleEvent)](this._graphic,_c5);},_moveStopHandler:function(_d0){var _d1=this._graphic,_d2=this._toolbar,_d3=_d2._geo?_8d.geographicToWebMercator(_d1.geometry):_d1.geometry,_d4=_d3.spatialReference,_d5=_d1.getDojoShape(),_d6=_d5.getTransform(),_d7=_d1.getLayer()._div.getTransform();_d3=_d3.toJson();this._updateSegments(_d3.paths||_d3.rings,_d6,_d7,_d4);_d5.setTransform(null);_d3=_8e.fromJson(_d3);_d1.setGeometry(_d2._geo?_8d.webMercatorToGeographic(_d3,true):_d3);this._draw();this._startBox=this._moveBox=this._xfactor=this._yfactor=null;this._startLine=this._moveLine=null;_d2._endOperation("BOX");this._defaultEventArgs.transform=_d6;_d2["on"+(_d0.host._index===8?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs);},_updateSegments:function(_d8,_d9,_da,_db){var mx=_88,map=this._map,_dc=this._wrapOffset||0;_84.forEach(_d8,function(_dd){_84.forEach(_dd,function(_de){var _df=map.toScreen({x:_de[0],y:_de[1],spatialReference:_db},true);_df.x+=_dc;_df=mx.multiplyPoint([_da,_d9,mx.invert(_da)],_df);_df.x-=_dc;var _e0=map.toMap(_df);_de[0]=_e0.x;_de[1]=_e0.y;});});},_getAngle:function(_e1,_e2){var _e3=Math.atan2(_e1[0].y-_e1[1].y,_e1[0].x-_e1[1].x)*180/Math.PI,_e4=Math.atan2(_e2[0].y-_e2[1].y,_e2[0].x-_e2[1].x)*180/Math.PI;return _e4-_e3;}});if(has("extend-esri")){_83.setObject("toolbars._Box",BOX,_89);}return BOX;});},"dojox/grid/_View":function(){require({cache:{"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n"}});define("dojox/grid/_View",["dojo","dijit/registry","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/sniff","dojo/query","dojo/_base/window","dojo/text!./resources/View.html","dojo/dnd/Source","dijit/_Widget","dijit/_TemplatedMixin","dojox/html/metrics","./util","dojo/_base/html","./_Builder","dojo/dnd/Avatar","dojo/dnd/Manager"],function(_e5,_e6,_e7,_e8,_e9,_ea,_eb,has,_ec,win,_ed,_ee,_ef,_f0,_f1,_f2,_f3,_f4,_f5,_f6){var _f7=function(_f8,_f9){return _f8.style.cssText==undefined?_f8.getAttribute("style"):_f8.style.cssText;};var _fa=_e8("dojox.grid._View",[_ef,_f0],{defaultWidth:"18em",viewWidth:"",templateString:_ed,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:_f4._HeaderBuilder,_contentBuilderClass:_f4._ContentBuilder,postMixInProperties:function(){this.rowNodes={};},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");_f2.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);_f2.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);if(!this.grid.isLeftToRight()){this.headerNodeContainer.style.width="";}},destroy:function(){_f3.destroy(this.headerNode);delete this.headerNode;for(var i in this.rowNodes){this._cleanupRowWidgets(this.rowNodes[i]);_f3.destroy(this.rowNodes[i]);}this.rowNodes={};if(this.source){this.source.destroy();}this.inherited(arguments);},focus:function(){if(has("ie")||has("webkit")||has("opera")){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_fb){var vs=(this.structure=_fb);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||(vs.noscroll?"auto":this.viewWidth);}this._onBeforeRow=vs.onBeforeRow||function(){};this._onAfterRow=vs.onAfterRow||function(){};this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.simpleStructure=Boolean(vs.cells.length==1);this.testFlexCells();this.updateStructure();},_cleanupRowWidgets:function(_fc){if(_fc){_e9.forEach(_ec("[widgetId]",_fc).map(_e6.byNode),function(w){if(w._destroyOnRemove){w.destroy();delete w;}else{if(w.domNode&&w.domNode.parentNode){w.domNode.parentNode.removeChild(w.domNode);}}});}},onBeforeRow:function(_fd,_fe){this._onBeforeRow(_fd,_fe);if(_fd>=0){this._cleanupRowWidgets(this.getRowNode(_fd));}},onAfterRow:function(_ff,_100,_101){this._onAfterRow(_ff,_100,_101);var g=this.grid;_e9.forEach(_ec(".dojoxGridStubNode",_101),function(n){if(n&&n.parentNode){var lw=n.getAttribute("linkWidget");var _102=window.parseInt(_f3.attr(n,"cellIdx"),10);var _103=g.getCell(_102);var w=_e6.byId(lw);if(w){n.parentNode.replaceChild(w.domNode,n);if(!w._started){w.startup();}_e5.destroy(n);}else{n.innerHTML="";}}},this);},testFlexCells:function(){this.flexCells=false;for(var j=0,row;(row=this.structure.cells[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.view=this;this.flexCells=this.flexCells||cell.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){var _104=this.hasVScrollbar();var _105=_f3.style(this.scrollboxNode,"overflow");if(this.noscroll||!_105||_105=="hidden"){_104=false;}else{if(_105=="scroll"){_104=true;}}return (_104?_f1.getScrollbar().w:0);},getColumnsWidth:function(){var h=this.headerContentNode;return h&&h.firstChild?(h.firstChild.offsetWidth||_f3.style(h.firstChild,"width")):0;},setColumnsWidth:function(_106){this.headerContentNode.firstChild.style.width=_106+"px";if(this.viewWidth){this.viewWidth=_106+"px";}},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,_f3._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();if(this._togglingColumn>=0){this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn);this._togglingColumn=-1;}var _107=this.grid.layout.cells;var _108=_ea.hitch(this,function(node,_109){!this.grid.isLeftToRight()&&(_109=!_109);var inc=_109?-1:1;var idx=this.header.getCellNodeIndex(node)+inc;var cell=_107[idx];while(cell&&cell.getHeaderNode()&&cell.getHeaderNode().style.display=="none"){idx+=inc;cell=_107[idx];}if(cell){return cell.getHeaderNode();}return null;});if(this.grid.columnReordering&&this.simpleStructure){if(this.source){this.source.destroy();}var _10a="dojoxGrid_bottomMarker";var _10b="dojoxGrid_topMarker";if(this.bottomMarker){_f3.destroy(this.bottomMarker);}this.bottomMarker=_f3.byId(_10a);if(this.topMarker){_f3.destroy(this.topMarker);}this.topMarker=_f3.byId(_10b);if(!this.bottomMarker){this.bottomMarker=_f3.create("div",{"id":_10a,"class":"dojoxGridColPlaceBottom"},win.body());this._hide(this.bottomMarker);this.topMarker=_f3.create("div",{"id":_10b,"class":"dojoxGridColPlaceTop"},win.body());this._hide(this.topMarker);}this.arrowDim=_f3.contentBox(this.bottomMarker);var _10c=_f3.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new _ee(this.headerContentNode.firstChild.rows[0],{horizontal:true,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:false,onMouseDown:_ea.hitch(this,function(e){this.header.decorateEvent(e);if((this.header.overRightResizeArea(e)||this.header.overLeftResizeArea(e))&&this.header.canResize(e)&&!this.header.moveable){this.header.beginColumnResize(e);}else{if(this.grid.headerMenu){this.grid.headerMenu.onCancel(true);}if(e.button===(has("ie")<9?1:0)){_ee.prototype.onMouseDown.call(this.source,e);}}}),onMouseOver:_ea.hitch(this,function(e){var src=this.source;if(src._getChildByEvent(e)){_ee.prototype.onMouseOver.apply(src,arguments);}}),_markTargetAnchor:_ea.hitch(this,function(_10d){var src=this.source;if(src.current==src.targetAnchor&&src.before==_10d){return;}if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._removeItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}_ee.prototype._markTargetAnchor.call(src,_10d);var _10e=_10d?src.targetAnchor:_108(src.targetAnchor,src.before);var _10f=0;if(!_10e){_10e=src.targetAnchor;_10f=_f3.contentBox(_10e).w+this.arrowDim.w/2+2;}var pos=_f3.position(_10e,true);var left=Math.floor(pos.x-this.arrowDim.w/2+_10f);_f3.style(this.bottomMarker,"visibility","visible");_f3.style(this.topMarker,"visibility","visible");_f3.style(this.bottomMarker,{"left":left+"px","top":(_10c+pos.y)+"px"});_f3.style(this.topMarker,{"left":left+"px","top":(pos.y-this.arrowDim.h)+"px"});if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._addItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}}),_unmarkTargetAnchor:_ea.hitch(this,function(){var src=this.source;if(!src.targetAnchor){return;}if(src.targetAnchor&&_108(src.targetAnchor,src.before)){src._removeItemClass(_108(src.targetAnchor,src.before),src.before?"After":"Before");}this._hide(this.bottomMarker);this._hide(this.topMarker);_ee.prototype._unmarkTargetAnchor.call(src);}),destroy:_ea.hitch(this,function(){_eb.disconnect(this._source_conn);_eb.unsubscribe(this._source_sub);_ee.prototype.destroy.call(this.source);if(this.bottomMarker){_f3.destroy(this.bottomMarker);delete this.bottomMarker;}if(this.topMarker){_f3.destroy(this.topMarker);delete this.topMarker;}}),onDndCancel:_ea.hitch(this,function(){_ee.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker);})});this._source_conn=_eb.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=_eb.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup();}},_hide:function(node){_f3.style(node,{top:"-10000px","visibility":"hidden"});},_onDndDropBefore:function(_110,_111,copy){if(_f6.manager().target!==this.source){return;}this.source._targetNode=this.source.targetAnchor;this.source._beforeTarget=this.source.before;var _112=this.grid.views.views;var _113=_112[_110.viewIndex];var _114=_112[this.index];if(_114!=_113){_113.convertColPctToFixed();_114.convertColPctToFixed();}},_onDndDrop:function(_115,_116,copy){if(_f6.manager().target!==this.source){if(_f6.manager().source===this.source){this._removingColumn=true;}return;}this._hide(this.bottomMarker);this._hide(this.topMarker);var _117=function(n){return n?_f3.attr(n,"idx"):null;};var w=_f3.marginBox(_116[0]).w;if(_115.viewIndex!==this.index){var _118=this.grid.views.views;var _119=_118[_115.viewIndex];var _11a=_118[this.index];if(_119.viewWidth&&_119.viewWidth!="auto"){_119.setColumnsWidth(_119.getColumnsWidth()-w);}if(_11a.viewWidth&&_11a.viewWidth!="auto"){_11a.setColumnsWidth(_11a.getColumnsWidth());}}var stn=this.source._targetNode;var stb=this.source._beforeTarget;!this.grid.isLeftToRight()&&(stb=!stb);var _11b=this.grid.layout;var idx=this.index;delete this.source._targetNode;delete this.source._beforeTarget;_11b.moveColumn(_115.viewIndex,idx,_117(_116[0]),_117(stn),stb);},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}_f2.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode]);},_getHeaderContent:function(_11c){var n=_11c.name||_11c.grid.getCellName(_11c);if(/^\s+$/.test(n)){n="&nbsp;";}var ret=["<div class=\"dojoxGridSortNode"];if(_11c.index!=_11c.grid.getSortIndex()){ret.push("\">");}else{ret=ret.concat([" ",_11c.grid.sortInfo>0?"dojoxGridSortUp":"dojoxGridSortDown","\"><div class=\"dojoxGridArrowButtonChar\">",_11c.grid.sortInfo>0?"&#9650;":"&#9660;","</div><div class=\"dojoxGridArrowButtonNode\" role=\"presentation\"></div>","<div class=\"dojoxGridColCaption\">"]);}ret=ret.concat([n,"</div></div>"]);return ret.join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasHScrollbar:function(_11d){var _11e=this._hasHScroll||false;if(this._hasHScroll==undefined||_11d){if(this.noscroll){this._hasHScroll=false;}else{var _11f=_f3.style(this.scrollboxNode,"overflow");if(_11f=="hidden"){this._hasHScroll=false;}else{if(_11f=="scroll"){this._hasHScroll=true;}else{this._hasHScroll=(this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);}}}}if(_11e!==this._hasHScroll){this.grid.update();}return this._hasHScroll;},hasVScrollbar:function(_120){var _121=this._hasVScroll||false;if(this._hasVScroll==undefined||_120){if(this.noscroll){this._hasVScroll=false;}else{var _122=_f3.style(this.scrollboxNode,"overflow");if(_122=="hidden"){this._hasVScroll=false;}else{if(_122=="scroll"){this._hasVScroll=true;}else{this._hasVScroll=(this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);}}}}if(_121!==this._hasVScroll){this.grid.update();}return this._hasVScroll;},convertColPctToFixed:function(){var _123=false;this.grid.initialWidth="";var _124=_ec("th",this.headerContentNode);var _125=_e9.map(_124,function(c,vIdx){var w=c.style.width;_f3.attr(c,"vIdx",vIdx);if(w&&w.slice(-1)=="%"){_123=true;}else{if(w&&w.slice(-2)=="px"){return window.parseInt(w,10);}}return _f3.contentBox(c).w;});if(_123){_e9.forEach(this.grid.layout.cells,function(cell,idx){if(cell.view==this){var _126=cell.view.getHeaderCellNode(cell.index);if(_126&&_f3.hasAttr(_126,"vIdx")){var vIdx=window.parseInt(_f3.attr(_126,"vIdx"));this.setColWidth(idx,_125[vIdx]);_f3.removeAttr(_126,"vIdx");}}},this);return true;}return false;},adaptHeight:function(_127){if(!this.grid._autoHeight){var h=(this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10))||this.domNode.clientHeight;var self=this;var _128=function(){var v;for(var i in self.grid.views.views){v=self.grid.views.views[i];if(v!==self&&v.hasHScrollbar()){return true;}}return false;};if(_127||(this.noscroll&&_128())){h-=_f1.getScrollbar().h;}_f2.setStyleHeightPx(this.scrollboxNode,h);}this.hasVScrollbar(true);},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();if(!this._removingColumn){w=Math.max(w,this.getColumnsWidth())+"px";}else{w=Math.min(w,this.getColumnsWidth())+"px";this._removingColumn=false;}var cn=this.contentNode;cn.style.width=w;this.hasHScrollbar(true);},setSize:function(w,h){var ds=this.domNode.style;var hs=this.headerNode.style;if(w){ds.width=w;hs.width=w;}ds.height=(h>=0?h+"px":"");},renderRow:function(_129){var _12a=this.createRowNode(_129);this.buildRow(_129,_12a);return _12a;},createRowNode:function(_12b){var node=document.createElement("div");node.className=this.classTag+"Row";if(this instanceof _e7.grid._RowSelector){_f3.attr(node,"role","presentation");}else{_f3.attr(node,"role","row");if(this.grid.selectionMode!="none"){node.setAttribute("aria-selected","false");}}node[_f2.gridViewTag]=this.id;node[_f2.rowIndexTag]=_12b;this.rowNodes[_12b]=node;return node;},buildRow:function(_12c,_12d){this.buildRowContent(_12c,_12d);this.styleRow(_12c,_12d);},buildRowContent:function(_12e,_12f){_12f.innerHTML=this.content.generateHtml(_12e,_12e);if(this.flexCells&&this.contentWidth){_12f.firstChild.style.width=this.contentWidth;}_f2.fire(this,"onAfterRow",[_12e,this.structure.cells,_12f]);},rowRemoved:function(_130){if(_130>=0){this._cleanupRowWidgets(this.getRowNode(_130));}this.grid.edit.save(this,_130);delete this.rowNodes[_130];},getRowNode:function(_131){return this.rowNodes[_131];},getCellNode:function(_132,_133){var row=this.getRowNode(_132);if(row){return this.content.getCellNode(row,_133);}},getHeaderCellNode:function(_134){if(this.headerContentNode){return this.header.getCellNode(this.headerContentNode,_134);}},styleRow:function(_135,_136){_136._style=_f7(_136);this.styleRowNode(_135,_136);},styleRowNode:function(_137,_138){if(_138){this.doStyleRowNode(_137,_138);}},doStyleRowNode:function(_139,_13a){this.grid.styleRowNode(_139,_13a);},updateRow:function(_13b){var _13c=this.getRowNode(_13b);if(_13c){_13c.style.height="";this.buildRow(_13b,_13c);}return _13c;},updateRowStyles:function(_13d){this.styleRowNode(_13d,this.getRowNode(_13d));},lastTop:0,firstScroll:0,_nativeScroll:false,doscroll:function(_13e){if(has("ff")>=13){this._nativeScroll=true;}var _13f=this.grid.isLeftToRight();if(this.firstScroll<2){if((!_13f&&this.firstScroll==1)||(_13f&&this.firstScroll===0)){var s=_f3.marginBox(this.headerNodeContainer);if(has("ie")){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(has("mozilla")){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";this.scrollboxNode.scrollLeft=_13f?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!==this.lastTop){this.grid.scrollTo(top);}this._nativeScroll=false;},setScrollTop:function(_140){this.lastTop=_140;if(!this._nativeScroll){this.scrollboxNode.scrollTop=_140;}return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_141,_142){this.grid.setCellWidth(_141,_142+"px");},update:function(){if(!this.domNode){return;}this.content.update();this.grid.update();var left=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=left;this.headerNode.scrollLeft=left;}});var _143=_e8("dojox.grid._GridAvatar",_f5,{construct:function(){var dd=win.doc;var a=dd.createElement("table");a.cellPadding=a.cellSpacing="0";a.className="dojoxGridDndAvatar";a.style.position="absolute";a.style.zIndex=1999;a.style.margin="0px";var b=dd.createElement("tbody");var tr=dd.createElement("tr");var td=dd.createElement("td");var img=dd.createElement("td");tr.className="dojoxGridDndAvatarItem";img.className="dojoxGridDndAvatarItemImage";img.style.width="16px";var _144=this.manager.source,node;if(_144.creator){node=_144._normalizedCreator(_144.getItem(this.manager.nodes[0].id).data,"avatar").node;}else{node=this.manager.nodes[0].cloneNode(true);var _145,_146;if(node.tagName.toLowerCase()=="tr"){_145=dd.createElement("table");_146=dd.createElement("tbody");_146.appendChild(node);_145.appendChild(_146);node=_145;}else{if(node.tagName.toLowerCase()=="th"){_145=dd.createElement("table");_146=dd.createElement("tbody");var r=dd.createElement("tr");_145.cellPadding=_145.cellSpacing="0";r.appendChild(node);_146.appendChild(r);_145.appendChild(_146);node=_145;}}}node.id="";td.appendChild(node);tr.appendChild(img);tr.appendChild(td);_f3.style(tr,"opacity",0.9);b.appendChild(tr);a.appendChild(b);this.node=a;var m=_f6.manager();this.oldOffsetY=m.OFFSET_Y;m.OFFSET_Y=1;},destroy:function(){_f6.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments);}});var _147=_f6.manager().makeAvatar;_f6.manager().makeAvatar=function(){var src=this.source;if(src.viewIndex!==undefined&&!_f3.hasClass(win.body(),"dijit_a11y")){return new _143(this);}return _147.call(_f6.manager());};return _fa;});},"esri/dijit/editing/TemplatePickerItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/sniff","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojox/gfx","esri/symbols/jsonUtils","esri/kernel"],function(_148,lang,_149,has,_14a,_14b,_14c,_14d,gfx,_14e,_14f){var TPI=_148([_14c,_14d],{declaredClass:"esri.dijit.editing.TemplatePickerItem",templateString:"<div class='item' style='text-align: center;'>"+"<div class='itemSymbol' dojoAttachPoint='_surfaceNode'></div>"+"<div class='itemLabel'>${label}</div>"+"</div>",startup:function(){if(this._started){return;}this.inherited(arguments);this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);},_draw:function(node,_150,_151,_152,_153){if(!_150){return;}var _154=gfx.createSurface(node,_151,_152);if(has("ie")<9){var _155=_154.getEventSource();_14b.set(_155,"position","relative");_14b.set(_155.parentNode,"position","relative");}var _156=(!this.legendOverride&&this._getDrawingToolShape(_150,_153))||_14e.getShapeDescriptors(_150);var _157;try{_157=_154.createShape(_156.defaultShape).setFill(_156.fill).setStroke(_156.stroke);}catch(e){_154.clear();_154.destroy();return;}var bbox=_157.getBoundingBox(),_158=bbox.width,_159=bbox.height,_15a=-(bbox.x+(_158/2)),_15b=-(bbox.y+(_159/2)),dim=_154.getDimensions(),_15c={dx:_15a+dim.width/2,dy:_15b+dim.height/2};if(_158>_151||_159>_152){var _15d=_158>_159?_158:_159;var _15e=_151<_152?_151:_152;var _15f=(_15e-5)/_15d;lang.mixin(_15c,{xx:_15f,yy:_15f});}_157.applyTransform(_15c);return _154;},_getDrawingToolShape:function(_160,_161){var _162,_163=_161?_161.drawingTool||null:null;switch(_163){case "esriFeatureEditToolArrow":_162={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":_162={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":_162={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":_162={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};break;case "esriFeatureEditToolDownArrow":_162={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":_162={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":_162={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":_162={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":_162={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":if(_160.type==="simplelinesymbol"||_160.type==="cartographiclinesymbol"){_162={type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"};}else{_162={type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};}break;default:return null;}return {defaultShape:_162,fill:_160.getFill(),stroke:_160.getStroke()};},_repaint:function(_164){if(!_164){this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template);return;}if(_164.getStroke&&_164.setStroke){_164.setStroke(_164.getStroke());}if(_164.getFill&&_164.setFill){_164.setFill(_164.getFill());}if(_164.children&&lang.isArray(_164.children)){_149.forEach(_164.children,this._repaint,this);}},destroy:function(){if(this._surface){this._surface.destroy();delete this._surface;}this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePickerItem",TPI,_14f);}return TPI;});},"dojo/dnd/Selector":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../dom","../dom-construct","../mouse","../_base/NodeList","../on","../touch","./common","./Container"],function(_165,_166,_167,_168,lang,dom,_169,_16a,_16b,on,_16c,dnd,_16d){var _16e=_166("dojo.dnd.Selector",_16d,{constructor:function(node,_16f){if(!_16f){_16f={};}this.singular=_16f.singular;this.autoSync=_16f.autoSync;this.selection={};this.anchor=null;this.simpleSelection=false;this.events.push(on(this.node,_16c.press,lang.hitch(this,"onMouseDown")),on(this.node,_16c.release,lang.hitch(this,"onMouseUp")));},singular:false,getSelectedNodes:function(){var t=new _16b();var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}t.push(dom.byId(i));}return t;},selectNone:function(){return this._removeSelection()._removeAnchor();},selectAll:function(){this.forInItems(function(data,id){this._addItemClass(dom.byId(id),"Selected");this.selection[id]=1;},this);return this._removeAnchor();},deleteSelectedNodes:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var n=dom.byId(i);this.delItem(i);_169.destroy(n);}this.anchor=null;this.selection={};return this;},forInSelectedItems:function(f,o){o=o||_168.global;var s=this.selection,e=dnd._empty;for(var i in s){if(i in e){continue;}f.call(o,this.getItem(i),i,this);}},sync:function(){_16e.superclass.sync.call(this);if(this.anchor){if(!this.getItem(this.anchor.id)){this.anchor=null;}}var t=[],e=dnd._empty;for(var i in this.selection){if(i in e){continue;}if(!this.getItem(i)){t.push(i);}}_165.forEach(t,function(i){delete this.selection[i];},this);return this;},insertNodes:function(_170,data,_171,_172){var _173=this._normalizedCreator;this._normalizedCreator=function(item,hint){var t=_173.call(this,item,hint);if(_170){if(!this.anchor){this.anchor=t.node;this._removeItemClass(t.node,"Selected");this._addItemClass(this.anchor,"Anchor");}else{if(this.anchor!=t.node){this._removeItemClass(t.node,"Anchor");this._addItemClass(t.node,"Selected");}}this.selection[t.node.id]=1;}else{this._removeItemClass(t.node,"Selected");this._removeItemClass(t.node,"Anchor");}return t;};_16e.superclass.insertNodes.call(this,data,_171,_172);this._normalizedCreator=_173;return this;},destroy:function(){_16e.superclass.destroy.call(this);this.selection=this.anchor=null;},onMouseDown:function(e){if(this.autoSync){this.sync();}if(!this.current){return;}if(!this.singular&&!dnd.getCopyKeyState(e)&&!e.shiftKey&&(this.current.id in this.selection)){this.simpleSelection=true;if(_16a.isLeft(e)){_167.stop(e);}return;}if(!this.singular&&e.shiftKey){if(!dnd.getCopyKeyState(e)){this._removeSelection();}var c=this.getAllNodes();if(c.length){if(!this.anchor){this.anchor=c[0];this._addItemClass(this.anchor,"Anchor");}this.selection[this.anchor.id]=1;if(this.anchor!=this.current){var i=0,node;for(;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}}for(++i;i<c.length;++i){node=c[i];if(node==this.anchor||node==this.current){break;}this._addItemClass(node,"Selected");this.selection[node.id]=1;}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1;}}}else{if(this.singular){if(this.anchor==this.current){if(dnd.getCopyKeyState(e)){this.selectNone();}}else{this.selectNone();this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}}else{if(dnd.getCopyKeyState(e)){if(this.anchor==this.current){delete this.selection[this.anchor.id];this._removeAnchor();}else{if(this.current.id in this.selection){this._removeItemClass(this.current,"Selected");delete this.selection[this.current.id];}else{if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this._addItemClass(this.anchor,"Selected");}this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}else{if(!(this.current.id in this.selection)){this.selectNone();this.anchor=this.current;this._addItemClass(this.current,"Anchor");this.selection[this.current.id]=1;}}}}_167.stop(e);},onMouseUp:function(){if(!this.simpleSelection){return;}this.simpleSelection=false;this.selectNone();if(this.current){this.anchor=this.current;this._addItemClass(this.anchor,"Anchor");this.selection[this.current.id]=1;}},onMouseMove:function(){this.simpleSelection=false;},onOverEvent:function(){this.onmousemoveEvent=on(this.node,_16c.move,lang.hitch(this,"onMouseMove"));},onOutEvent:function(){if(this.onmousemoveEvent){this.onmousemoveEvent.remove();delete this.onmousemoveEvent;}},_removeSelection:function(){var e=dnd._empty;for(var i in this.selection){if(i in e){continue;}var node=dom.byId(i);if(node){this._removeItemClass(node,"Selected");}}this.selection={};return this;},_removeAnchor:function(){if(this.anchor){this._removeItemClass(this.anchor,"Anchor");this.anchor=null;}return this;}});return _16e;});},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(_174){return function(_175,_176){switch(typeof _175){default:throw new Error("Can not query with a "+typeof _175);case "object":case "undefined":var _177=_175;_175=function(_178){for(var key in _177){var _179=_177[key];if(_179&&_179.test){if(!_179.test(_178[key],_178)){return false;}}else{if(_179!=_178[key]){return false;}}}return true;};break;case "string":if(!this[_175]){throw new Error("No filter function "+_175+" was found in store");}_175=this[_175];case "function":}function _17a(_17b){var _17c=_174.filter(_17b,_175);var _17d=_176&&_176.sort;if(_17d){_17c.sort(typeof _17d=="function"?_17d:function(a,b){for(var sort,i=0;sort=_17d[i];i++){var _17e=a[sort.attribute];var _17f=b[sort.attribute];if(_17e!=_17f){return !!sort.descending==(_17e==null||_17e>_17f)?-1:1;}}return 0;});}if(_176&&(_176.start||_176.count)){var _180=_17c.length;_17c=_17c.slice(_176.start||0,(_176.start||0)+(_176.count||Infinity));_17c.total=_180;}return _17c;};_17a.matches=_175;return _17a;};});},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","esri/toolbars/draw","esri/kernel"],function(lang,has,Draw,_181){var _182={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",_drawType:Draw.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:Draw.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:Draw.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:Draw.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:Draw.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:Draw.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:Draw.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:Draw.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:Draw.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:Draw.LEFT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:Draw.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:Draw.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",_drawType:Draw.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:Draw.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:false,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",_enabled:false,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:false,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:false,_label:"NLS_redoLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.EditingTools",_182,_181);}return _182;});},"dijit/ProgressBar":function(){require({cache:{"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"}});define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_183,_184,_185,lang,_186,_187,_188,_189){return _184("dijit.ProgressBar",[_187,_188],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_189,_indeterminateHighContrastImagePath:_183.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!(this.params&&"value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_18a){lang.mixin(this,_18a||{});var tip=this.internalProgress,ap=this.domNode;var _18b=1;if(this.indeterminate){ap.removeAttribute("aria-valuenow");}else{if(String(this.progress).indexOf("%")!=-1){_18b=Math.min(parseFloat(this.progress)/100,1);this.progress=_18b*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_18b=this.maximum?this.progress/this.maximum:0;}ap.setAttribute("aria-valuenow",this.progress);}ap.setAttribute("aria-describedby",this.labelNode.id);ap.setAttribute("aria-valuemin",0);ap.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(_18b);_185.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_18b*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_18c){this._set("label",_18c);this.update();},_setIndeterminateAttr:function(_18d){this.indeterminate=_18d;this.update();},report:function(_18e){return this.label?this.label:(this.indeterminate?"&#160;":_186.format(_18e,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});});},"dijit/Toolbar":function(){define("dijit/Toolbar",["require","dojo/_base/declare","dojo/has","dojo/keys","dojo/ready","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_18f,_190,has,keys,_191,_192,_193,_194){if(has("dijit-legacy-requires")){_191(0,function(){var _195=["dijit/ToolbarSeparator"];_18f(_195);});}return _190("dijit.Toolbar",[_192,_194,_193],{templateString:"<div class=\"dijit\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">"+"</div>",baseClass:"dijitToolbar",postCreate:function(){this.inherited(arguments);this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW]:[keys.RIGHT_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW]:[keys.LEFT_ARROW]);}});});},"esri/dijit/editing/toolbars/Drawing":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/_CssStateMixin","esri/dijit/editing/Util","esri/dijit/editing/toolbars/ToolbarBase","esri/dijit/editing/tools/ButtonToolBase","esri/dijit/editing/tools/Cut","esri/dijit/editing/tools/Union","esri/dijit/editing/tools/Reshape","esri/dijit/editing/tools/Editing","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/Selection","esri/dijit/editing/tools/SelectionTools","esri/kernel"],function(_196,lang,_197,_198,has,_199,_19a,_19b,_19c,Cut,_19d,_19e,_19f,_1a0,_1a1,_1a2,_1a3){var _1a4=_196([_19b,_199],{declaredClass:"esri.dijit.editing.toolbars.Drawing",onShowAttributeInspector:function(){},_activateTool:function(tool,_1a5){this._settings.editor._activeTool=tool;if(tool!=="EDITING"){this._settings.templatePicker.clearSelection();}if(tool!=="ATTRIBUTES"){this._settings.editor._hideAttributeInspector();}if(tool==="CLEAR"){return;}this.inherited(arguments);},_initializeToolbar:function(){var _1a6=this._settings.layers;_197.forEach(_1a6,function(_1a7){this._tbConnects.push(_198.connect(_1a7,"onSelectionComplete",this,"_updateUI"));},this);},activateEditing:function(_1a8,_1a9){this._tools.EDITING._activateTool(_1a8,_1a9.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(true);},_updateUI:function(){if(this._settings.undoManager){this._tools.UNDO.set("disabled",this._settings.undoManager.canUndo===false);this._tools.REDO.set("disabled",this._settings.undoManager.canRedo===false);}this._selectedFeatures=_19a.getSelection(this._settings.layers);var _1aa=this._selectedFeatures.length;if(this._tools.DELETE){this._tools.DELETE.set("disabled",_1aa<=0);}if(this._tools.CLEAR){this._tools.CLEAR.set("disabled",_1aa<=0);}if(this._tools.ATTRIBUTES){this._tools.ATTRIBUTES.set("disabled",_1aa<=0);}if(this._tools.UNION){this._tools.UNION.set("disabled",_1aa<2);}},_toolFinished:function(tool){if(tool==="ATTRIBUTES"&&(this._selectedFeatures&&this._selectedFeatures.length)){this.onShowAttributeInspector(this._selectedFeatures[0]);}if(tool==="SELECT"||tool==="CUT"||tool==="RESHAPING"||tool==="EDITING"){this._activeTool.deactivate();this._activeTool.setChecked(false);this._activeTool=null;}if(tool==="DELETE"){this.onDelete();}this._updateUI();},_createTools:function(){this._tools.SELECT=new _1a1({settings:this._settings,onClick:lang.hitch(this,"_activateTool","SELECT",true),onFinished:lang.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new _19c(lang.mixin(_1a2.selectClear,{settings:this._settings,onClick:lang.hitch(this._settings.editor,"_clearSelection",false)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new _19c(lang.mixin(_1a0.attributes,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new _19f({settings:this._settings,onClick:lang.hitch(this,"_activateTool","EDITING",true),onApplyEdits:lang.hitch(this,"onApplyEdits"),onFinished:lang.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new _19c(lang.mixin(_1a0.del,{settings:this._settings,onClick:lang.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);if(this._settings.toolbarOptions){if(this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible){this._createSeparator();}if(this._settings.toolbarOptions.cutVisible){this._tools.CUT=new Cut({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","CUT"),onClick:lang.hitch(this,"_activateTool","CUT",true),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.CUT);}if(this._settings.toolbarOptions.mergeVisible){this._tools.UNION=new _19d({settings:this._settings,onFinished:lang.hitch(this,"_toolFinished","UNION"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.UNION);}if(this._settings.toolbarOptions.reshapeVisible){this._tools.RESHAPING=new _19e({settings:this._settings,onClick:lang.hitch(this,"_activateTool","RESHAPING",true),onFinished:lang.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:lang.hitch(this,"onApplyEdits")});this.addChild(this._tools.RESHAPING);}}if(this._settings.enableUndoRedo){this._createSeparator();this._tools.UNDO=new _19c(lang.mixin(_1a0.undo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._undo();})}));this.addChild(this._tools.UNDO);this._tools.REDO=new _19c(lang.mixin(_1a0.redo,{settings:this._settings,onClick:lang.hitch(this,function(){this._tools.UNDO.set("disabled",true);this._tools.REDO.set("disabled",true);this._settings.editor._redo();})}));this.addChild(this._tools.REDO);}}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.Drawing",_1a4,_1a3);}return _1a4;});},"url:esri/dijit/templates/AttributeInspector.html":"<div class=\"esriAttributeInspector\">\r\n    <div class=\"atiLayerName\" dojoAttachPoint=\"layerName\"></div>\r\n    <div class=\"atiAttributes\" dojoAttachPoint=\"attributeTable\"></div>\r\n    <div dojoAttachPoint=\"attachmentEditor\"></div>\r\n    <div class=\"atiEditorTrackingInfo\" dojoAttachPoint=\"editorTrackingInfoDiv\"></div>\r\n    <div class=\"atiButtons\" dojoAttachPoint=\"editButtons\">\r\n        <button  dojoType=\"dijit.form.Button\" class=\"atiButton atiDeleteButton\"  dojoAttachPoint=\"deleteBtn\" dojoAttachEvent=\"onClick: onDeleteBtn\" showLabel=\"true\" type=\"button\">${NLS_deleteFeature}</button>\r\n        <div class=\"atiNavButtons\" dojoAttachPoint=\"navButtons\">\r\n            <div class=\"atiNavMessage\" dojoAttachPoint=\"navMessage\"></div>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiFirstIcon\" dojoAttachPoint=\"firstFeatureButton\" dojoAttachEvent=\"onClick: onFirstFeature\" showLabel=\"false\" type=\"button\">${NLS_first}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiPrevIcon\" dojoAttachPoint=\"prevFeatureButton\" dojoAttachEvent=\"onClick: onPreviousFeature\" showLabel=\"false\" type=\"button\">${NLS_previous}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiNextIcon\" dojoAttachPoint=\"nextFeatureButton\" dojoAttachEvent=\"onClick: onNextFeature\" showLabel=\"false\" type=\"button\">${NLS_next}</button>\r\n            <button  dojoType=\"dijit.form.Button\" iconClass=\"atiButton atiLastIcon\" dojoAttachPoint=\"lastFeatureButton\" dojoAttachEvent=\"onClick: onLastFeature\" showLabel=\"false\" type=\"button\">${NLS_last}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","dojox/grid/DataSelection":function(){define("dojox/grid/DataSelection",["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(_1ab,_1ac,_1ad){return _1ab("dojox.grid.DataSelection",_1ad,{constructor:function(grid){if(grid.keepSelection){this.preserver=new _1ac(this);}},destroy:function(){if(this.preserver){this.preserver.destroy();}},getFirstSelected:function(){var idx=_1ad.prototype.getFirstSelected.call(this);if(idx==-1){return null;}return this.grid.getItem(idx);},getNextSelected:function(_1ae){var _1af=this.grid.getItemIndex(_1ae);var idx=_1ad.prototype.getNextSelected.call(this,_1af);if(idx==-1){return null;}return this.grid.getItem(idx);},getSelected:function(){var _1b0=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_1b0.push(this.grid.getItem(i));}}return _1b0;},addToSelection:function(_1b1){if(this.mode=="none"){return;}var idx=null;if(typeof _1b1=="number"||typeof _1b1=="string"){idx=_1b1;}else{idx=this.grid.getItemIndex(_1b1);}_1ad.prototype.addToSelection.call(this,idx);},deselect:function(_1b2){if(this.mode=="none"){return;}var idx=null;if(typeof _1b2=="number"||typeof _1b2=="string"){idx=_1b2;}else{idx=this.grid.getItemIndex(_1b2);}_1ad.prototype.deselect.call(this,idx);},deselectAll:function(_1b3){var idx=null;if(_1b3||typeof _1b3=="number"){if(typeof _1b3=="number"||typeof _1b3=="string"){idx=_1b3;}else{idx=this.grid.getItemIndex(_1b3);}_1ad.prototype.deselectAll.call(this,idx);}else{this.inherited(arguments);}}});});},"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n","dojo/dnd/Manager":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/lang","../_base/window","../dom-class","../Evented","../has","../keys","../on","../topic","../touch","./common","./autoscroll","./Avatar"],function(_1b4,_1b5,_1b6,lang,win,_1b7,_1b8,has,keys,on,_1b9,_1ba,dnd,_1bb,_1bc){var _1bd=_1b5("dojo.dnd.Manager",[_1b8],{constructor:function(){this.avatar=null;this.source=null;this.nodes=[];this.copy=true;this.target=null;this.canDropFlag=false;this.events=[];},OFFSET_X:has("touch")?0:16,OFFSET_Y:has("touch")?-64:16,overSource:function(_1be){if(this.avatar){this.target=(_1be&&_1be.targetState!="Disabled")?_1be:null;this.canDropFlag=Boolean(this.target);this.avatar.update();}_1b9.publish("/dnd/source/over",_1be);},outSource:function(_1bf){if(this.avatar){if(this.target==_1bf){this.target=null;this.canDropFlag=false;this.avatar.update();_1b9.publish("/dnd/source/over",null);}}else{_1b9.publish("/dnd/source/over",null);}},startDrag:function(_1c0,_1c1,copy){_1bb.autoScrollStart(win.doc);this.source=_1c0;this.nodes=_1c1;this.copy=Boolean(copy);this.avatar=this.makeAvatar();win.body().appendChild(this.avatar.node);_1b9.publish("/dnd/start",_1c0,_1c1,this.copy);this.events=[on(win.doc,_1ba.move,lang.hitch(this,"onMouseMove")),on(win.doc,_1ba.release,lang.hitch(this,"onMouseUp")),on(win.doc,"keydown",lang.hitch(this,"onKeyDown")),on(win.doc,"keyup",lang.hitch(this,"onKeyUp")),on(win.doc,"dragstart",_1b6.stop),on(win.body(),"selectstart",_1b6.stop)];var c="dojoDnd"+(copy?"Copy":"Move");_1b7.add(win.body(),c);},canDrop:function(flag){var _1c2=Boolean(this.target&&flag);if(this.canDropFlag!=_1c2){this.canDropFlag=_1c2;this.avatar.update();}},stopDrag:function(){_1b7.remove(win.body(),["dojoDndCopy","dojoDndMove"]);_1b4.forEach(this.events,function(_1c3){_1c3.remove();});this.events=[];this.avatar.destroy();this.avatar=null;this.source=this.target=null;this.nodes=[];},makeAvatar:function(){return new _1bc(this);},updateAvatar:function(){this.avatar.update();},onMouseMove:function(e){var a=this.avatar;if(a){_1bb.autoScrollNodes(e);var s=a.node.style;s.left=(e.pageX+this.OFFSET_X)+"px";s.top=(e.pageY+this.OFFSET_Y)+"px";var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));if(this.copy!=copy){this._setCopyStatus(copy);}}if(has("touch")){e.preventDefault();}},onMouseUp:function(e){if(this.avatar){if(this.target&&this.canDropFlag){var copy=Boolean(this.source.copyState(dnd.getCopyKeyState(e)));_1b9.publish("/dnd/drop/before",this.source,this.nodes,copy,this.target,e);_1b9.publish("/dnd/drop",this.source,this.nodes,copy,this.target,e);}else{_1b9.publish("/dnd/cancel");}this.stopDrag();}},onKeyDown:function(e){if(this.avatar){switch(e.keyCode){case keys.CTRL:var copy=Boolean(this.source.copyState(true));if(this.copy!=copy){this._setCopyStatus(copy);}break;case keys.ESCAPE:_1b9.publish("/dnd/cancel");this.stopDrag();break;}}},onKeyUp:function(e){if(this.avatar&&e.keyCode==keys.CTRL){var copy=Boolean(this.source.copyState(false));if(this.copy!=copy){this._setCopyStatus(copy);}}},_setCopyStatus:function(copy){this.copy=copy;this.source._markDndStatus(this.copy);this.updateAvatar();_1b7.replace(win.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"));}});dnd._manager=null;_1bd.manager=dnd.manager=function(){if(!dnd._manager){dnd._manager=new _1bd();}return dnd._manager;};return _1bd;});},"dojox/grid/_RowSelector":function(){define("dojox/grid/_RowSelector",["dojo/_base/declare","./_View"],function(_1c4,_1c5){return _1c4("dojox.grid._RowSelector",_1c5,{defaultWidth:"2em",noscroll:true,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility="hidden";},getWidth:function(){return this.viewWidth||this.defaultWidth;},buildRowContent:function(_1c6,_1c7){var w=this.contentWidth||0;_1c7.innerHTML="<table class=\"dojoxGridRowbarTable\" style=\"width:"+w+"px;height:1px;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"><tr><td class=\"dojoxGridRowbarInner\">&nbsp;</td></tr></table>";},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight();},adaptWidth:function(){if(!("contentWidth" in this)&&this.contentNode&&this.contentNode.offsetWidth>0){this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth;}},doStyleRowNode:function(_1c8,_1c9){var n=["dojoxGridRowbar dojoxGridNonNormalizedCell"];if(this.grid.rows.isOver(_1c8)){n.push("dojoxGridRowbarOver");}if(this.grid.selection.isSelected(_1c8)){n.push("dojoxGridRowbarSelected");}_1c9.className=n.join(" ");},domouseover:function(e){this.grid.onMouseOverRow(e);},domouseout:function(e){if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}});});},"dojox/grid/_Layout":function(){define("dojox/grid/_Layout",["dojo/_base/kernel","../main","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-geometry","./cells","./_RowSelector"],function(dojo,_1ca,_1cb,_1cc,lang,_1cd){return _1cb("dojox.grid._Layout",null,{constructor:function(_1ce){this.grid=_1ce;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_1cf,_1d0,_1d1,_1d2,_1d3){var _1d4=this.structure[_1cf].cells[0];var _1d5=this.structure[_1d0].cells[0];var cell=null;var _1d6=0;var _1d7=0;for(var i=0,c;c=_1d4[i];i++){if(c.index==_1d1){_1d6=i;break;}}cell=_1d4.splice(_1d6,1)[0];cell.view=this.grid.views.views[_1d0];for(i=0,c=null;c=_1d5[i];i++){if(c.index==_1d2){_1d7=i;break;}}if(!_1d3){_1d7+=1;}_1d5.splice(_1d7,0,cell);var _1d8=this.grid.getCell(this.grid.getSortIndex());if(_1d8){_1d8._currentlySorted=this.grid.getSortAsc();}this.cells=[];_1d1=0;var v;for(i=0;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0;c=cs[k];k++){c.index=_1d1;this.cells.push(c);if("_currentlySorted" in c){var si=_1d1+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_1d1++;}}}_1cc.forEach(this.cells,function(c){var _1d9=c.markup[2].split(" ");var _1da=parseInt(_1d9[1].substring(5));if(_1da!=c.index){_1d9[1]="idx=\""+c.index+"\"";c.markup[2]=_1d9.join(" ");}});this.grid.setupHeaderMenu();},setColumnVisibility:function(_1db,_1dc){var cell=this.cells[_1db];if(cell.hidden==_1dc){cell.hidden=!_1dc;var v=cell.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_1cd.getMarginBox(cell.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_1dd,_1de,_1df){var self=this;var _1e0=function(_1e1){var w=0;if(_1e1.colSpan>1){w=0;}else{w=_1e1.width||self._defaultCellProps.width||self.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _1e2={grid:this.grid,subrow:_1dd,layoutIndex:_1de,index:this.cells.length};if(_1df&&_1df instanceof _1ca.grid.cells._Base){var _1e3=lang.clone(_1df);_1e2.unitWidth=_1e0(_1e3._props);_1e3=lang.mixin(_1e3,this._defaultCellProps,_1df._props,_1e2);return _1e3;}var _1e4=_1df.type||_1df.cellType||this._defaultCellProps.type||this._defaultCellProps.cellType||_1ca.grid.cells.Cell;if(lang.isString(_1e4)){_1e4=lang.getObject(_1e4);}_1e2.unitWidth=_1e0(_1df);return new _1e4(lang.mixin({},this._defaultCellProps,_1df,_1e2));},addRowDef:function(_1e5,_1e6){var _1e7=[];var _1e8=0,_1e9=0,_1ea=true;for(var i=0,def,cell;(def=_1e6[i]);i++){cell=this.addCellDef(_1e5,i,def);_1e7.push(cell);this.cells.push(cell);if(_1ea&&cell.relWidth){_1e8+=cell.relWidth;}else{if(cell.width){var w=cell.width;if(typeof w=="string"&&w.slice(-1)=="%"){_1e9+=window.parseInt(w,10);}else{if(w=="auto"){_1ea=false;}}}}}if(_1e8&&_1ea){_1cc.forEach(_1e7,function(cell){if(cell.relWidth){cell.width=cell.unitWidth=((cell.relWidth/_1e8)*(100-_1e9))+"%";}});}return _1e7;},addRowsDef:function(_1eb){var _1ec=[];if(lang.isArray(_1eb)){if(lang.isArray(_1eb[0])){for(var i=0,row;_1eb&&(row=_1eb[i]);i++){_1ec.push(this.addRowDef(i,row));}}else{_1ec.push(this.addRowDef(0,_1eb));}}return _1ec;},addViewDef:function(_1ed){this._defaultCellProps=_1ed.defaultCell||{};if(_1ed.width&&_1ed.width=="auto"){delete _1ed.width;}return lang.mixin({},_1ed,{cells:this.addRowsDef(_1ed.rows||_1ed.cells)});},setStructure:function(_1ee){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_1ca._scopeName+".grid._RowSelector"};if(lang.isString(this.grid.rowSelector)){var _1ef=this.grid.rowSelector;if(_1ef=="false"){sel=null;}else{if(_1ef!="true"){sel["width"]=_1ef;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _1f0=function(def){return ("name" in def||"field" in def||"get" in def);};var _1f1=function(def){if(lang.isArray(def)){if(lang.isArray(def[0])||_1f0(def[0])){return true;}}return false;};var _1f2=function(def){return (def!==null&&lang.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_1f0(def))));};if(lang.isArray(_1ee)){var _1f3=false;for(var i=0,st;(st=_1ee[i]);i++){if(_1f2(st)){_1f3=true;break;}}if(!_1f3){s.push(this.addViewDef({cells:_1ee}));}else{for(i=0;(st=_1ee[i]);i++){if(_1f1(st)){s.push(this.addViewDef({cells:st}));}else{if(_1f2(st)){s.push(this.addViewDef(st));}}}}}else{if(_1f2(_1ee)){s.push(this.addViewDef(_1ee));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});});},"dijit/Editor":function(){define("dijit/Editor",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/i18n","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/string","dojo/topic","dojo/_base/window","./_base/focus","./_Container","./Toolbar","./ToolbarSeparator","./layout/_LayoutWidget","./form/ToggleButton","./_editor/_Plugin","./_editor/plugins/EnterKeyHandling","./_editor/html","./_editor/range","./_editor/RichText","./main","dojo/i18n!./_editor/nls/commands"],function(_1f4,_1f5,_1f6,_1f7,i18n,_1f8,_1f9,_1fa,_1fb,_1fc,keys,lang,has,_1fd,_1fe,win,_1ff,_200,_201,_202,_203,_204,_205,_206,html,_207,_208,_209){var _20a=_1f6("dijit.Editor",_208,{plugins:null,extraPlugins:null,constructor:function(){if(!lang.isArray(this.plugins)){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",_206];}this._plugins=[];this._editInterval=this.editActionInterval*1000;if(has("ie")){this.events.push("onBeforeDeactivate");this.events.push("onBeforeActivate");}},postMixInProperties:function(){this.setValueDeferred=new _1f7();this.inherited(arguments);},postCreate:function(){this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);if(lang.isArray(this.extraPlugins)){this.plugins=this.plugins.concat(this.extraPlugins);}this.inherited(arguments);this.commands=i18n.getLocalization("dijit._editor","commands",this.lang);if(!this.toolbar){this.toolbar=new _201({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang});this.header.appendChild(this.toolbar.domNode);}_1f5.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(true);_1f9.add(this.iframe.parentNode,"dijitEditorIFrameContainer");_1f9.add(this.iframe,"dijitEditorIFrame");_1f8.set(this.iframe,"allowTransparency",true);if(has("webkit")){_1fb.set(this.domNode,"KhtmlUserSelect","none");}this.toolbar.startup();this.onNormalizedDisplayChanged();},destroy:function(){_1f5.forEach(this._plugins,function(p){if(p&&p.destroy){p.destroy();}});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments);},addPlugin:function(_20b,_20c){var args=lang.isString(_20b)?{name:_20b}:lang.isFunction(_20b)?{ctor:_20b}:_20b;if(!args.setEditor){var o={"args":args,"plugin":null,"editor":this};if(args.name){if(_205.registry[args.name]){o.plugin=_205.registry[args.name](args);}else{_1fe.publish(_209._scopeName+".Editor.getPlugin",o);}}if(!o.plugin){try{var pc=args.ctor||lang.getObject(args.name)||_1f4(args.name);if(pc){o.plugin=new pc(args);}}catch(e){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}}if(!o.plugin){throw new Error(this.id+": cannot find plugin ["+args.name+"]");}_20b=o.plugin;}if(arguments.length>1){this._plugins[_20c]=_20b;}else{this._plugins.push(_20b);}_20b.setEditor(this);if(lang.isFunction(_20b.setToolbar)){_20b.setToolbar(this.toolbar);}},resize:function(size){if(size){_203.prototype.resize.apply(this,arguments);}},layout:function(){var _20d=(this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+_1fa.getPadBorderExtents(this.iframe.parentNode).h+_1fa.getMarginExtents(this.iframe.parentNode).h));this.editingArea.style.height=_20d+"px";if(this.iframe){this.iframe.style.height="100%";}this._layoutMode=true;},_onIEMouseDown:function(e){var _20e;var b=this.document.body;var _20f=b.clientWidth;var _210=b.clientHeight;var _211=b.clientLeft;var _212=b.offsetWidth;var _213=b.offsetHeight;var _214=b.offsetLeft;if(/^rtl$/i.test(b.dir||"")){if(_20f<_212&&e.x>_20f&&e.x<_212){_20e=true;}}else{if(e.x<_211&&e.x>_214){_20e=true;}}if(!_20e){if(_210<_213&&e.y>_210&&e.y<_213){_20e=true;}}if(!_20e){delete this._cursorToStart;delete this._savedSelection;if(e.target.tagName=="BODY"){this.defer("placeCursorAtEnd");}this.inherited(arguments);}},onBeforeActivate:function(){this._restoreSelection();},onBeforeDeactivate:function(e){if(this.customUndo){this.endEditing(true);}if(e.target.tagName!="BODY"){this._saveSelection();}},customUndo:true,editActionInterval:3,beginEditing:function(cmd){if(!this._inEditing){this._inEditing=true;this._beginEditing(cmd);}if(this.editActionInterval>0){if(this._editTimer){this._editTimer.remove();}this._editTimer=this.defer("endEditing",this._editInterval);}},_steps:[],_undoedSteps:[],execCommand:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return this[cmd]();}else{if(this.customUndo){this.endEditing();this._beginEditing();}var r=this.inherited(arguments);if(this.customUndo){this._endEditing();}return r;}},_pasteImpl:function(){return this._clipboardCommand("paste");},_cutImpl:function(){return this._clipboardCommand("cut");},_copyImpl:function(){return this._clipboardCommand("copy");},_clipboardCommand:function(cmd){var r;try{r=this.document.execCommand(cmd,false,null);if(has("webkit")&&!r){throw {code:1011};}}catch(e){if(e.code==1011||(e.code==9&&has("opera"))){var sub=_1fd.substitute,_215={cut:"X",copy:"C",paste:"V"};alert(sub(this.commands.systemShortcut,[this.commands[cmd],sub(this.commands[has("mac")?"appleKey":"ctrlKey"],[_215[cmd]])]));}r=false;}return r;},queryCommandEnabled:function(cmd){if(this.customUndo&&(cmd=="undo"||cmd=="redo")){return cmd=="undo"?(this._steps.length>1):(this._undoedSteps.length>0);}else{return this.inherited(arguments);}},_moveToBookmark:function(b){var _216=b.mark;var mark=b.mark;var col=b.isCollapsed;var r,_217,_218,sel;if(mark){if(has("ie")<9){if(lang.isArray(mark)){_216=[];_1f5.forEach(mark,function(n){_216.push(_207.getNode(n,this.editNode));},this);win.withGlobal(this.window,"moveToBookmark",_1ff,[{mark:_216,isCollapsed:col}]);}else{if(mark.startContainer&&mark.endContainer){sel=_207.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_207.create(this.window);_217=_207.getNode(mark.startContainer,this.editNode);_218=_207.getNode(mark.endContainer,this.editNode);if(_217&&_218){r.setStart(_217,mark.startOffset);r.setEnd(_218,mark.endOffset);sel.addRange(r);}}}}}else{sel=_207.getSelection(this.window);if(sel&&sel.removeAllRanges){sel.removeAllRanges();r=_207.create(this.window);_217=_207.getNode(mark.startContainer,this.editNode);_218=_207.getNode(mark.endContainer,this.editNode);if(_217&&_218){r.setStart(_217,mark.startOffset);r.setEnd(_218,mark.endOffset);sel.addRange(r);}}}}},_changeToStep:function(from,to){this.setValue(to.text);var b=to.bookmark;if(!b){return;}this._moveToBookmark(b);},undo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._steps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(s,this._steps[this._steps.length-1]);this._undoedSteps.push(s);this.onDisplayChanged();delete this._undoRedoActive;ret=true;}delete this._undoRedoActive;}return ret;},redo:function(){var ret=false;if(!this._undoRedoActive){this._undoRedoActive=true;this.endEditing(true);var s=this._undoedSteps.pop();if(s&&this._steps.length>0){this.focus();this._changeToStep(this._steps[this._steps.length-1],s);this._steps.push(s);this.onDisplayChanged();ret=true;}delete this._undoRedoActive;}return ret;},endEditing:function(_219){if(this._editTimer){this._editTimer=this._editTimer.remove();}if(this._inEditing){this._endEditing(_219);this._inEditing=false;}},_getBookmark:function(){var b=win.withGlobal(this.window,_1ff.getBookmark);var tmp=[];if(b&&b.mark){var mark=b.mark;if(has("ie")<9){var sel=_207.getSelection(this.window);if(!lang.isArray(mark)){if(sel){var _21a;if(sel.rangeCount){_21a=sel.getRangeAt(0);}if(_21a){b.mark=_21a.cloneRange();}else{b.mark=win.withGlobal(this.window,_1ff.getBookmark);}}}else{_1f5.forEach(b.mark,function(n){tmp.push(_207.getIndex(n,this.editNode).o);},this);b.mark=tmp;}}try{if(b.mark&&b.mark.startContainer){tmp=_207.getIndex(b.mark.startContainer,this.editNode).o;b.mark={startContainer:tmp,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?tmp:_207.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset};}}catch(e){b.mark=null;}}return b;},_beginEditing:function(){if(this._steps.length===0){this._steps.push({"text":html.getChildrenHtml(this.editNode),"bookmark":this._getBookmark()});}},_endEditing:function(){var v=html.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:v,bookmark:this._getBookmark()});},onKeyDown:function(e){if(!has("ie")&&!this.iframe&&e.keyCode==keys.TAB&&!this.tabIndent){this._saveSelection();}if(!this.customUndo){this.inherited(arguments);return;}var k=e.keyCode;if(e.ctrlKey&&!e.altKey){if(k==90||k==122){_1fc.stop(e);this.undo();return;}else{if(k==89||k==121){_1fc.stop(e);this.redo();return;}}}this.inherited(arguments);switch(k){case keys.ENTER:case keys.BACKSPACE:case keys.DELETE:this.beginEditing();break;case 88:case 86:if(e.ctrlKey&&!e.altKey&&!e.metaKey){this.endEditing();if(e.keyCode==88){this.beginEditing("cut");}else{this.beginEditing("paste");}this.defer("endEditing",1);break;}default:if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.keyCode<keys.F1||e.keyCode>keys.F15)){this.beginEditing();break;}case keys.ALT:this.endEditing();break;case keys.UP_ARROW:case keys.DOWN_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:case keys.HOME:case keys.END:case keys.PAGE_UP:case keys.PAGE_DOWN:this.endEditing(true);break;case keys.CTRL:case keys.SHIFT:case keys.TAB:break;}},_onBlur:function(){this.inherited(arguments);this.endEditing(true);},_saveSelection:function(){try{this._savedSelection=this._getBookmark();}catch(e){}},_restoreSelection:function(){if(this._savedSelection){delete this._cursorToStart;if(win.withGlobal(this.window,"isCollapsed",_1ff)){this._moveToBookmark(this._savedSelection);}delete this._savedSelection;}},onClick:function(){this.endEditing(true);this.inherited(arguments);},replaceValue:function(html){if(!this.customUndo){this.inherited(arguments);}else{if(this.isClosed){this.setValue(html);}else{this.beginEditing();if(!html){html="&#160;";}this.setValue(html);this.endEditing();}}},_setDisabledAttr:function(_21b){this.setValueDeferred.then(lang.hitch(this,function(){if((!this.disabled&&_21b)||(!this._buttonEnabledPlugins&&_21b)){_1f5.forEach(this._plugins,function(p){p.set("disabled",true);});}else{if(this.disabled&&!_21b){_1f5.forEach(this._plugins,function(p){p.set("disabled",false);});}}}));this.inherited(arguments);},_setStateClass:function(){try{this.inherited(arguments);if(this.document&&this.document.body){_1fb.set(this.document.body,"color",_1fb.get(this.iframe,"color"));}}catch(e){}}});function _21c(args){return new _205({command:args.name});};function _21d(args){return new _205({buttonClass:_204,command:args.name});};lang.mixin(_205.registry,{"undo":_21c,"redo":_21c,"cut":_21c,"copy":_21c,"paste":_21c,"insertOrderedList":_21c,"insertUnorderedList":_21c,"indent":_21c,"outdent":_21c,"justifyCenter":_21c,"justifyFull":_21c,"justifyLeft":_21c,"justifyRight":_21c,"delete":_21c,"selectAll":_21c,"removeFormat":_21c,"unlink":_21c,"insertHorizontalRule":_21c,"bold":_21d,"italic":_21d,"underline":_21d,"strikethrough":_21d,"subscript":_21d,"superscript":_21d,"|":function(){return new _205({setEditor:function(_21e){this.editor=_21e;this.button=new _202({ownerDocument:_21e.ownerDocument});}});}});return _20a;});},"dijit/layout/_LayoutWidget":function(){define("dijit/layout/_LayoutWidget",["dojo/_base/lang","../_Widget","../_Container","../_Contained","../Viewport","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/dom-style"],function(lang,_21f,_220,_221,_222,_223,_224,_225,_226){return _223("dijit.layout._LayoutWidget",[_21f,_220,_221],{baseClass:"dijitLayoutContainer",isLayoutContainer:true,buildRendering:function(){this.inherited(arguments);_224.add(this.domNode,"dijitContainer");},startup:function(){if(this._started){return;}this.inherited(arguments);var _227=this.getParent&&this.getParent();if(!(_227&&_227.isLayoutContainer)){this.resize();this.own(_222.on("resize",lang.hitch(this,"resize")));}},resize:function(_228,_229){var node=this.domNode;if(_228){_225.setMarginBox(node,_228);}var mb=_229||{};lang.mixin(mb,_228||{});if(!("h" in mb)||!("w" in mb)){mb=lang.mixin(_225.getMarginBox(node),mb);}var cs=_226.getComputedStyle(node);var me=_225.getMarginExtents(node,cs);var be=_225.getBorderExtents(node,cs);var bb=(this._borderBox={w:mb.w-(me.w+be.w),h:mb.h-(me.h+be.h)});var pe=_225.getPadExtents(node,cs);this._contentBox={l:_226.toPixelValue(node,cs.paddingLeft),t:_226.toPixelValue(node,cs.paddingTop),w:bb.w-pe.w,h:bb.h-pe.h};this.layout();},layout:function(){},_setupChild:function(_22a){var cls=this.baseClass+"-child "+(_22a.baseClass?this.baseClass+"-"+_22a.baseClass:"");_224.add(_22a.domNode,cls);},addChild:function(_22b,_22c){this.inherited(arguments);if(this._started){this._setupChild(_22b);}},removeChild:function(_22d){var cls=this.baseClass+"-child"+(_22d.baseClass?" "+this.baseClass+"-"+_22d.baseClass:"");_224.remove(_22d.domNode,cls);this.inherited(arguments);}});});},"esri/layers/RenderMode":function(){define("esri/layers/RenderMode",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","dojo/io/script","esri/kernel"],function(_22e,_22f,lang,_230,has,_231,_232){var _233=_22f(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(_22e._scopeName||"dojo")+"IoScript";},initialize:function(map){this.map=map;this._init=true;},startup:function(){},propertyChangeHandler:function(type){},destroy:function(){this._init=false;},drawFeature:function(_234){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _235=this._featureMap[oid];if(_235){_235._count++;}},_decRefCount:function(oid){var _236=this._featureMap[oid];if(_236){_236._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_237){var fmap=this._featureMap,_238=fmap[oid],_239=this.featureLayer;if(!_238){fmap[oid]=_237;_239._add(_237);_237._count=0;}return _238||_237;},_removeFeatureIIf:function(oid){var _23a=this._featureMap[oid],_23b=this.featureLayer;if(_23a){if(_23a._count){return;}delete this._featureMap[oid];_23b._remove(_23a);}return _23a;},_clearIIf:function(){var i,_23c=this.featureLayer,_23d=_23c.graphics,_23e=_23c._selectedFeatures,_23f=_23c.objectIdField;for(i=_23d.length-1;i>=0;i--){var _240=_23d[i];var oid=_240.attributes[_23f];if(oid in _23e){_240._count=1;continue;}_240._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_231[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_231[this._prefix+id];if(dfd){try{dfd.cancel();_231._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_231._validCheck(null);},_toggleVisibility:function(show){var _241=this.featureLayer,_242=_241.graphics,_243=show?"show":"hide",i,len=_242.length;show=show&&_241._ager;for(i=0;i<len;i++){var _244=_242[i];_244[_243]();if(show){_241._repaint(_244);}}},_applyTimeFilter:function(_245){var _246=this.featureLayer;if(!_246.timeInfo||_246.suspended){return;}if(!_245){_246._fireUpdateStart();}var _247=_246._trackManager;if(_247){_247.clearTracks();}var defn=_246.getTimeDefinition(),_248=_246._getOffsettedTE(_246._mapTimeExtent);if(_248){_248=_246._getTimeOverlap(defn,_248);if(_248){var _249=_246._filterByTime(_246.graphics,_248.startTime,_248.endTime);if(_247){_247.addFeatures(_249.match);}_230.forEach(_249.match,function(_24a){var _24b=_24a._shape;if(!_24a.visible){_24a.show();_24b=_24a._shape;_24b&&_24b._moveToFront();}if(_246._ager&&_24b){_246._repaint(_24a);}});_230.forEach(_249.noMatch,function(_24c){if(_24c.visible){_24c.hide();}});}else{this._toggleVisibility(false);}}else{if(_247){_247.addFeatures(_246.graphics);}this._toggleVisibility(true);}if(_247){_247.moveLatestToFront();_247.drawTracks();}if(!_245){_246._fireUpdateEnd();}}});if(has("extend-esri")){lang.setObject("layers._RenderMode",_233,_232);}return _233;});},"dijit/form/_SearchMixin":function(){define("dijit/form/_SearchMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/sniff","dojo/string","dojo/when","../registry"],function(_24d,_24e,_24f,keys,lang,_250,has,_251,when,_252){return _24e("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:true,_abortQuery:function(){if(this.searchTimer){this.searchTimer=this.searchTimer.remove();}if(this._queryDeferHandle){this._queryDeferHandle=this._queryDeferHandle.remove();}if(this._fetchHandle){if(this._fetchHandle.abort){this._cancelingQuery=true;this._fetchHandle.abort();this._cancelingQuery=false;}if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_processInput:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _253=false;this._prev_key_backspace=false;switch(key){case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;this._maskValidSubsetError=true;_253=true;break;default:_253=typeof key=="string"||key==229;}if(_253){if(!this.store){this.onSearch();}else{this.searchTimer=this.defer("_startSearchFromInput",1);}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_startSearch:function(text){this._abortQuery();var _254=this,_250=lang.clone(this.query),_255={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}},qs=_251.substitute(this.queryExpr,[text]),q,_256=function(){var _257=_254._fetchHandle=_254.store.query(_250,_255);if(_254.disabled||_254.readOnly||(q!==_254._lastQuery)){return;}when(_257,function(res){_254._fetchHandle=null;if(!_254.disabled&&!_254.readOnly&&(q===_254._lastQuery)){when(_257.total,function(_258){res.total=_258;var _259=_254.pageSize;if(isNaN(_259)||_259>res.total){_259=res.total;}res.nextPage=function(_25a){_255.direction=_25a=_25a!==false;_255.count=_259;if(_25a){_255.start+=res.length;if(_255.start>=res.total){_255.count=0;}}else{_255.start-=_259;if(_255.start<0){_255.count=Math.max(_259+_255.start,0);_255.start=0;}}if(_255.count<=0){res.length=0;_254.onSearch(res,_250,_255);}else{_256();}};_254.onSearch(res,_250,_255);});}},function(err){_254._fetchHandle=null;if(!_254._cancelingQuery){console.error(_254.declaredClass+" "+err.toString());}});};lang.mixin(_255,this.fetchProperties);if(this.store._oldAPI){q=qs;}else{q=_24d.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_250[this.searchAttr]=q;this._queryDeferHandle=this.defer(_256,this.searchDelay);},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var list=this.list;if(list){this.store=_252.byId(list);}}this.inherited(arguments);}});});},"esri/dijit/editing/Cut":function(){define("esri/dijit/editing/Cut",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_25b,lang,has,_25c,_25d,_25e){var Cut=_25b(_25e,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",constructor:function(_25f){var i;_25f=_25f||{};if(!_25f.featureLayer){console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");return;}this._featureLayer=_25f.featureLayer;if(!_25f.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");return;}this._addedGraphics=_25f.addedGraphics;if(!_25f.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_25f.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_25f.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_25f.preUpdatedGraphics[i].attributes);}if(!_25f.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_25f.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_25f.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_25f.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_25f.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_25d.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_25d.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Cut",Cut,_25c);}return Cut;});},"dijit/form/DateTextBox":function(){define("dijit/form/DateTextBox",["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(_260,_261,_262){return _260("dijit.form.DateTextBox",_262,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:_261,_selector:"date",value:new Date("")});});},"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n","dojox/grid/_Grid":function(){require({cache:{"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n"}});define("dojox/grid/_Grid",["dojo/_base/kernel","../main","dojo/_base/declare","./_Events","./_Scroller","./_Layout","./_View","./_ViewManager","./_RowManager","./_FocusManager","./_EditManager","./Selection","./_RowSelector","./util","dijit/_Widget","dijit/_TemplatedMixin","dijit/CheckedMenuItem","dojo/text!./resources/_Grid.html","dojo/string","dojo/_base/array","dojo/_base/lang","dojo/_base/sniff","dojox/html/metrics","dojo/_base/html","dojo/query","dojo/dnd/common","dojo/i18n!dijit/nls/loading"],function(dojo,_263,_264,_265,_266,_267,_268,_269,_26a,_26b,_26c,_26d,_26e,util,_26f,_270,_271,_272,_273,_274,lang,has,_275,html,_276){if(!dojo.isCopyKey){dojo.isCopyKey=dojo.dnd.getCopyKeyState;}var _277=_264("dojox.grid._Grid",[_26f,_270,_265],{templateString:_272,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:_267,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_275.initOnFontResize();this.connect(_275,"onFontResize","textSizeChanged");util.funnelEvents(this.domNode,this,"doKeyEvent",util.keyEvents);if(this.selectionMode!="none"){this.domNode.setAttribute("aria-multiselectable",this.selectionMode=="single"?"false":"true");}html.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){html.addClass(this.domNode,this.classTag+"Rtl");}if(this.rowHeight>0){html.addClass(this.viewsNode,this.classTag+"FixedRowHeight");}},postMixInProperties:function(){this.inherited(arguments);var _278=dojo.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_273.substitute(this.loadingMessage,_278);this.errorMessage=_273.substitute(this.errorMessage,_278);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){html.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;if(this.scroller){this.scroller.destroy();delete this.scroller;}this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_274.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_279){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_279){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _26a(this);this.focus=new _26b(this);this.edit=new _26c(this);},createSelection:function(){this.selection=new _26d(this);},createScroller:function(){this.scroller=new _266();this.scroller.grid=this;this.scroller.renderRow=lang.hitch(this,"renderRow");this.scroller.removeRow=lang.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.update();},onResizeColumn:function(_27a){},createViews:function(){this.views=new _269(this);this.views.createView=lang.hitch(this,"createView");},createView:function(_27b,idx){var c=lang.getObject(_27b);var view=new c({grid:this,index:idx});this.viewsNode.appendChild(view.domNode);this.viewsHeaderNode.appendChild(view.headerNode);this.views.addView(view);html.attr(this.domNode,"align",this.isLeftToRight()?"left":"right");return view;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_263._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_27c){var s=_27c;if(s&&lang.isString(s)){dojo.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=lang.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_27d){dojo.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_27d);},getColumnTogglingItems:function(){var _27e,_27f=[];_27e=_274.map(this.layout.cells,function(cell){if(!cell.menuItems){cell.menuItems=[];}var self=this;var item=new _271({label:cell.name,checked:!cell.hidden,_gridCell:cell,onChange:function(_280){if(self.layout.setColumnVisibility(this._gridCell.index,_280)){var _281=this._gridCell.menuItems;if(_281.length>1){_274.forEach(_281,function(item){if(item!==this){item.setAttribute("checked",_280);}},this);}_280=_274.filter(self.layout.cells,function(c){if(c.menuItems.length>1){_274.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_280.length==1){_274.forEach(_280[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _282=_274.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_282,1);delete this._gridCell;_271.prototype.destroy.apply(this,arguments);}});cell.menuItems.push(item);if(!cell.hidden){_27f.push(item);}return item;},this);if(_27f.length==1){_27f[0].set("disabled",true);}return _27e;},_setHeaderMenuAttr:function(menu){if(this._placeholders&&this._placeholders.length){_274.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=menu;if(!menu){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(menu){dojo.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(menu);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_274.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_283){this.setScrollTop(0);},getItem:function(_284){return null;},showMessage:function(_285){if(_285){this.messagesNode.innerHTML=_285;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_286,_287){this._pendingChangeSize=_286;this._pendingResultSize=_287;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||html._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_288,_289){_288=_288||this._pendingChangeSize;_289=_289||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _28a=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_28a.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_289){_288=_289;}if(!this._autoHeight&&_288){html.marginBox(this.domNode,_288);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=(this._parentContentBoxHeight>0?this._parentContentBoxHeight:html._getContentBox(pn).h);this.domNode.style.height=Math.max(0,h)+"px";}}var _28b=_274.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||html._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_28b&&hh===undefined){hh=this._getHeaderHeight();}}if(_28b){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _28c=(!this.initialWidth&&this.autoWidth);var w=_28c?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_28c){this.domNode.style.width=vw+"px";}},adaptHeight:function(_28d){var t=_28d===undefined?this._getHeaderHeight():_28d;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _28e=0,_28f=0;var _290=_274.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_28e++;}else{_28f++;}return (!has);});if(_28e>0&&_28f>0){_274.forEach(_290,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();html.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var size=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=size;}},renderRow:function(_291,_292){this.views.renderRow(_291,_292,this._skipRowRenormalize);},rowRemoved:function(_293){this.views.rowRemoved(_293);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_294){_294=Number(_294);if(this.updating){this.invalidated[_294]=true;}else{this.views.updateRow(_294);this.scroller.rowHeightChanged(_294);}},updateRows:function(_295,_296){_295=Number(_295);_296=Number(_296);var i;if(this.updating){for(i=0;i<_296;i++){this.invalidated[i+_295]=true;}}else{for(i=0;i<_296;i++){this.views.updateRow(i+_295,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_295);}},updateRowCount:function(_297){if(this.updating){this.invalidated.rowCount=_297;}else{this.rowCount=_297;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_297);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_298){this.views.updateRowStyles(_298);},getRowNode:function(_299){if(this.focus.focusView&&!(this.focus.focusView instanceof _26e)){return this.focus.focusView.rowNodes[_299];}else{for(var i=0,_29a;(_29a=this.views.views[i]);i++){if(!(_29a instanceof _26e)){return _29a.rowNodes[_299];}}}return null;},rowHeightChanged:function(_29b){this.views.renormalizeRow(_29b);this.scroller.rowHeightChanged(_29b);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(has("ie")?100:50),scrollTo:function(_29c){if(!this.fastScroll){this.setScrollTop(_29c);return;}var _29d=Math.abs(this.lastScrollTop-_29c);this.lastScrollTop=_29c;if(_29d>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_29c;this.views.setScrollTop(_29c);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _29e=this;this._pendingScroll=window.setTimeout(function(){delete _29e._pendingScroll;_29e.finishScrollJob();},200);}else{this.setScrollTop(_29c);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_29f){this.scroller.scroll(this.views.setScrollTop(_29f));},scrollToRow:function(_2a0){this.setScrollTop(this.scroller.findScrollTop(_2a0)+1);},styleRowNode:function(_2a1,_2a2){if(_2a2){this.rows.styleRowNode(_2a1,_2a2);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_2a3){return this.layout.cells[_2a3];},setCellWidth:function(_2a4,_2a5){this.getCell(_2a4).unitWidth=_2a5;},getCellName:function(_2a6){return "Cell "+_2a6.index;},canSort:function(_2a7){},sort:function(){},getSortAsc:function(_2a8){_2a8=_2a8==undefined?this.sortInfo:_2a8;return Boolean(_2a8>0);},getSortIndex:function(_2a9){_2a9=_2a9==undefined?this.sortInfo:_2a9;return Math.abs(_2a9)-1;},setSortIndex:function(_2aa,_2ab){var si=_2aa+1;if(_2ab!=undefined){si*=(_2ab?1:-1);}else{if(this.getSortIndex()==_2aa){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_2ac){if(this.canSort(_2ac)){this.sortInfo=_2ac;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_2ad,_2ae){this.onStartEdit(_2ad,_2ae);},doApplyCellEdit:function(_2af,_2b0,_2b1){this.onApplyCellEdit(_2af,_2b0,_2b1);},doCancelEdit:function(_2b2){this.onCancelEdit(_2b2);},doApplyEdit:function(_2b3){this.onApplyEdit(_2b3);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_277.markupFactory=function(_2b4,node,ctor,_2b5){var _2b6=function(n){var w=html.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_2b4.structure&&node.nodeName.toLowerCase()=="table"){_2b4.structure=_276("> colgroup",node).map(function(cg){var sv=html.attr(cg,"span");var v={noscroll:(html.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(html.hasAttr(cg,"width")){v.width=_2b6(cg);}return v;});if(!_2b4.structure.length){_2b4.structure.push({__span:Infinity,cells:[]});}_276("thead > tr",node).forEach(function(tr,_2b7){var _2b8=0;var _2b9=0;var _2ba;var _2bb=null;_276("> th",tr).map(function(th){if(!_2bb){_2ba=0;_2bb=_2b4.structure[0];}else{if(_2b8>=(_2ba+_2bb.__span)){_2b9++;_2ba+=_2bb.__span;var _2bc=_2bb;_2bb=_2b4.structure[_2b9];}}var cell={name:lang.trim(html.attr(th,"name")||th.innerHTML),colSpan:parseInt(html.attr(th,"colspan")||1,10),type:lang.trim(html.attr(th,"cellType")||""),id:lang.trim(html.attr(th,"id")||"")};_2b8+=cell.colSpan;var _2bd=html.attr(th,"rowspan");if(_2bd){cell.rowSpan=_2bd;}if(html.hasAttr(th,"width")){cell.width=_2b6(th);}if(html.hasAttr(th,"relWidth")){cell.relWidth=window.parseInt(html.attr(th,"relWidth"),10);}if(html.hasAttr(th,"hidden")){cell.hidden=(html.attr(th,"hidden")=="true"||html.attr(th,"hidden")===true);}if(_2b5){_2b5(th,cell);}cell.type=cell.type?lang.getObject(cell.type):_263.grid.cells.Cell;if(cell.type&&cell.type.markupFactory){cell.type.markupFactory(th,cell);}if(!_2bb.cells[_2b7]){_2bb.cells[_2b7]=[];}_2bb.cells[_2b7].push(cell);});});}return new ctor(_2b4,node);};return _277;});},"dojo/_base/query":function(){define(["../query","./NodeList"],function(_2be){return _2be;});},"esri/dijit/editing/Editor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/kernel","dojo/has","dojo/query","dojo/DeferredList","dojo/dom-class","dojo/dom-construct","dijit/_Widget","dijit/_Templated","esri/domUtils","esri/graphicsUtils","esri/geometry/Polyline","esri/geometry/Polygon","esri/graphic","esri/undoManager","esri/tasks/query","esri/layers/FeatureLayer","esri/layers/FeatureTemplate","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/AttributeInspector","esri/dijit/editing/Util","esri/dijit/editing/Add","esri/dijit/editing/Update","esri/dijit/editing/Delete","esri/dijit/editing/toolbars/Drawing","esri/dijit/editing/SelectionHelper","esri/dijit/editing/TemplatePicker","esri/kernel","esri/config","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/Editor.html","dijit/ProgressBar","dojo/NodeList-dom"],function(_2bf,lang,_2c0,_2c1,_2c2,has,_2c3,_2c4,_2c5,_2c6,_2c7,_2c8,_2c9,_2ca,_2cb,_2cc,_2cd,_2ce,_2cf,_2d0,_2d1,Draw,_2d2,_2d3,_2d4,Add,_2d5,_2d6,_2d7,_2d8,_2d9,_2da,_2db,_2dc,_2dd){var _2de=_2bf([_2c7,_2c8],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:true,templateString:_2dd,constructor:function(_2df,_2e0){_2df=_2df||{};if(!_2df.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_2df.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_2df.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();this._initLayers();this._connectEvents();this._createWidgets();this._reset();this._enableMapClickHandler();},stopEditing:function(_2e1){this._updateCurrentFeature(lang.hitch(this,function(){this._clearSelection(false);_2e1&&_2e1();}));},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();_2c0.forEach(this._eConnects,_2c1.disconnect);_2c1.disconnect(this._dtConnect);_2c1.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new Draw(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new _2d2(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=lang.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=lang.mixin({polylineDrawTools:[_2de.CREATE_TOOL_POLYLINE],polygonDrawTools:[_2de.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;this._datePackage=this._settings.datePackage;var _2e2=_2db.defaults;this._settings.geometryService=this._settings.geometryService||_2e2.geometryService;_2e2.geometryService=_2e2.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};var _2e3=this._settings.layerInfos;_2c0.forEach(_2e3,function(_2e4){if(_2e4.featureLayer&&_2e4.featureLayer.loaded){this._settings.layers.push(_2e4.featureLayer);var _2e5=_2e4.featureLayer.id;if(_2e4.featureLayer.credential){this._settings.userIds[_2e5]=_2e4.featureLayer.credential.userId;}if(_2e4.userId){this._settings.userIds[_2e5]=_2e4.userId;}var _2e6=_2e4.featureLayer.getEditCapabilities();if(_2e6.canCreate&&!_2e6.canUpdate){this._settings.createOnlyLayer[_2e5]=true;}else{this._settings.createOnlyLayer[_2e5]=false;}}},this);},_reset:function(){this._hideAttributeInspector();this._editToolbar.deactivate();this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;},_saveFeatureOnClient:function(_2e7){var _2e8=this.templatePicker.getSelected();var _2e9;if(_2e8.template){_2e9=_2e8.featureLayer.renderer.getSymbol(_2e8.template.prototype);}else{_2e9=_2e8.symbolInfo.symbol;}var _2ea=_2e8.featureLayer.fields;var att={};_2c0.forEach(_2ea,function(_2eb,idx){att[_2eb.name]=null;});this._tempGraphic=new _2cd(_2e7,_2e9,att,null);var map=this._settings.map;map.graphics.add(this._tempGraphic);var _2ec=this._findCenterPoint(_2e7);this._createAttributeInspector(true);map.infoWindow.setTitle(_2e8.featureLayer?_2e8.featureLayer.name:_2dc.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,_2e8.featureLayer);this._showInfoWindow(_2ec,map.getInfoWindowAnchor(_2ec));if(this._settings.createOnlyLayer[_2e8.featureLayer.id]){this._infoWindowHideEvent=_2c1.connect(map.infoWindow,"onHide",this,"_infoWindowHide");}_2c1.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}this._templatePickerOnSelectionChangeEvent=_2c1.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_saveAttributesOnClient:function(_2ed,_2ee,_2ef){this._tempGraphic.attributes[_2ee]=(typeof (_2ef)==="number"&&isNaN(_2ef))?null:_2ef;},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);_2c1.disconnect(this._infoWindowHideEvent);},_createFeature:function(_2f0,_2f1){this._editClickPoint=this._findCenterPoint(_2f0);if(!_2f0.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_2f0,_2f1)]}]);return;}this._simplify(_2f0,lang.hitch(this,function(_2f2){if(this._drawingTool!==_2d1.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_2f2,_2f1)]}]);}else{this._autoComplete(_2f2,lang.hitch(this,function(_2f3){if(_2f3&&_2f3.length){this._applyEdits([{layer:this._layer,adds:_2c0.map(_2f3,lang.hitch(this,function(_2f4){return this._createGraphic(_2f4,_2f1);}))}]);}}));}}));},_updateCurrentFeature:function(_2f5){var _2f6=this._isModified();if(_2f6){this._updateFeature(_2f6,_2f5);}else{if(_2f5){_2f5(false);}}},_updateFeature:function(_2f7,_2f8){var geom=_2f7.geometry;if(!geom.rings){this._applyEdits([{layer:_2f7.getLayer(),updates:[_2f7]}],_2f8);}else{this._simplify(geom,lang.hitch(this,function(_2f9){this._applyEdits([{layer:_2f7.getLayer(),updates:[lang.mixin(_2f7,{geometry:_2f9})]}],_2f8);}));}},_deleteFeature:function(_2fa,_2fb){var _2fc=[];if(!_2fa){var _2fd=this._settings.layers;_2fc=_2c0.map(_2c0.filter(_2fd,function(_2fe){return _2fe.getSelectedFeatures().length>0;}),function(item){return {layer:item,deletes:item.getSelectedFeatures()};});if((!_2fc||!_2fc.length)&&this._currentGraphic){_2fc.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_2fc.push({layer:_2fa.getLayer(),deletes:[_2fa]});}this._applyEdits(_2fc,(_2fb));},_stopEditing:function(_2ff,adds,_300,_301){_2c9.hide(this.progressBar.domNode);this._undoRedoAdd();var _302;if(_2ff._isSelOnly===true){if(adds&&adds.length){this.templatePicker.clearSelection();var _303=new _2cf();_303.objectIds=[adds[0].objectId];if(!this._settings.createOnlyLayer[_2ff.id]){this._selectFeatures([_2ff],_303,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}else{_302=this._selectionHelper.findMapService(this._settings.map,_2ff);if(_302){_302.refresh();}if(adds&&adds.length){this.templatePicker.clearSelection();if(!this._settings.createOnlyLayer[_2ff.id]){_2d4.findFeatures(adds,_2ff,lang.hitch(this,"_onEditFeature"));}else{this._settings.map.graphics.remove(this._tempGraphic);}}}if(_301&&_301.length){this._clearSelection(true);if(this._undoRedo){_302=this._selectionHelper.findMapService(_2ff,this._settings.map);if(_302){_302.refresh();}}}if(this._undoRedo&&_300&&_300.length){_302=this._selectionHelper.findMapService(_2ff,this._settings.map);if(_302){_302.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var edit=(this._edits&&this._edits.length)?this._edits[0]:null;if(!edit){return;}var adds=edit.adds||[];var _304=edit.updates||[];var _305=edit.deletes||[];var _306={featureLayer:edit.layer};if(adds.length){this.undoManager.add(new Add(lang.mixin(_306,{addedGraphics:adds})));}else{if(_305.length){this.undoManager.add(new _2d6(lang.mixin(_306,{deletedGraphics:_305})));}else{if(_304.length){this.undoManager.add(new _2d5(lang.mixin(_306,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_304})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_307){this._layer=_307.featureLayer;this._activeType=_307.type;this._activeTemplate=_307.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_307.featureLayer);_2c1.disconnect(this._dtConnect);if(this._settings.createOnlyLayer[_307.featureLayer.id]){this._dtConnect=_2c1.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient");}else{this._dtConnect=_2c1.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");}this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_308,info){var _309=_308.getLayer();var _30a=_309?_309.geometryType:null;var _30b=_2d2.MOVE;if(_30a!=="esriGeometryPoint"&&this._isNotesFeature(_308)===true){_30b=_30b|_2d2.ROTATE|_2d2.SCALE;this._editVertices=false;}else{if(_30a!=="esriGeometryPoint"&&this._editVertices===true){_30b=_30b|_2d2.ROTATE|_2d2.SCALE;this._editVertices=false;}else{_30b=_30b|_2d2.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new _2cd(lang.clone(_308.toJson()));var _30c=_309.getEditCapabilities({feature:_308,userId:this._settings.userIds[_309.id]});var _30d=_2c0.filter(this._settings.layerInfos,function(item){return item.featureLayer["layerId"]===_309.layerId;})[0];if(_30c.canUpdate&&!_30d.disableGeometryUpdate&&_309.allowGeometryUpdates){this._editToolbar.activate(_30b,_308);}if(!this._settings.map.infoWindow.isShowing){var _30e=(info&&info.screenPoint)||this._findCenterPoint(_308);this._showInfoWindow(_30e,this._settings.map.getInfoWindowAnchor(_30e));}},_createGraphic:function(_30f,_310){var _311=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _312=new _2cd(_30f,_311,_310);if(this._activeTemplate||_310){_312.attributes=_310||lang.mixin({},this._activeTemplate.prototype.attributes);}else{_312.attributes=_312.attributes||[];_2c0.forEach(this._layer.fields,function(_313){_312.attributes[_313.name]=null;},this);}return _312;},_connectEvents:function(){var _314=this._settings.layers;_2c0.forEach(_314,function(item){this._connect(item,"onEditsComplete",lang.hitch(this,"_stopEditing",item));},this);_2c0.forEach(_314,function(item){this._connect(item,"onBeforeApplyEdits",lang.hitch(this,function(){_2c9.show(this.progressBar.domNode);this._settings._isApplyEditsCall=true;}));},this);this._connect(this._editToolbar,"onGraphicClick",lang.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",lang.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",lang.hitch(this,"_hideAttributeInspector"));},_connect:function(node,evt,func){this._eConnects.push(_2c1.connect(node,evt,func));},_createWidgets:function(){this._selectionHelper=new _2d8(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){var _315=_2c0.filter(this._settings.layers,function(item){return item.getEditCapabilities().canCreate;});this.templatePicker=new _2d9({"class":"esriTemplatePicker",featureLayers:_315,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;_2c9.hide(this.templatePickerDiv);}this._templatePickerOnSelectionChangeEvent=_2c1.connect(this.templatePicker,"onSelectionChange",lang.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(_316){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new _2d3({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,datePackage:this._datePackage},_2c6.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(_2dc.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);_2c2.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",lang.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",lang.hitch(this,function(_317){this._updateCurrentFeature(lang.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_317);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,lang.hitch(this.attributeInspector,"next"),lang.hitch(this.attributeInspector,"previous"));}if(_316){this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,"_saveAttributesOnClient"));}else{this._connect(this.attributeInspector,"onAttributeChange",lang.hitch(this,function(_318,_319,_31a){this._preUpdates=new _2cd(lang.clone(_318.toJson()));this._currentGraphic.attributes[_319]=(typeof (_31a)==="number"&&isNaN(_31a))?null:_31a;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));}},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new _2d7({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:lang.hitch(this,"_deleteFeature"),onApplyEdits:lang.hitch(this,"_applyEdits"),onShowAttributeInspector:lang.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new _2ce({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",lang.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=_2c1.connect(this._settings.map,"onClick",lang.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(lang.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){_2c1.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _31b=this.templatePicker.getSelected();if(_31b){this._updateCurrentFeature(lang.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_31b);}));}else{this._reset();_2c1.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_31c,_31d){_31c=(lang.isArray(_31c)?_31c[0]:_31c)||null;if(!_31c){return;}if(!this._customAttributeInspector){_31d=_31d||this._editClickPoint||this._findCenterPoint(_31c);var _31e=_31c.getLayer();this._settings.map.infoWindow.setTitle(_31e?_31e.name:_2dc.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._showInfoWindow(_31d,this._settings.map.getInfoWindowAnchor(_31d));}this._editClickPoint=null;}if(_31c===this._currentGraphic){return;}this._editVertices=true;this._layer=_31c.getLayer();this._currentGraphic=_31c;if(_31c.getDojoShape()){_31c.getDojoShape().moveToFront();}this._activateEditToolbar(_31c);},_applyEdits:function(_31f,_320){_31f=_31f||[];if(_31f.length<=0){return;}this._edits=_31f;var _321=_2c0.map(_31f,function(edit){return edit.layer.applyEdits(edit.adds,edit.updates,edit.deletes);});this._deferredsList=new _2c4(_321).addCallback(lang.hitch(this,function(){_2c9.hide(this.progressBar.domNode);if(_320){_320();}var map=this._settings.map;if(map&&map.infoWindow.reposition&&map.infoWindow.isShowing){map.infoWindow.reposition();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_322,_323){if(_2cc.prototype.isSelfIntersecting(_322)){this._settings.geometryService.simplify([_322],function(_324){var _325=(_324&&_324.length)?_324[0]:_325;if(_323){_323(_325);}});}else{if(_323){_323(_322);}}},_autoComplete:function(_326,_327){var _328=this._getLayers("esriGeometryPolygon");var _329=new _2cf();_329.geometry=_326;_329.returnGeometry=true;this._selectFeatures(_328,_329,lang.hitch(this,function(_32a){if(!_32a||_32a.length<=0){if(_327){_327([_326]);}}else{this._settings.geometryService.autoComplete(_2ca.getGeometries(_32a),this._toPolylines([_329.geometry]),function(_32b){if(_327){_327(_32b);}});}}));},_getLayers:function(_32c){var _32d=this._settings.layers;return _2c0.filter(_32d,function(_32e){return _32e.geometryType===_32c;});},_selectFeatures:function(_32f,_330,_331,mode){this._selectionHelper.selectFeatures(_32f,_330,mode||_2d0.SELECTION_NEW,_331);},_updateSelection:function(evt){var _332=evt.mapPoint;var _333=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_332,_2d0.SELECTION_NEW,lang.hitch(this,function(_334){var _335=_2c0.some(_334,lang.hitch(this,function(item){return item==_333;}));if(_333&&!_335){var _336=_333.getLayer();if(this._isValidLayer(_336)){var _337=new _2cf();_337.objectIds=[_333.attributes[_336.objectIdField]];this._selectionHelper.selectFeatures([_336],_337,_2d0.SELECTION_ADD,lang.hitch(this,function(_338){this._updatePopupButtons(_338);this._onEditFeature(_338,_332);}));}else{this._clearSelection();}}else{if(_334&&_334.length){this._updatePopupButtons(_334);this._onEditFeature(_334,_332);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_339){if(!this._usePopup||!_339){return;}var _33a=_339.length;var _33b=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];_2c0.forEach(_33b,lang.hitch(this,function(item){(_33a>1)?_2c5.remove(item,"hidden"):_2c5.add(item,"hidden");}));},_clearSelection:function(_33c){this._selectionHelper.clearSelection(_33c||false);this._reset();},_findCenterPoint:function(_33d){var _33e=_33d.geometry||_33d;var _33f;switch(_33e.type){case "point":_33f=_33e;break;case "polyline":var _340=_33e.paths[0].length;_33f=_33e.getPoint(0,Math.ceil(_340/2));break;case "polygon":var _341=_33e.rings.length-1;var _342=_33e.rings[_341].length-1;_33f=_33e.getPoint(_341,_342);break;}return this._settings.map.toScreen(_33f);},_hideAttributeInspector:function(){if(!this._customAttributeInspector&&this._settings.map.infoWindow){this._settings.map.infoWindow.hide();}},_toPolylines:function(_343){var _344=_2c0.map(_343,function(_345){var _346=new _2cb(_345.spatialReference);_2c0.forEach(_345.rings,function(ring){_346.addPath(ring);});return _346;});return _344;},_isNotesFeature:function(_347){var _348=_347.getLayer();var _349=_348?_348.types||null:null;if(!_349){return false;}var _34a=_347.attributes[_348.typeIdField];var _34b;_2c0.some(_349,function(type){if(type.id===_34a){_34b=type.templates;return true;}return false;});if(!_34b){return false;}var _34c=_34b[0]||null;if(!_34c){return false;}var _34d=this._isShapeTool(_34c.drawingTool)||null;return _34d?true:false;},_isValidLayer:function(_34e){var i;var _34f=this._settings.layerInfos;for(i=0;i<_34f.length;i++){var _350=_34f[i];if(_34e.id==_350.layerId){return true;}}return false;},_isShapeTool:function(_351){switch(_351){case _2d1.TOOL_ARROW:return Draw.ARROW;case _2d1.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _2d1.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _2d1.TOOL_UP_ARROW:return Draw.UP_ARROW;case _2d1.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _2d1.TOOL_CIRCLE:return Draw.CIRCLE;case _2d1.TOOL_ELLIPSE:return Draw.ELLIPSE;case _2d1.TOOL_TRIANGLE:return Draw.TRIANGLE;case _2d1.TOOL_RECTANGLE:return Draw.RECTANGLE;default:return null;}},_toDrawTool:function(_352,_353){var _354=_353.geometryType;switch(_352){case _2d1.TOOL_POINT:return Draw.POINT;case _2d1.TOOL_ARROW:return Draw.ARROW;case _2d1.TOOL_LEFT_ARROW:return Draw.LEFT_ARROW;case _2d1.TOOL_RIGHT_ARROW:return Draw.RIGHT_ARROW;case _2d1.TOOL_UP_ARROW:return Draw.UP_ARROW;case _2d1.TOOL_DOWN_ARROW:return Draw.DOWN_ARROW;case _2d1.TOOL_CIRCLE:return Draw.CIRCLE;case _2d1.TOOL_ELLIPSE:return Draw.ELLIPSE;case _2d1.TOOL_TRIANGLE:return Draw.TRIANGLE;case _2d1.TOOL_RECTANGLE:return Draw.RECTANGLE;case _2d1.TOOL_LINE:return Draw.POLYLINE;case _2d1.TOOL_POLYGON:return Draw.POLYGON;case _2d1.TOOL_FREEHAND:if(_354==="esriGeometryPolyline"){return Draw.FREEHAND_POLYLINE;}else{return Draw.FREEHAND_POLYGON;}break;default:var _355=Draw.POINT;if(_354==="esriGeometryPolyline"){_355=Draw.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===_2de.CREATE_TOOL_FREEHAND_POLYLINE){_355=Draw.FREEHAND_POLYLINE;}}else{if(_354==="esriGeometryPolygon"){_355=Draw.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===_2de.CREATE_TOOL_FREEHAND_POLYGON){_355=Draw.FREEHAND_POLYGON;}}}return _355;}},_isModified:function(){var _356=this._editToolbar.getCurrentState();return ((_356.isModified||this._attributeChanged)&&_356.graphic)?_356.graphic:null;},_showInfoWindow:function(_357,_358){if(!this._customAttributeInspector){this._settings.map.infoWindow.show(_357,_358);}}});lang.mixin(_2de,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});if(has("extend-esri")){lang.setObject("dijit.editing.Editor",_2de,_2da);}return _2de;});},"esri/dijit/editing/toolbars/ToolbarBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/has","dijit/Toolbar","dijit/ToolbarSeparator","esri/kernel","esri/lang"],function(_359,lang,_35a,_35b,has,_35c,_35d,_35e,_35f){var TBB=_359([_35c],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:true,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(_360,_361){if(!_360||!_360.settings){return;}this._tools=[];this._tbConnects=[];this._initialize(_360.settings);},postCreate:function(){this._createTools();this.deactivate();},destroy:function(){var tool;var _362=this._tools;for(tool in _362){if(_362.hasOwnProperty(tool)&&_35f.isDefined(this._tools[tool])){this._tools[tool].destroy();}}_35a.forEach(this._tbConnects,_35b.disconnect);this.inherited(arguments);},activate:function(_363){this._enabled=true;},deactivate:function(){var tool;this._enabled=false;this._layer=null;this._geometryType=null;var _364=this._tools;for(tool in _364){if(_364.hasOwnProperty(tool)){this._tools[tool].deactivate();this._tools[tool].setChecked(false);}}},isEnabled:function(){return this._enabled;},setActiveSymbol:function(_365){this._activeSymbol=_365;},_getSymbol:function(){},_createTools:function(){},_initialize:function(_366){this._settings=_366;this._toolbar=_366.drawToolbar;this._editToolbar=_366.editToolbar;this._initializeToolbar();},_activateTool:function(tool,_367){if(this._activeTool){this._activeTool.deactivate();}if(_367===true&&this._activeTool==this._tools[tool]){this._activeTool.setChecked(false);this._activeTool=null;}else{this._activeTool=this._tools[tool];this._activeTool.setChecked(true);this._activeTool.activate(null);}},_createSeparator:function(){this.addChild(new _35d());}});if(has("extend-esri")){lang.setObject("dijit.editing.toolbars.ToolbarBase",TBB,_35e);}return TBB;});},"esri/dijit/editing/Add":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase"],function(_368,lang,has,_369,_36a){var Add=_368(_36a,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(_36b){_36b=_36b||{};if(!_36b.featureLayer){console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided");return;}this._featureLayer=_36b.featureLayer;if(!_36b.addedGraphics){console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided");return;}this._addedGraphics=_36b.addedGraphics;},performUndo:function(){this._featureLayer.applyEdits(null,null,this._addedGraphics);},performRedo:function(){this._featureLayer.applyEdits(this._addedGraphics,null,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Add",Add,_369);}return Add;});},"dojox/main":function(){define("dojox/main",["dojo/_base/kernel"],function(dojo){return dojo.dojox;});},"esri/dijit/editing/Update":function(){define("esri/dijit/editing/Update",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/geometry/jsonUtils","esri/OperationBase"],function(_36c,lang,has,_36d,_36e,_36f){var _370=_36c(_36f,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(_371){var i;_371=_371||{};if(!_371.featureLayer){console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");return;}this._featureLayer=_371.featureLayer;if(!_371.preUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");return;}this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(i=0;i<_371.preUpdatedGraphics.length;i++){this._preUpdatedGraphicsGeometries.push(_371.preUpdatedGraphics[i].geometry.toJson());this._preUpdatedGraphicsAttributes.push(_371.preUpdatedGraphics[i].attributes);}if(!_371.postUpdatedGraphics){console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");return;}this._postUpdatedGraphics=_371.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(i=0;i<_371.postUpdatedGraphics.length;i++){this._postUpdatedGraphicsGeometries.push(_371.postUpdatedGraphics[i].geometry.toJson());this._postUpdatedGraphicsAttributes.push(lang.clone(_371.postUpdatedGraphics[i].attributes));}},performUndo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_36e.fromJson(this._preUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._preUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);},performRedo:function(){var i;for(i=0;i<this._postUpdatedGraphics.length;i++){this._postUpdatedGraphics[i].setGeometry(_36e.fromJson(this._postUpdatedGraphicsGeometries[i]));this._postUpdatedGraphics[i].setAttributes(this._postUpdatedGraphicsAttributes[i]);}this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null);}});if(has("extend-esri")){lang.setObject("dijit.editing.Update",_370,_36d);}return _370;});},"dijit/form/_DateTimeTextBox":function(){require({cache:{"url:dijit/form/templates/DropDownBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\"\n\trole=\"combobox\"\n\t><div class='dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer'\n\t\tdata-dojo-attach-point=\"_buttonNode, _popupStateNode\" role=\"presentation\"\n\t\t><input class=\"dijitReset dijitInputField dijitArrowButtonInner\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"button presentation\" aria-hidden=\"true\"\n\t\t\t${_buttonInputDisabled}\n\t/></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' ${!nameAttrSetting} type=\"text\" autocomplete=\"off\"\n\t\t\tdata-dojo-attach-point=\"textbox,focusNode\" role=\"textbox\" aria-haspopup=\"true\"\n\t/></div\n></div>\n"}});define("dijit/form/_DateTimeTextBox",["dojo/date","dojo/date/locale","dojo/date/stamp","dojo/_base/declare","dojo/_base/lang","./RangeBoundTextBox","../_HasDropDown","dojo/text!./templates/DropDownBox.html"],function(date,_372,_373,_374,lang,_375,_376,_377){new Date("X");var _378=_374("dijit.form._DateTimeTextBox",[_375,_376],{templateString:_377,hasDownArrow:true,cssStateNodes:{"_buttonNode":"dijitDownArrowButton"},pattern:_372.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},compare:function(val1,val2){var _379=this._isInvalidDate(val1);var _37a=this._isInvalidDate(val2);return _379?(_37a?0:-1):(_37a?1:date.compare(val1,val2,this._selector));},forceWidth:true,format:function(_37b,_37c){if(!_37b){return "";}return this.dateLocaleModule.format(_37b,_37c);},"parse":function(_37d,_37e){return this.dateLocaleModule.parse(_37d,_37e)||(this._isEmpty(_37d)?null:undefined);},serialize:function(val,_37f){if(val.toGregorian){val=val.toGregorian();}return _373.toISOString(val,_37f);},dropDownDefaultValue:new Date(),value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(_380){this.dateModule=_380.datePackage?lang.getObject(_380.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_380.datePackage?lang.getObject(_380.datePackage+".locale",false):_372;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString();},buildRendering:function(){this.inherited(arguments);if(!this.hasDownArrow){this._buttonNode.style.display="none";}if(!this.hasDownArrow){this._buttonNode=this.domNode;this.baseClass+=" dijitComboBoxOpenOnClick";}},_setConstraintsAttr:function(_381){_381.selector=this._selector;_381.fullYear=true;var _382=_373.fromISOString;if(typeof _381.min=="string"){_381.min=_382(_381.min);}if(typeof _381.max=="string"){_381.max=_382(_381.max);}this.inherited(arguments);},_isInvalidDate:function(_383){return !_383||isNaN(_383)||typeof _383!="object"||_383.toString()==this._invalidDate;},_setValueAttr:function(_384,_385,_386){if(_384!==undefined){if(typeof _384=="string"){_384=_373.fromISOString(_384);}if(this._isInvalidDate(_384)){_384=null;}if(_384 instanceof Date&&!(this.dateClassObj instanceof Date)){_384=new this.dateClassObj(_384);}}this.inherited(arguments);if(this.value instanceof Date){this.filterString="";}if(this.dropDown){this.dropDown.set("value",_384,false);}},_set:function(attr,_387){if(attr=="value"&&this.value instanceof Date&&this.compare(_387,this.value)==0){return;}this.inherited(arguments);},_setDropDownDefaultValueAttr:function(val){if(this._isInvalidDate(val)){val=new this.dateClassObj();}this.dropDownDefaultValue=val;},openDropDown:function(_388){if(this.dropDown){this.dropDown.destroy();}var _389=lang.isString(this.popupClass)?lang.getObject(this.popupClass,false):this.popupClass,_38a=this,_38b=this.get("value");this.dropDown=new _389({onChange:function(_38c){_38a.set("value",_38c,true);},id:this.id+"_popup",dir:_38a.dir,lang:_38a.lang,value:_38b,currentFocus:!this._isInvalidDate(_38b)?_38b:this.dropDownDefaultValue,constraints:_38a.constraints,filterString:_38a.filterString,datePackage:_38a.params.datePackage,isDisabledDate:function(date){return !_38a.rangeCheck(date,_38a.constraints);}});this.inherited(arguments);},_getDisplayedValueAttr:function(){return this.textbox.value;},_setDisplayedValueAttr:function(_38d,_38e){this._setValueAttr(this.parse(_38d,this.constraints),_38e,_38d);}});return _378;});},"esri/layers/FeatureTemplate":function(){define("esri/layers/FeatureTemplate",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/lang","esri/graphic"],function(_38f,lang,has,_390,_391,_392){var _393=_38f(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(json){if(json&&lang.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _394=json.prototype;this.prototype=new _392(_394.geometry,null,_394.attributes);}},toJson:function(){return _391.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});lang.mixin(_393,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});if(has("extend-esri")){lang.setObject("layers.FeatureTemplate",_393,_390);}return _393;});},"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n","dijit/_editor/_Plugin":function(){define("dijit/_editor/_Plugin",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../form/Button"],function(_395,_396,lang,_397){var _398=_396("dijit._editor._Plugin",null,{constructor:function(args){this.params=args||{};lang.mixin(this,this.params);this._connects=[];this._attrPairNames={};},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:true,buttonClass:_397,disabled:false,getLabel:function(key){return this.editor.commands[key];},_initButton:function(){if(this.command.length){var _399=this.getLabel(this.command),_39a=this.editor,_39b=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);if(!this.button){var _39c=lang.mixin({label:_399,ownerDocument:_39a.ownerDocument,dir:_39a.dir,lang:_39a.lang,showLabel:false,iconClass:_39b,dropDown:this.dropDown,tabIndex:"-1"},this.params||{});this.button=new this.buttonClass(_39c);}}if(this.get("disabled")&&this.button){this.button.set("disabled",this.get("disabled"));}},destroy:function(){var h;while(h=this._connects.pop()){h.remove();}if(this.dropDown){this.dropDown.destroyRecursive();}},connect:function(o,f,tf){this._connects.push(_395.connect(o,f,this,tf));},updateState:function(){var e=this.editor,c=this.command,_39d,_39e;if(!e||!e.isLoaded||!c.length){return;}var _39f=this.get("disabled");if(this.button){try{_39e=!_39f&&e.queryCommandEnabled(c);if(this.enabled!==_39e){this.enabled=_39e;this.button.set("disabled",!_39e);}if(_39e){if(typeof this.button.checked=="boolean"){_39d=e.queryCommandState(c);if(this.checked!==_39d){this.checked=_39d;this.button.set("checked",e.queryCommandState(c));}}}}catch(e){console.log(e);}}},setEditor:function(_3a0){this.editor=_3a0;this._initButton();if(this.button&&this.useDefaultCommand){if(this.editor.queryCommandAvailable(this.command)){this.connect(this.button,"onClick",lang.hitch(this.editor,"execCommand",this.command,this.commandArg));}else{this.button.domNode.style.display="none";}}this.connect(this.editor,"onNormalizedDisplayChanged","updateState");},setToolbar:function(_3a1){if(this.button){_3a1.addChild(this.button);}},set:function(name,_3a2){if(typeof name==="object"){for(var x in name){this.set(x,name[x]);}return this;}var _3a3=this._getAttrNames(name);if(this[_3a3.s]){var _3a4=this[_3a3.s].apply(this,Array.prototype.slice.call(arguments,1));}else{this._set(name,_3a2);}return _3a4||this;},get:function(name){var _3a5=this._getAttrNames(name);return this[_3a5.g]?this[_3a5.g]():this[name];},_setDisabledAttr:function(_3a6){this.disabled=_3a6;this.updateState();},_getAttrNames:function(name){var apn=this._attrPairNames;if(apn[name]){return apn[name];}var uc=name.charAt(0).toUpperCase()+name.substr(1);return (apn[name]={s:"_set"+uc+"Attr",g:"_get"+uc+"Attr"});},_set:function(name,_3a7){this[name]=_3a7;}});_398.registry={};return _398;});},"esri/layers/FeatureEditResult":function(){define("esri/layers/FeatureEditResult",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel"],function(_3a8,lang,has,_3a9){var _3aa=_3a8(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(json){if(json&&lang.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});if(has("extend-esri")){lang.setObject("layers.FeatureEditResult",_3aa,_3a9);}return _3aa;});},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../_base/Deferred"],function(_3ab,lang,_3ac){var _3ad=function(_3ae){if(!_3ae){return _3ae;}if(_3ae.then){_3ae=lang.delegate(_3ae);}function _3af(_3b0){if(!_3ae[_3b0]){_3ae[_3b0]=function(){var args=arguments;return _3ac.when(_3ae,function(_3b1){Array.prototype.unshift.call(args,_3b1);return _3ad(_3ab[_3b0].apply(_3ab,args));});};}};_3af("forEach");_3af("filter");_3af("map");if(!_3ae.total){_3ae.total=_3ac.when(_3ae,function(_3b2){return _3b2.length;});}return _3ae;};lang.setObject("dojo.store.util.QueryResults",_3ad);return _3ad;});},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(lang){var _3b3={};lang.setObject("dojo.data.util.sorter",_3b3);_3b3.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_3b3.createSortFunction=function(_3b4,_3b5){var _3b6=[];function _3b7(attr,dir,comp,s){return function(_3b8,_3b9){var a=s.getValue(_3b8,attr);var b=s.getValue(_3b9,attr);return dir*comp(a,b);};};var _3ba;var map=_3b5.comparatorMap;var bc=_3b3.basicComparator;for(var i=0;i<_3b4.length;i++){_3ba=_3b4[i];var attr=_3ba.attribute;if(attr){var dir=(_3ba.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_3b6.push(_3b7(attr,dir,comp,_3b5));}}return function(rowA,rowB){var i=0;while(i<_3b6.length){var ret=_3b6[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _3b3;});},"dojox/gfx/Mover":function(){define("dojox/gfx/Mover",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(lang,arr,_3bb,on,_3bc,_3bd){return _3bb("dojox.gfx.Mover",null,{constructor:function(_3be,e,host){this.shape=_3be;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=host,d=document,_3bf=on(d,_3bc.move,lang.hitch(this,"onFirstMove"));this.events=[on(d,_3bc.move,lang.hitch(this,"onMouseMove")),on(d,_3bc.release,lang.hitch(this,"destroy")),on(d,"dragstart",lang.hitch(_3bd,"stop")),on(d,"selectstart",lang.hitch(_3bd,"stop")),_3bf];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_3bd.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_3c0){_3c0.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});},"dojox/grid/Selection":function(){define("dojox/grid/Selection",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(_3c1,_3c2,lang,_3c3){return _3c1("dojox.grid.Selection",null,{constructor:function(_3c4){this.grid=_3c4;this.selected=[];this.setMode(_3c4.selectionMode);},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(mode){if(this.selected.length){this.deselectAll();}if(mode!="extended"&&mode!="multiple"&&mode!="single"&&mode!="none"){this.mode="extended";}else{this.mode=mode;}},onCanSelect:function(_3c5){return this.grid.onCanSelect(_3c5);},onCanDeselect:function(_3c6){return this.grid.onCanDeselect(_3c6);},onSelected:function(_3c7){},onDeselected:function(_3c8){},onChanging:function(){},onChanged:function(){},isSelected:function(_3c9){if(this.mode=="none"){return false;}return this.selected[_3c9];},getFirstSelected:function(){if(!this.selected.length||this.mode=="none"){return -1;}for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getNextSelected:function(_3ca){if(this.mode=="none"){return -1;}for(var i=_3ca+1,l=this.selected.length;i<l;i++){if(this.selected[i]){return i;}}return -1;},getSelected:function(){var _3cb=[];for(var i=0,l=this.selected.length;i<l;i++){if(this.selected[i]){_3cb.push(i);}}return _3cb;},getSelectedCount:function(){var c=0;for(var i=0;i<this.selected.length;i++){if(this.selected[i]){c++;}}return c;},_beginUpdate:function(){if(this.updating===0){this.onChanging();}this.updating++;},_endUpdate:function(){this.updating--;if(this.updating===0){this.onChanged();}},select:function(_3cc){if(this.mode=="none"){return;}if(this.mode!="multiple"){this.deselectAll(_3cc);this.addToSelection(_3cc);}else{this.toggleSelect(_3cc);}},addToSelection:function(_3cd){if(this.mode=="none"){return;}if(lang.isArray(_3cd)){_3c2.forEach(_3cd,this.addToSelection,this);return;}_3cd=Number(_3cd);if(this.selected[_3cd]){this.selectedIndex=_3cd;}else{if(this.onCanSelect(_3cd)!==false){this.selectedIndex=_3cd;var _3ce=this.grid.getRowNode(_3cd);if(_3ce){_3c3.set(_3ce,"aria-selected","true");}this._beginUpdate();this.selected[_3cd]=true;this.onSelected(_3cd);this._endUpdate();}}},deselect:function(_3cf){if(this.mode=="none"){return;}if(lang.isArray(_3cf)){_3c2.forEach(_3cf,this.deselect,this);return;}_3cf=Number(_3cf);if(this.selectedIndex==_3cf){this.selectedIndex=-1;}if(this.selected[_3cf]){if(this.onCanDeselect(_3cf)===false){return;}var _3d0=this.grid.getRowNode(_3cf);if(_3d0){_3c3.set(_3d0,"aria-selected","false");}this._beginUpdate();delete this.selected[_3cf];this.onDeselected(_3cf);this._endUpdate();}},setSelected:function(_3d1,_3d2){this[(_3d2?"addToSelection":"deselect")](_3d1);},toggleSelect:function(_3d3){if(lang.isArray(_3d3)){_3c2.forEach(_3d3,this.toggleSelect,this);return;}this.setSelected(_3d3,!this.selected[_3d3]);},_range:function(_3d4,inTo,func){var s=(_3d4>=0?_3d4:inTo),e=inTo;if(s>e){e=s;s=inTo;}for(var i=s;i<=e;i++){func(i);}},selectRange:function(_3d5,inTo){this._range(_3d5,inTo,lang.hitch(this,"addToSelection"));},deselectRange:function(_3d6,inTo){this._range(_3d6,inTo,lang.hitch(this,"deselect"));},insert:function(_3d7){this.selected.splice(_3d7,0,false);if(this.selectedIndex>=_3d7){this.selectedIndex++;}},remove:function(_3d8){this.selected.splice(_3d8,1);if(this.selectedIndex>=_3d8){this.selectedIndex--;}},deselectAll:function(_3d9){for(var i in this.selected){if((i!=_3d9)&&(this.selected[i]===true)){this.deselect(i);}}},clickSelect:function(_3da,_3db,_3dc){if(this.mode=="none"){return;}this._beginUpdate();if(this.mode!="extended"){this.select(_3da);}else{if(!_3dc||this.rangeStartIndex<0){this.rangeStartIndex=_3da;}if(!_3db){this.deselectAll(_3da);}if(_3dc){this.selectRange(this.rangeStartIndex,_3da);}else{if(_3db){this.toggleSelect(_3da);}else{this.addToSelection(_3da);}}}this._endUpdate();},clickSelectEvent:function(e){this.clickSelect(e.rowIndex,dojo.isCopyKey(e),e.shiftKey);},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate();}});});},"url:dojox/grid/resources/_Grid.html":"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\n</div>\n","dojox/grid/_RowManager":function(){define("dojox/grid/_RowManager",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class"],function(_3dd,lang,_3de){var _3df=function(_3e0,_3e1){if(_3e0.style.cssText==undefined){_3e0.setAttribute("style",_3e1);}else{_3e0.style.cssText=_3e1;}};return _3dd("dojox.grid._RowManager",null,{constructor:function(_3e2){this.grid=_3e2;},linesToEms:2,overRow:-2,prepareStylingRow:function(_3e3,_3e4){return {index:_3e3,node:_3e4,odd:Boolean(_3e3&1),selected:!!this.grid.selection.isSelected(_3e3),over:this.isOver(_3e3),customStyles:"",customClasses:"dojoxGridRow"};},styleRowNode:function(_3e5,_3e6){var row=this.prepareStylingRow(_3e5,_3e6);this.grid.onStyleRow(row);this.applyStyles(row);},applyStyles:function(_3e7){var i=_3e7;i.node.className=i.customClasses;var h=i.node.style.height;_3df(i.node,i.customStyles+";"+(i.node._style||""));i.node.style.height=h;},updateStyles:function(_3e8){this.grid.updateRowStyles(_3e8);},setOverRow:function(_3e9){var last=this.overRow;this.overRow=_3e9;if((last!=this.overRow)&&(lang.isString(last)||last>=0)){this.updateStyles(last);}this.updateStyles(this.overRow);},isOver:function(_3ea){return (this.overRow==_3ea&&!_3de.contains(this.grid.domNode,"dojoxGridColumnResizing"));}});});},"esri/dijit/editing/tools/DropDownToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dojo/dom-style","dijit/registry","dijit/Menu","dijit/form/ComboButton","esri/dijit/editing/tools/ToolBase","esri/kernel","esri/lang"],function(_3eb,lang,has,_3ec,_3ed,Menu,_3ee,_3ef,_3f0,_3f1){var DDTB=_3eb([_3ee,_3ef],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:false,_checked:false,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){var tool;var _3f2=this._tools;for(tool in _3f2){if(_3f2.hasOwnProperty(tool)&&_3f1.isDefined(_3f2[tool])){_3f2[tool].destroy();}}this.inherited(arguments);},_createTools:function(){var i;var mnu=new Menu();this.dropDown=mnu;for(i in this._tools){if(this._tools.hasOwnProperty(i)){mnu.addChild(this._tools[i]);}}this._activeTool=mnu.getChildren()[0];this._updateUI();},activate:function(_3f3){this.inherited(arguments);if(!this._activeTool){this._activateDefaultTool();}else{this._activeTool.activate();}},deactivate:function(){this.inherited(arguments);if(this._activeTool){this._activeTool.deactivate();}},enable:function(_3f4){var tool;for(tool in this._tools){if(this._tools.hasOwnProperty(tool)){this._tools[tool].enable(_3f4);}}this.setEnabled(true);this.inherited(arguments);},setChecked:function(_3f5){this._checked=_3f5;this._updateUI();},_onDrawEnd:function(_3f6){},onLayerChange:function(_3f7,type,_3f8){this._activeTool=null;this._activeType=type;this._activeTemplate=_3f8;this._activeLayer=_3f7;},onItemClicked:function(_3f9,evt){if(this._activeTool){this._activeTool.deactivate();}this._activeTool=_3ed.byId(_3f9);if(this._checked===false){this._onClick();}else{this._updateUI();if(this._activeTool){this._activeTool.activate();this._activeTool.setChecked(true);}}},_onClick:function(evt){if(this._enabled===false){return;}this._checked=!this._checked;this.inherited(arguments);},_updateUI:function(){this.attr("disabled",!this._enabled);_3ec.set(this.focusNode,{outline:"none"});_3ec.set(this.titleNode,{padding:"0px",border:"none"});if(this._checked){_3ec.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"});}else{_3ec.set(this.titleNode,{backgroundColor:"",border:""});}if(this._activeTool){this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon);this.attr("label",this._activeTool.label);}}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.DropDownToolBase",DDTB,_3f0);}return DDTB;});},"esri/dijit/editing/AttachmentEditor":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/kernel","dojo/has","dojo/query","dojo/io-query","dojo/dom-attr","dijit/_Widget","dijit/_Templated","esri/kernel","esri/lang","esri/domUtils","dojo/text!esri/dijit/editing/templates/AttachmentEditor.html","dojo/i18n!esri/nls/jsapi","dojo/NodeList-dom"],function(_3fa,_3fb,lang,_3fc,_3fd,_3fe,has,_3ff,_400,_401,_402,_403,_404,_405,_406,_407,_408){var AE=_3fb([_402,_403],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:true,templateString:_407,basePath:_3fa.toUrl("esri/dijit/editing")+"/",_listHtml:"<span id='node_${oid}_${attid}'><a href='${href}' target='_blank'>${name}</a>",_deleteBtnHtml:"(<span style='cursor:pointer;color:red;font-weight:bold;' class='deleteAttachment' id='${attid}');'>X</span>)",_endHtml:"<br/></span>",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},constructor:function(_409,_40a){lang.mixin(this,_408.widgets.attachmentEditor);},startup:function(){this.inherited(arguments);this._uploadField_connect=_3fc.connect(this._uploadField,"onchange",this,"_addAttachment");this._uploadFieldFocus_connect=_3fc.connect(this._uploadField,"onfocus",lang.hitch(this,function(e){_406.hide(this._attachmentError);}));},destroy:function(){_3fd.forEach(this._aeConnects,_3fc.disconnect);_3fc.disconnect(this._uploadField_connect);_3fc.disconnect(this._uploadFieldFocus_connect);this.inherited(arguments);},showAttachments:function(_40b,_40c){var list=this._attachmentList;list.innerHTML=this.NLS_none;this._uploadField.value="";_3fd.forEach(this.domNode.children,function(_40d,idx){_406.show(_40d);});_406.hide(this._attachmentError);if(!_40b){return;}this._featureLayer=_40b.getLayer()||_40c;if(!this._featureLayer){return;}if(this._featureLayer.declaredClass!=="esri.layers.FeatureLayer"||!this._featureLayer.getEditCapabilities){_406.hide(this._uploadForm);_3fd.forEach(this.domNode.children,function(_40e,idx){_406.hide(_40e);});return;}this._currentLayerId=this._featureLayer.id;if(!this._layerEditingCapChecked[this._currentLayerId]){this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities();this._layerEditingCapChecked[this._currentLayerId]=true;}this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:_40b}).canUpdate;this._oid=_40b.attributes[this._featureLayer.objectIdField];this._getAttachments(_40b);},_getAttachments:function(_40f){if(!this._featureLayer||!this._featureLayer.queryAttachmentInfos){return;}this._featureLayer.queryAttachmentInfos(this._oid,lang.hitch(this,"_onQueryAttachmentInfosComplete"));},_addAttachment:function(){_406.hide(this._attachmentError);if(!this._featureLayer||!this._featureLayer.addAttachment){return;}this._featureLayer.addAttachment(this._oid,this._uploadForm,lang.hitch(this,"_onAddAttachmentComplete"),lang.hitch(this,"_onAddAttachmentError"));},_deleteAttachment:function(oid,_410){this._featureLayer.deleteAttachments(oid,[_410],lang.hitch(this,"_onDeleteAttachmentComplete"));},_onQueryAttachmentInfosComplete:function(_411){var _412=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";if((!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate)||(!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate)){_412=this._listHtml+this._endHtml;this._uploadForm.style.display="none";}else{if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_412=this._listHtml+this._endHtml;}}var list=this._attachmentList,_413=_3fd.map(_411,lang.hitch(this,function(info){return _405.substitute({href:info.url,name:info.name,oid:info.objectId,attid:info.id},_412);}));list.innerHTML=_413.join("")||this.NLS_none;this._updateConnects();},_onAddAttachmentComplete:function(_414){var _415=this._uploadField;var _416=_415.value;var pos=_416.lastIndexOf("\\");if(pos>-1){_416=_416.substring(pos+1,_416.length);}_416=_416.replace(/\ /g,"_");var list=this._attachmentList,_417=_400.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var _418=this._listHtml+this._deleteBtnHtml+this._endHtml;if(this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate){_418=this._listHtml+this._endHtml;}var link=_405.substitute({href:this._featureLayer._url.path+"/"+_414.objectId+"/attachments/"+_414.attachmentId+(_417?("?"+_417):""),name:_416,oid:_414.objectId,attid:_414.attachmentId},_418);list.innerHTML=list.innerHTML==this.NLS_none?link:(list.innerHTML+link);this._updateConnects();_415.value="";},_onAddAttachmentError:function(_419){if(_419&&_405.isDefined(_419.code)){var _41a,_41b=this._attachmentError;if(_419.code===400){_41a=this.NLS_fileNotSupported;}else{_41a=_419.message||(_419.details&&_419.details.length&&_419.details[0]);}_401.set(_41b,"innerHTML",(_41a||this.NLS_error));_406.show(_41b);}},_onDeleteAttachmentComplete:function(_41c){var _41d=_3fd.every(_41c,function(_41e){return _41e.success;}),list=this._attachmentList;if(_41d){_3fe.query("#node_"+_41c[0].objectId+"_"+_41c[0].attachmentId).orphan();if(!list.children||!list.children.length){list.innerHTML=this.NLS_none;}}},_updateConnects:function(){_3fd.forEach(this._aeConnects,_3fc.disconnect);_3fe.query(".deleteAttachment").forEach(function(item){this._aeConnects.push(_3fc.connect(item,"onclick",lang.hitch(this,"_deleteAttachment",this._oid,item.id)));},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.AttachmentEditor",AE,_404);}return AE;});},"esri/dijit/editing/tools/Union":function(){define("esri/dijit/editing/tools/Union",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/graphicsUtils","esri/graphic","esri/toolbars/draw","esri/dijit/editing/Union","esri/dijit/editing/tools/ButtonToolBase","esri/kernel"],function(_41f,lang,_420,has,_421,_422,Draw,_423,_424,_425){var _426=_41f([_424],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:Draw.POLYLINE,_enabled:true,_label:"NLS_unionLbl",_onClick:function(evt){this._settings.editor._activeTool="UNION";var _427=this._settings.layers;var _428=_420.filter(_427,function(item){return (item.geometryType==="esriGeometryPolygon")&&(item.visible&&item._isMapAtVisibleScale());});var _429=[];var _42a=0;_420.forEach(_428,function(_42b,idx){var _42c=_42b.getSelectedFeatures();if(_42c.length>=2){_42a++;var _42d=_420.map(_42c,function(item){return new _422(lang.clone(item.toJson()));});this._settings.geometryService.union(_421.getGeometries(_42c),lang.hitch(this,function(_42e){var _42f=[_42c.pop().setGeometry(_42e)];_429.push({layer:_42b,updates:_42f,deletes:_42c,preUpdates:_42d});_42a--;if(_42a<=0){this.onApplyEdits(_429,lang.hitch(this,function(){if(this._settings.undoRedoManager){var _430=this._settings.undoRedoManager;_420.forEach(this._edits,lang.hitch(this,function(edit){_430.add(new _423({featureLayer:edit.layer,addedGraphics:edit.deletes,preUpdatedGraphics:edit.preUpdates,postUpdatedGraphics:edit.updates}));}),this);}this._settings.editor._selectionHelper.clearSelection(false);this.onFinished();}));}}));}},this);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Union",_426,_425);}return _426;});},"dojo/dnd/Avatar":function(){define(["../_base/declare","../_base/window","../dom","../dom-attr","../dom-class","../dom-construct","../hccss","../query"],function(_431,win,dom,_432,_433,_434,has,_435){return _431("dojo.dnd.Avatar",null,{constructor:function(_436){this.manager=_436;this.construct();},construct:function(){var a=_434.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),_437=this.manager.source,node,b=_434.create("tbody",null,a),tr=_434.create("tr",null,b),td=_434.create("td",null,tr),k=Math.min(5,this.manager.nodes.length),i=0;if(has("highcontrast")){_434.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"<"},td);}_434.create("span",{innerHTML:_437.generateText?this._generateText():""},td);_432.set(tr,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});for(;i<k;++i){if(_437.creator){node=_437._normalizedCreator(_437.getItem(this.manager.nodes[i].id).data,"avatar").node;}else{node=this.manager.nodes[i].cloneNode(true);if(node.tagName.toLowerCase()=="tr"){var _438=_434.create("table"),_439=_434.create("tbody",null,_438);_439.appendChild(node);node=_438;}}node.id="";tr=_434.create("tr",null,b);td=_434.create("td",null,tr);td.appendChild(node);_432.set(tr,{"class":"dojoDndAvatarItem",style:{opacity:(9-i)/10}});}this.node=a;},destroy:function(){_434.destroy(this.node);this.node=false;},update:function(){_433.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(has("highcontrast")){var icon=dom.byId("a11yIcon");var text="+";if(this.manager.canDropFlag&&!this.manager.copy){text="< ";}else{if(!this.manager.canDropFlag&&!this.manager.copy){text="o";}else{if(!this.manager.canDropFlag){text="x";}}}icon.innerHTML=text;}_435(("tr.dojoDndAvatarHeader td span"+(has("highcontrast")?" span":"")),this.node).forEach(function(node){node.innerHTML=this.manager.source.generateText?this._generateText():"";},this);},_generateText:function(){return this.manager.nodes.length.toString();}});});},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/dijit/editing/tools/MenuItemBase","esri/kernel"],function(_43a,lang,has,_43b,_43c){var Edit=_43a([_43b],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(_43d){this._enabled=_43d===this._geomType;this.inherited(arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Edit",Edit,_43c);}return Edit;});},"dojox/grid/_Scroller":function(){define("dojox/grid/_Scroller",["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],function(_43e,_43f,lang,util,html){var _440=function(_441){var i=0,n,p=_441.parentNode;while((n=p.childNodes[i++])){if(n==_441){return i-1;}}return -1;};var _442=function(_443){if(!_443){return;}dojo.forEach(_43e.toArray(),function(w){if(w.domNode&&html.isDescendant(w.domNode,_443,true)){w.destroy();}});};var _444=function(_445){var node=html.byId(_445);return (node&&node.tagName?node.tagName.toLowerCase():"");};var _446=function(_447,_448){var _449=[];var i=0,n;while((n=_447.childNodes[i])){i++;if(_444(n)==_448){_449.push(n);}}return _449;};var _44a=function(_44b){return _446(_44b,"div");};return _43f("dojox.grid._Scroller",null,{constructor:function(_44c){this.setContentNodes(_44c);this.pageHeights=[];this.pageNodes=[];this.stack=[];},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(_44d,_44e,_44f){switch(arguments.length){case 3:this.rowsPerPage=_44f;case 2:this.keepRows=_44e;case 1:this.rowCount=_44d;default:break;}this.defaultPageHeight=(this.grid.rowHeight>0?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();if(this.scrollboxNode){this.scrollboxNode.scrollTop=0;this.scroll(0);this.scrollboxNode.onscroll=lang.hitch(this,"onscroll");}},_getPageCount:function(_450,_451){return _450?(Math.ceil(_450/_451)||1):0;},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode;},setKeepInfo:function(_452){this.keepRows=_452;this.keepPages=!this.keepRows?this.keepPages:Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2);},setContentNodes:function(_453){this.contentNodes=_453;this.colCount=(this.contentNodes?this.contentNodes.length:0);this.pageNodes=[];for(var i=0;i<this.colCount;i++){this.pageNodes[i]=[];}},getDefaultNodes:function(){return this.pageNodes[0]||[];},invalidate:function(){this._invalidating=true;this.invalidateNodes();this.pageHeights=[];this.height=(this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0);this.resize();this._invalidating=false;},updateRowCount:function(_454){this.invalidateNodes();this.rowCount=_454;var _455=this.pageCount;if(_455===0){this.height=1;}this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<_455){for(var i=_455-1;i>=this.pageCount;i--){this.height-=this.getPageHeight(i);delete this.pageHeights[i];}}else{if(this.pageCount>_455){this.height+=this.defaultPageHeight*(this.pageCount-_455-1)+this.calcLastPageHeight();}}this.resize();},pageExists:function(_456){return Boolean(this.getDefaultPageNode(_456));},measurePage:function(_457){if(this.grid.rowHeight){return ((_457+1)*this.rowsPerPage>this.rowCount?this.rowCount-_457*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight;}var n=this.getDefaultPageNode(_457);return (n&&n.innerHTML)?n.offsetHeight:undefined;},positionPage:function(_458,_459){for(var i=0;i<this.colCount;i++){this.pageNodes[i][_458].style.top=_459+"px";}},repositionPages:function(_45a){var _45b=this.getDefaultNodes();var last=0;for(var i=0;i<this.stack.length;i++){last=Math.max(this.stack[i],last);}var n=_45b[_45a];var y=(n?this.getPageNodePosition(n)+this.getPageHeight(_45a):0);for(var p=_45a+1;p<=last;p++){n=_45b[p];if(n){if(this.getPageNodePosition(n)==y){return;}this.positionPage(p,y);}y+=this.getPageHeight(p);}},installPage:function(_45c){for(var i=0;i<this.colCount;i++){this.contentNodes[i].appendChild(this.pageNodes[i][_45c]);}},preparePage:function(_45d,_45e){var p=(_45e?this.popPage():null);for(var i=0;i<this.colCount;i++){var _45f=this.pageNodes[i];var _460=(p===null?this.createPageNode():this.invalidatePageNode(p,_45f));_460.pageIndex=_45d;_45f[_45d]=_460;}},renderPage:function(_461){var _462=[];var i,j;for(i=0;i<this.colCount;i++){_462[i]=this.pageNodes[i][_461];}for(i=0,j=_461*this.rowsPerPage;(i<this.rowsPerPage)&&(j<this.rowCount);i++,j++){this.renderRow(j,_462);}},removePage:function(_463){for(var i=0,j=_463*this.rowsPerPage;i<this.rowsPerPage;i++,j++){this.removeRow(j);}},destroyPage:function(_464){for(var i=0;i<this.colCount;i++){var n=this.invalidatePageNode(_464,this.pageNodes[i]);if(n){html.destroy(n);}}},pacify:function(_465){},pacifying:false,pacifyTicks:200,setPacifying:function(_466){if(this.pacifying!=_466){this.pacifying=_466;this.pacify(this.pacifying);}},startPacify:function(){this.startPacifyTicks=new Date().getTime();},doPacify:function(){var _467=(new Date().getTime()-this.startPacifyTicks)>this.pacifyTicks;this.setPacifying(true);this.startPacify();return _467;},endPacify:function(){this.setPacifying(false);},resize:function(){if(this.scrollboxNode){this.windowHeight=this.scrollboxNode.clientHeight;}for(var i=0;i<this.colCount;i++){util.setStyleHeightPx(this.contentNodes[i],Math.max(1,this.height));}var _468=(!this._invalidating);if(!_468){var ah=this.grid.get("autoHeight");if(typeof ah=="number"&&ah<=Math.min(this.rowsPerPage,this.rowCount)){_468=true;}}if(_468){this.needPage(this.page,this.pageTop);}var _469=(this.page<this.pageCount-1)?this.rowsPerPage:((this.rowCount%this.rowsPerPage)||this.rowsPerPage);var _46a=this.getPageHeight(this.page);this.averageRowHeight=(_46a>0&&_469>0)?(_46a/_469):0;},calcLastPageHeight:function(){if(!this.pageCount){return 0;}var _46b=this.pageCount-1;var _46c=((this.rowCount%this.rowsPerPage)||(this.rowsPerPage))*this.defaultRowHeight;this.pageHeights[_46b]=_46c;return _46c;},updateContentHeight:function(inDh){this.height+=inDh;this.resize();},updatePageHeight:function(_46d,_46e,_46f){if(this.pageExists(_46d)){var oh=this.getPageHeight(_46d);var h=(this.measurePage(_46d));if(h===undefined){h=oh;}this.pageHeights[_46d]=h;if(oh!=h){this.updateContentHeight(h-oh);var ah=this.grid.get("autoHeight");if((typeof ah=="number"&&ah>this.rowCount)||(ah===true&&!_46e)){if(!_46f){this.grid.sizeChange();}else{var ns=this.grid.viewsNode.style;ns.height=parseInt(ns.height)+h-oh+"px";this.repositionPages(_46d);}}else{this.repositionPages(_46d);}}return h;}return 0;},rowHeightChanged:function(_470,_471){this.updatePageHeight(Math.floor(_470/this.rowsPerPage),false,_471);},invalidateNodes:function(){while(this.stack.length){this.destroyPage(this.popPage());}},createPageNode:function(){var p=document.createElement("div");html.attr(p,"role","presentation");p.style.position="absolute";p.style[this.grid.isLeftToRight()?"left":"right"]="0";return p;},getPageHeight:function(_472){var ph=this.pageHeights[_472];return (ph!==undefined?ph:this.defaultPageHeight);},pushPage:function(_473){return this.stack.push(_473);},popPage:function(){return this.stack.shift();},findPage:function(_474){var i=0,h=0;for(var ph=0;i<this.pageCount;i++,h+=ph){ph=this.getPageHeight(i);if(h+ph>=_474){break;}}this.page=i;this.pageTop=h;},buildPage:function(_475,_476,_477){this.preparePage(_475,_476);this.positionPage(_475,_477);this.installPage(_475);this.renderPage(_475);this.pushPage(_475);},needPage:function(_478,_479){var h=this.getPageHeight(_478),oh=h;if(!this.pageExists(_478)){this.buildPage(_478,(!this.grid._autoHeight&&this.keepPages&&(this.stack.length>=this.keepPages)),_479);h=this.updatePageHeight(_478,true);}else{this.positionPage(_478,_479);}return h;},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop);},scroll:function(_47a){this.grid.scrollTop=_47a;if(this.colCount){this.startPacify();this.findPage(_47a);var h=this.height;var b=this.getScrollBottom(_47a);for(var p=this.page,y=this.pageTop;(p<this.pageCount)&&((b<0)||(y<b));p++){y+=this.needPage(p,y);}this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,_47a);this.lastVisibleRow=this.getLastVisibleRow(p-1,y,b);if(h!=this.height){this.repositionPages(p-1);}this.endPacify();}},getScrollBottom:function(_47b){return (this.windowHeight>=0?_47b+this.windowHeight:-1);},processNodeEvent:function(e,_47c){var t=e.target;while(t&&(t!=_47c)&&t.parentNode&&(t.parentNode.parentNode!=_47c)){t=t.parentNode;}if(!t||!t.parentNode||(t.parentNode.parentNode!=_47c)){return false;}var page=t.parentNode;e.topRowIndex=page.pageIndex*this.rowsPerPage;e.rowIndex=e.topRowIndex+_440(t);e.rowTarget=t;return true;},processEvent:function(e){return this.processNodeEvent(e,this.contentNode);},renderRow:function(_47d,_47e){},removeRow:function(_47f){},getDefaultPageNode:function(_480){return this.getDefaultNodes()[_480];},positionPageNode:function(_481,_482){},getPageNodePosition:function(_483){return _483.offsetTop;},invalidatePageNode:function(_484,_485){var p=_485[_484];if(p){delete _485[_484];this.removePage(_484,p);_442(p);p.innerHTML="";}return p;},getPageRow:function(_486){return _486*this.rowsPerPage;},getLastPageRow:function(_487){return Math.min(this.rowCount,this.getPageRow(_487+1))-1;},getFirstVisibleRow:function(_488,_489,_48a){if(!this.pageExists(_488)){return 0;}var row=this.getPageRow(_488);var _48b=this.getDefaultNodes();var rows=_44a(_48b[_488]);for(var i=0,l=rows.length;i<l&&_489<_48a;i++,row++){_489+=rows[i].offsetHeight;}return (row?row-1:row);},getLastVisibleRow:function(_48c,_48d,_48e){if(!this.pageExists(_48c)){return 0;}var _48f=this.getDefaultNodes();var row=this.getLastPageRow(_48c);var rows=_44a(_48f[_48c]);for(var i=rows.length-1;i>=0&&_48d>_48e;i--,row--){_48d-=rows[i].offsetHeight;}return row+1;},findTopRow:function(_490){var _491=this.getDefaultNodes();var rows=_44a(_491[this.page]);for(var i=0,l=rows.length,t=this.pageTop,h;i<l;i++){h=rows[i].offsetHeight;t+=h;if(t>=_490){this.offset=h-(t-_490);return i+this.page*this.rowsPerPage;}}return -1;},findScrollTop:function(_492){var _493=Math.floor(_492/this.rowsPerPage);var t=0;var i,l;for(i=0;i<_493;i++){t+=this.getPageHeight(i);}this.pageTop=t;this.page=_493;this.needPage(_493,this.pageTop);var _494=this.getDefaultNodes();var rows=_44a(_494[_493]);var r=_492-this.rowsPerPage*_493;for(i=0,l=rows.length;i<l&&i<r;i++){t+=rows[i].offsetHeight;}return t;},dummy:0});});},"dijit/ToolbarSeparator":function(){define("dijit/ToolbarSeparator",["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(_495,dom,_496,_497){return _495("dijit.ToolbarSeparator",[_496,_497],{templateString:"<div class=\"dijitToolbarSeparator dijitInline\" role=\"presentation\"></div>",buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.domNode,false);},isFocusable:function(){return false;}});});},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(lang){var _498={};lang.setObject("dojo.data.util.filter",_498);_498.patternToRegExp=function(_499,_49a){var rxp="^";var c=null;for(var i=0;i<_499.length;i++){c=_499.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_499.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_49a){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _498;});},"url:esri/dijit/editing/templates/TemplatePicker.html":"<div class=\"templatePicker\">\r\n\r\n  <table dojoType=\"dojox.grid.DataGrid\" noDataMessage=\"${emptyMessage}\" selectionMode=\"none\" autoHeight=\"${_rows}\" autoWidth=\"${_autoWidth}\"\r\n         query=\"{ query: '*' }\" dojoAttachPoint=\"grid\" class=\"grid\">\r\n  </table>\r\n  \r\n</div>","esri/toolbars/_GraphicMover":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/json","dojo/has","dojo/dom-style","dojox/gfx/Moveable","dojox/gfx/Mover","dojox/gfx/matrix","esri/kernel","esri/geometry/webMercatorUtils","esri/geometry/ScreenPoint"],function(_49b,lang,_49c,_49d,has,_49e,_49f,_4a0,_4a1,_4a2,_4a3,_4a4){var GM=_49b(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(_4a5,map,_4a6){this.graphic=_4a5;this.map=map;this.toolbar=_4a6;this._enableGraphicMover();this._moved=false;},refresh:function(_4a7){var _4a8=this.graphic.getDojoShape();if(_4a8&&(_4a7||!_4a8._hostGraphic)){this._disableGraphicMover();this._enableGraphicMover();}},destroy:function(){this._disableGraphicMover();},hasMoved:function(){return this._moved;},_enableGraphicMover:function(){var _4a9=this.graphic,_4aa=_4a9.getDojoShape();if(_4aa){_4aa._hostGraphic=_4a9;this._moveable=new _49f(_4aa,{mover:GM.Mover});this._moveStartHandle=_49c.connect(this._moveable,"onMoveStart",this,this._moveStartHandler);this._firstMoveHandle=_49c.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_49c.connect(this._moveable,"onMoving",this,this._movingHandler);this._moveStopHandle=_49c.connect(this._moveable,"onMoveStop",this,this._moveStopHandler);var node=_4aa.getEventSource();if(node){_49e.set(node,"cursor",this.toolbar._cursors.move);}}},_disableGraphicMover:function(){var _4ab=this._moveable;if(_4ab){_49c.disconnect(this._moveStartHandle);_49c.disconnect(this._firstMoveHandle);_49c.disconnect(this._movingHandle);_49c.disconnect(this._moveStopHandle);var _4ac=_4ab.shape;if(_4ac){_4ac._hostGraphic=null;var node=_4ac.getEventSource();if(node){_49e.set(node,"cursor",null);}}_4ab.destroy();}this._moveable=null;},_moveStartHandler:function(){var _4ad=this.graphic,map=this.map;this._startTx=_4ad.getDojoShape().getTransform();if(this.graphic.geometry.type==="point"){if(map.snappingManager){map.snappingManager._setUpSnapping();}}this.toolbar.onGraphicMoveStart(_4ad);},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic);},_movingHandler:function(_4ae){this.toolbar.onGraphicMove(this.graphic,_4ae.shape.getTransform());},_moveStopHandler:function(_4af){var _4b0=this.graphic,_4b1=this.toolbar,map=this.map,mx=_4a1,_4b2=_4b1._geo?_4a3.geographicToWebMercator(_4b0.geometry):_4b0.geometry,type=_4b2.type,_4b3=_4b0.getDojoShape(),tx=_4b3.getTransform();if(_49d.toJson(tx)!==_49d.toJson(this._startTx)){this._moved=true;switch(type){case "point":var _4b4=[tx,mx.invert(this._startTx)],_4b5;if(map.snappingManager){_4b5=map.snappingManager._snappingPoint;}_4b2=_4b5||map.toMap(mx.multiplyPoint(_4b4,map.toScreen(_4b2,true)));if(map.snappingManager){map.snappingManager._killOffSnapping();}break;case "polyline":_4b2=this._updatePolyGeometry(_4b2,_4b2.paths,tx);break;case "polygon":_4b2=this._updatePolyGeometry(_4b2,_4b2.rings,tx);break;}_4b3.setTransform(null);_4b0.setGeometry(_4b1._geo?_4a3.webMercatorToGeographic(_4b2,true):_4b2);}else{this._moved=false;}_4b1._endOperation("MOVE");_4b1.onGraphicMoveStop(_4b0,tx);if(!this._moved){var e=_4af.__e,_4b6=this.map.position,pt=new _4a4(e.pageX-_4b6.x,e.pageY-_4b6.y);_4b1.onGraphicClick(_4b0,{screenPoint:pt,mapPoint:this.map.toMap(pt)});}},_updatePolyGeometry:function(_4b7,_4b8,_4b9){var map=this.map,_4ba=_4b7.getPoint(0,0),_4bb=map.toMap(map.toScreen(_4ba).offset(_4b9.dx,_4b9.dy)),_4bc=_4bb.x-_4ba.x,_4bd=_4bb.y-_4ba.y,i,j,seg,_4be;for(i=0;i<_4b8.length;i++){seg=_4b8[i];for(j=0;j<seg.length;j++){_4be=_4b7.getPoint(i,j);_4b7.setPoint(i,j,_4be.offset(_4bc,_4bd));}}return _4b7;}});GM.Mover=_49b(_4a0,{declaredClass:"esri.toolbars._Mover",constructor:function(_4bf,e,host){this.__e=e;}});if(has("extend-esri")){lang.setObject("toolbars._GraphicMover",GM,_4a2);lang.setObject("toolbars._Mover",GM.Mover,_4a2);}return GM;});},"dijit/_editor/html":function(){define("dijit/_editor/html",["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(_4c0,lang,has){var _4c1={};lang.setObject("dijit._editor.html",_4c1);var _4c2=_4c1.escapeXml=function(str,_4c3){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_4c3){str=str.replace(/'/gm,"&#39;");}return str;};_4c1.getNodeHtml=function(node){var _4c4=[];_4c1.getNodeHtmlHelper(node,_4c4);return _4c4.join("");};_4c1.getNodeHtmlHelper=function(node,_4c5){switch(node.nodeType){case 1:var _4c6=node.nodeName.toLowerCase();if(!_4c6||_4c6.charAt(0)=="/"){return "";}_4c5.push("<",_4c6);var _4c7=[],_4c8={};var attr;if(has("dom-attributes-explicit")||has("dom-attributes-specified-flag")){var i=0;while((attr=node.attributes[i++])){var n=attr.name;if(n.substr(0,3)!=="_dj"&&(!has("dom-attributes-specified-flag")||attr.specified)&&!(n in _4c8)){var v=attr.value;if(n=="src"||n=="href"){if(node.getAttribute("_djrealurl")){v=node.getAttribute("_djrealurl");}}if(has("ie")===8&&n==="style"){v=v.replace("HEIGHT:","height:").replace("WIDTH:","width:");}_4c7.push([n,v]);_4c8[n]=v;}}}else{var _4c9=/^input$|^img$/i.test(node.nodeName)?node:node.cloneNode(false);var s=_4c9.outerHTML;var _4ca=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;var _4cb=s.match(_4ca);s=s.substr(0,s.indexOf(">"));_4c0.forEach(_4cb,function(attr){if(attr){var idx=attr.indexOf("=");if(idx>0){var key=attr.substring(0,idx);if(key.substr(0,3)!="_dj"){if(key=="src"||key=="href"){if(node.getAttribute("_djrealurl")){_4c7.push([key,node.getAttribute("_djrealurl")]);return;}}var val,_4cc;switch(key){case "style":val=node.style.cssText.toLowerCase();break;case "class":val=node.className;break;case "width":if(_4c6==="img"){_4cc=/width=(\S+)/i.exec(s);if(_4cc){val=_4cc[1];}break;}case "height":if(_4c6==="img"){_4cc=/height=(\S+)/i.exec(s);if(_4cc){val=_4cc[1];}break;}default:val=node.getAttribute(key);}if(val!=null){_4c7.push([key,val.toString()]);}}}}},this);}_4c7.sort(function(a,b){return a[0]<b[0]?-1:(a[0]==b[0]?0:1);});var j=0;while((attr=_4c7[j++])){_4c5.push(" ",attr[0],"=\"",(typeof attr[1]==="string"?_4c2(attr[1],true):attr[1]),"\"");}switch(_4c6){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":_4c5.push(" />");break;case "script":_4c5.push(">",node.innerHTML,"</",_4c6,">");break;default:_4c5.push(">");if(node.hasChildNodes()){_4c1.getChildrenHtmlHelper(node,_4c5);}_4c5.push("</",_4c6,">");}break;case 4:case 3:_4c5.push(_4c2(node.nodeValue,true));break;case 8:_4c5.push("<!--",_4c2(node.nodeValue,true),"-->");break;default:_4c5.push("<!-- Element not recognized - Type: ",node.nodeType," Name: ",node.nodeName,"-->");}};_4c1.getChildrenHtml=function(node){var _4cd=[];_4c1.getChildrenHtmlHelper(node,_4cd);return _4cd.join("");};_4c1.getChildrenHtmlHelper=function(dom,_4ce){if(!dom){return;}var _4cf=dom["childNodes"]||dom;var _4d0=!has("ie")||_4cf!==dom;var node,i=0;while((node=_4cf[i++])){if(!_4d0||node.parentNode==dom){_4c1.getNodeHtmlHelper(node,_4ce);}}};return _4c1;});},"url:esri/dijit/editing/templates/AttachmentEditor.html":"<div class=\"attachmentEditor\">\r\n    <br />\r\n    <div>\r\n        <b>${NLS_attachments}</b>\r\n        <hr />\r\n        <div dojoAttachPoint=\"_attachmentError\" style='color:red;display:none'></div>\r\n        <br />\r\n        <span dojoAttachPoint='_attachmentList' style='word-wrap: break-word;'></span>\r\n        <br><br>\r\n        <form dojoAttachPoint='_uploadForm'> ${NLS_add}:&nbsp;&nbsp;<input type='file' name='attachment' dojoAttachPoint='_uploadField' /> </form>\r\n    </div>\r\n</div>","dojox/grid/_Events":function(){define("dojox/grid/_Events",["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(keys,_4d1,_4d2,_4d3,has){return _4d2("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(e){this.dispatchKeyEvent(e);},onContentEvent:function(e){this.dispatchContentEvent(e);},onHeaderEvent:function(e){this.dispatchHeaderEvent(e);},onStyleRow:function(_4d4){var i=_4d4;i.customClasses+=(i.odd?" dojoxGridRowOdd":"")+(i.selected?" dojoxGridRowSelected":"")+(i.over?" dojoxGridRowOver":"");this.focus.styleRow(_4d4);this.edit.styleRow(_4d4);},onKeyDown:function(e){if(e.altKey||e.metaKey){return;}var _4d5;switch(e.keyCode){case keys.ESCAPE:this.edit.cancel();break;case keys.ENTER:if(!this.edit.isEditing()){_4d5=this.focus.getHeaderIndex();if(_4d5>=0){this.setSortIndex(_4d5);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_4d3.stop(e);}if(!e.shiftKey){var _4d6=this.edit.isEditing();this.edit.apply();if(!_4d6){this.edit.setEditCell(this.focus.cell,this.focus.rowIndex);}}if(!this.edit.isEditing()){var _4d7=this.focus.focusView||this.views.views[0];_4d7.content.decorateEvent(e);this.onRowClick(e);_4d3.stop(e);}break;case keys.SPACE:if(!this.edit.isEditing()){_4d5=this.focus.getHeaderIndex();if(_4d5>=0){this.setSortIndex(_4d5);break;}else{this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(e),e.shiftKey);}_4d3.stop(e);}break;case keys.TAB:this.focus[e.shiftKey?"previousKey":"nextKey"](e);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:if(!this.edit.isEditing()){var _4d8=e.keyCode;_4d3.stop(e);_4d5=this.focus.getHeaderIndex();if(_4d5>=0&&(e.shiftKey&&e.ctrlKey)){this.focus.colSizeAdjust(e,_4d5,(_4d8==keys.LEFT_ARROW?-1:1)*5);}else{var _4d9=(_4d8==keys.LEFT_ARROW)?1:-1;if(this.isLeftToRight()){_4d9*=-1;}this.focus.move(0,_4d9);}}break;case keys.UP_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_4d3.stop(e);this.focus.move(-1,0);}break;case keys.DOWN_ARROW:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_4d3.stop(e);this.focus.move(1,0);}break;case keys.PAGE_UP:if(!this.edit.isEditing()&&this.focus.rowIndex!==0){_4d3.stop(e);if(this.focus.rowIndex!=this.scroller.firstVisibleRow+1){this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1));this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0);}}break;case keys.PAGE_DOWN:if(!this.edit.isEditing()&&this.focus.rowIndex+1!=this.rowCount){_4d3.stop(e);if(this.focus.rowIndex!=this.scroller.lastVisibleRow-1){this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0);}else{this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1));this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0);}}break;default:break;}},onMouseOver:function(e){e.rowIndex==-1?this.onHeaderCellMouseOver(e):this.onCellMouseOver(e);},onMouseOut:function(e){e.rowIndex==-1?this.onHeaderCellMouseOut(e):this.onCellMouseOut(e);},onMouseDown:function(e){e.rowIndex==-1?this.onHeaderCellMouseDown(e):this.onCellMouseDown(e);},onMouseOverRow:function(e){if(!this.rows.isOver(e.rowIndex)){this.rows.setOverRow(e.rowIndex);e.rowIndex==-1?this.onHeaderMouseOver(e):this.onRowMouseOver(e);}},onMouseOutRow:function(e){if(this.rows.isOver(-1)){this.onHeaderMouseOut(e);}else{if(!this.rows.isOver(-2)){this.rows.setOverRow(-2);this.onRowMouseOut(e);}}},onMouseDownRow:function(e){if(e.rowIndex!=-1){this.onRowMouseDown(e);}},onCellMouseOver:function(e){if(e.cellNode){_4d1.add(e.cellNode,this.cellOverClass);}},onCellMouseOut:function(e){if(e.cellNode){_4d1.remove(e.cellNode,this.cellOverClass);}},onCellMouseDown:function(e){},onCellClick:function(e){this._click[0]=this._click[1];this._click[1]=e;if(!this.edit.isEditCell(e.rowIndex,e.cellIndex)){this.focus.setFocusCell(e.cell,e.rowIndex);}if(this._click.length>1&&this._click[0]==null){this._click.shift();}this.onRowClick(e);},onCellDblClick:function(e){var _4da;if(this._click.length>1&&has("ie")){_4da=this._click[1];}else{if(this._click.length>1&&this._click[0].rowIndex!=this._click[1].rowIndex){_4da=this._click[0];}else{_4da=e;}}this.focus.setFocusCell(_4da.cell,_4da.rowIndex);this.onRowClick(_4da);this.edit.setEditCell(_4da.cell,_4da.rowIndex);this.onRowDblClick(e);},onCellContextMenu:function(e){this.onRowContextMenu(e);},onCellFocus:function(_4db,_4dc){this.edit.cellFocus(_4db,_4dc);},onRowClick:function(e){this.edit.rowClick(e);this.selection.clickSelectEvent(e);},onRowDblClick:function(e){},onRowMouseOver:function(e){},onRowMouseOut:function(e){},onRowMouseDown:function(e){},onRowContextMenu:function(e){_4d3.stop(e);},onHeaderMouseOver:function(e){},onHeaderMouseOut:function(e){},onHeaderCellMouseOver:function(e){if(e.cellNode){_4d1.add(e.cellNode,this.cellOverClass);}},onHeaderCellMouseOut:function(e){if(e.cellNode){_4d1.remove(e.cellNode,this.cellOverClass);}},onHeaderCellMouseDown:function(e){},onHeaderClick:function(e){},onHeaderCellClick:function(e){this.setSortIndex(e.cell.index);this.onHeaderClick(e);},onHeaderDblClick:function(e){},onHeaderCellDblClick:function(e){this.onHeaderDblClick(e);},onHeaderCellContextMenu:function(e){this.onHeaderContextMenu(e);},onHeaderContextMenu:function(e){if(!this.headerMenu){_4d3.stop(e);}},onStartEdit:function(_4dd,_4de){},onApplyCellEdit:function(_4df,_4e0,_4e1){},onCancelEdit:function(_4e2){},onApplyEdit:function(_4e3){},onCanSelect:function(_4e4){return true;},onCanDeselect:function(_4e5){return true;},onSelected:function(_4e6){this.updateRowStyles(_4e6);},onDeselected:function(_4e7){this.updateRowStyles(_4e7);},onSelectionChanged:function(){}});});},"dijit/_KeyNavContainer":function(){define("dijit/_KeyNavContainer",["dojo/_base/kernel","./_Container","./_FocusMixin","dojo/_base/array","dojo/keys","dojo/_base/declare","dojo/_base/event","dojo/dom-attr","dojo/_base/lang"],function(_4e8,_4e9,_4ea,_4eb,keys,_4ec,_4ed,_4ee,lang){return _4ec("dijit._KeyNavContainer",[_4ea,_4e9],{tabIndex:"0",connectKeyNavHandlers:function(_4ef,_4f0){var _4f1=(this._keyNavCodes={});var prev=lang.hitch(this,"focusPrev");var next=lang.hitch(this,"focusNext");_4eb.forEach(_4ef,function(code){_4f1[code]=prev;});_4eb.forEach(_4f0,function(code){_4f1[code]=next;});_4f1[keys.HOME]=lang.hitch(this,"focusFirstChild");_4f1[keys.END]=lang.hitch(this,"focusLastChild");this.connect(this.domNode,"onkeypress","_onContainerKeypress");this.connect(this.domNode,"onfocus","_onContainerFocus");},startupKeyNavChildren:function(){_4e8.deprecated("startupKeyNavChildren() call no longer needed","","2.0");},startup:function(){this.inherited(arguments);_4eb.forEach(this.getChildren(),lang.hitch(this,"_startupChild"));},addChild:function(_4f2,_4f3){this.inherited(arguments);this._startupChild(_4f2);},focus:function(){this.focusFirstChild();},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild());},focusLastChild:function(){this.focusChild(this._getLastFocusableChild());},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1));},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),true);},focusChild:function(_4f4,last){if(!_4f4){return;}if(this.focusedChild&&_4f4!==this.focusedChild){this._onChildBlur(this.focusedChild);}_4f4.set("tabIndex",this.tabIndex);_4f4.focus(last?"end":"start");this._set("focusedChild",_4f4);},_startupChild:function(_4f5){_4f5.set("tabIndex","-1");this.connect(_4f5,"_onFocus",function(){_4f5.set("tabIndex",this.tabIndex);});this.connect(_4f5,"_onBlur",function(){_4f5.set("tabIndex","-1");});},_onContainerFocus:function(evt){if(evt.target!==this.domNode||this.focusedChild){return;}this.focusFirstChild();_4ee.set(this.domNode,"tabIndex","-1");},_onBlur:function(evt){if(this.tabIndex){_4ee.set(this.domNode,"tabIndex",this.tabIndex);}this.focusedChild=null;this.inherited(arguments);},_onContainerKeypress:function(evt){if(evt.ctrlKey||evt.altKey){return;}var func=this._keyNavCodes[evt.charOrCode];if(func){func();_4ed.stop(evt);}},_onChildBlur:function(){},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1);},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1);},_getNextFocusableChild:function(_4f6,dir){if(_4f6){_4f6=this._getSiblingOfChild(_4f6,dir);}var _4f7=this.getChildren();for(var i=0;i<_4f7.length;i++){if(!_4f6){_4f6=_4f7[(dir>0)?0:(_4f7.length-1)];}if(_4f6.isFocusable()){return _4f6;}_4f6=this._getSiblingOfChild(_4f6,dir);}return null;}});});},"esri/dijit/AttributeInspector":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/sniff","dojo/_base/kernel","dojo/has","dojo/dom-style","dojo/dom-construct","esri/kernel","esri/lang","esri/domUtils","esri/layers/InheritedDomain","esri/layers/FeatureLayer","dojo/i18n!esri/nls/jsapi","dojo/fx","dojox/gfx","dijit/_Widget","dijit/_Templated","dijit/Editor","dijit/_editor/plugins/LinkDialog","dijit/_editor/plugins/TextColor","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Util","esri/tasks/query","dijit/form/DateTextBox","dijit/form/TextBox","dijit/form/NumberTextBox","dijit/form/FilteringSelect","dijit/form/NumberSpinner","dijit/form/Button","dijit/form/SimpleTextarea","dijit/Tooltip","dojo/data/ItemFileReadStore","dojox/date/islamic","dojox/date/islamic/Date","dojox/date/islamic/locale","dojo/text!esri/dijit/templates/AttributeInspector.html"],function(_4f8,lang,_4f9,_4fa,_4fb,_4fc,has,_4fd,_4fe,_4ff,_500,_501,_502,_503,_504,fx,gfx,_505,_506,_507,_508,_509,_50a,Util,_50b,_50c,_50d,_50e,_50f,_510,_511,_512,_513,_514,_515,_516,_517,_518){var ATI=_4f8([_505,_506],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:true,templateString:_518,_navMessage:"( ${idx} ${of} ${numFeatures} )",onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},constructor:function(_519,_51a){lang.mixin(this,_504.widgets.attributeInspector);_519=_519||{};if(!_519.featureLayer&&!_519.layerInfos){console.error("esri.AttributeInspector: please provide correct parameter in the constructor");}this._userIds={};if(_519.featureLayer&&_519.featureLayer.credential){var _51b=_519.featureLayer.id;this._userIds[_51b]=_519.featureLayer.credential.userId;}else{if(_519.layerInfos){var _51c=_519.layerInfos;_4f9.forEach(_51c,function(_51d){if(_51d.featureLayer){var _51e=_51d.featureLayer.id;if(_51d.featureLayer.credential){this._userIds[_51e]=_51d.featureLayer.credential.userId;}if(_51d.userId){this._userIds[_51e]=_51d.userId;}}},this);}}this._datePackage=this._getDatePackage(_519);this._layerInfos=_519.layerInfos||[{featureLayer:_519.featureLayer,options:_519.options||[]}];this._aiConnects=[];this._selection=[];this._toolTips=[];this._numFeatures=0;this._featureIdx=0;this._currentLInfo=null;this._currentFeature=null;this._hideNavButtons=_519.hideNavButtons||false;},postCreate:function(){this._initLayerInfos();this._createAttachmentEditor();this.onFirstFeature();},destroy:function(){this._destroyAttributeTable();_4f9.forEach(this._aiConnects,_4fa.disconnect);delete this._aiConnects;if(this._attachmentEditor){this._attachmentEditor.destroy();delete this._attachmentEditor;}delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments);},refresh:function(){this._updateSelection();},first:function(){this.onFirstFeature();},last:function(){this.onLastFeature();},next:function(){this.onNextFeature();},previous:function(){this.onPreviousFeature();},showFeature:function(_51f,_520){if(_520){this._createOnlyFirstTime=true;}this._updateSelection([_51f],_520);this._updateUI();},onLayerSelectionChange:function(_521,_522,_523){this._createOnlyFirstTime=false;this._featureIdx=(_523===_503.SELECTION_NEW)?0:this._featureIdx;this._updateSelection();this._updateUI();},onLayerSelectionClear:function(){if(!this._selection||this._selection.length<=0){return;}this._numFeatures=0;this._featureIdx=0;this._selection=[];this._currentFeature=null;this._currentLInfo=null;this._updateUI();},onLayerEditsComplete:function(_524,adds,_525,_526){_526=_526||[];if(_526.length){var _527=this._selection;var _528=_524.featureLayer.objectIdField;_4f9.forEach(_526,lang.hitch(this,function(del){_4f9.some(_527,lang.hitch(this,function(item,idx){if(item.attributes[_528]!==del.objectId){return false;}this._selection.splice(idx,1);return true;}));}));}adds=adds||[];if(adds.length){this._selection=Util.findFeatures(adds,_524.featureLayer);this._featureIdx=0;}var _529=this._numFeatures=this._selection?this._selection.length:0;if(adds.length){var _52a=_529?this._selection[this._featureIdx]:null;if(_52a){var _52b=_52a.getLayer();var _52c=_52b.getEditCapabilities();if(!(_52c.canCreate&&!_52c.canUpdate)){this._showFeature(_52a);}}}this._updateUI();},onFieldValueChange:function(_52d,_52e){_52e=(typeof _52e==="undefined")?null:_52e;var _52f=_52d.field;if(_52f.type==="esriFieldTypeDate"){_52e=(_52e&&_52e.getTime)?_52e.getTime():(_52e&&_52e.toGregorian?_52e.toGregorian().getTime():_52e);}if(this._currentFeature.attributes[_52f.name]===_52e){return;}var _530=this._currentLInfo;var _531=this._currentFeature;var _532=_52f.name;if(_532===_530.typeIdField){var type=this._findFirst(_530.types,"id",_52e);var _533=_530.fieldInfos;_4f9.forEach(_533,function(_534){_52f=_534.field;if(!_52f||_52f.name===_530.typeIdField){return;}var node=_534.dijit;var _535=this._setFieldDomain(node,type,_52f);if(_535&&node){this._setValue(node,_531.attributes[_52f.name]+"");if(node.isValid()===false){this._setValue(node,null);}}},this);}this.onAttributeChange(_531,_532,_52e);},onDeleteBtn:function(evt){this._deleteFeature();},onNextFeature:function(evt){this._onNextFeature(1);},onPreviousFeature:function(evt){this._onNextFeature(-1);},onFirstFeature:function(evt){this._onNextFeature(this._featureIdx*-1);},onLastFeature:function(evt){this._onNextFeature((this._numFeatures-1)-this._featureIdx);},_initLayerInfos:function(){var _536=this._layerInfos;this._editorTrackingInfos={};_4f9.forEach(_536,this._initLayerInfo,this);},_initLayerInfo:function(_537){var _538=_537.featureLayer,_539,_53a;this._connect(_538,"onSelectionComplete",lang.hitch(this,"onLayerSelectionChange",_537));this._connect(_538,"onSelectionClear",lang.hitch(this,"onLayerSelectionClear",_537));this._connect(_538,"onEditsComplete",lang.hitch(this,"onLayerEditsComplete",_537));_537.showAttachments=_538.hasAttachments?(_500.isDefined(_537.showAttachments)?_537.showAttachments:true):false;_537.hideFields=_537.hideFields||[];_537.htmlFields=_537.htmlFields||[];_537.isEditable=_538.isEditable()?(_500.isDefined(_537.isEditable)?_537.isEditable:true):false;_537.typeIdField=_538.typeIdField;_537.layerId=_538.id;_537.types=_538.types;if(_538.globalIdField){_539=this._findFirst(_537.fieldInfos,"fieldName",_538.globalIdField);if(!_539&&!_537.showGlobalID){_537.hideFields.push(_538.globalIdField);}}_53a=this._findFirst(_537.fieldInfos,"fieldName",_538.objectIdField);if(!_53a&&!_537.showObjectID){_537.hideFields.push(_538.objectIdField);}var _53b=this._getFields(_537.featureLayer);if(!_53b){return;}var _53c=_537.fieldInfos||[];_53c=_4f9.map(_53c,function(_53d){return lang.mixin({},_53d);});if(!_53c.length){_53b=_4f9.filter(_53b,lang.hitch(this,function(_53e){return !this._isInFields(_53e.name,_537.hideFields);}));_537.fieldInfos=_4f9.map(_53b,lang.hitch(this,function(_53f){var _540=(this._isInFields(_53f.name,_537.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return {"fieldName":_53f.name,"field":_53f,"stringFieldOption":_540};}));}else{_537.fieldInfos=_4f9.filter(_4f9.map(_53c,lang.hitch(this,function(_541){var _542=_541.stringFieldOption||(this._isInFields(_541.fieldName,_537.htmlFields)?ATI.STRING_FIELD_OPTION_RICHTEXT:ATI.STRING_FIELD_OPTION_TEXTBOX);return lang.mixin(_541,{"field":this._findFirst(_53b,"name",_541.fieldName),"stringFieldOption":_542});})),"return item.field;");}if(_537.showGlobalID&&!_539){_53c.push(this._findFirst(_53b,"name",_538.globalIdField));}if(_537.showObjectID&&!_53a){_53c.push(this._findFirst(_53b,"name",_538.objectIdField));}var _543=[];if(_538.editFieldsInfo){if(_538.editFieldsInfo.creatorField){_543.push(_538.editFieldsInfo.creatorField);}if(_538.editFieldsInfo.creationDateField){_543.push(_538.editFieldsInfo.creationDateField);}if(_538.editFieldsInfo.editorField){_543.push(_538.editFieldsInfo.editorField);}if(_538.editFieldsInfo.editDateField){_543.push(_538.editFieldsInfo.editDateField);}}this._editorTrackingInfos[_538.id]=_543;},_createAttachmentEditor:function(){this._attachmentEditor=null;var _544=this._layerInfos;var _545=_4f9.filter(_544,function(item){return item.showAttachments;});if(!_545||!_545.length){return;}this._attachmentEditor=new _50a({"class":"atiAttachmentEditor"},this.attachmentEditor);this._attachmentEditor.startup();},_setCurrentLInfo:function(_546){var _547=this._currentLInfo?this._currentLInfo.featureLayer:null;var _548=_546.featureLayer;if(_547&&_547.id===_548.id&&!_547.ownershipBasedAccessControlForFeatures){var _549=_548.getEditCapabilities();if(!(_549.canCreate&&!_549.canUpdate)){return;}}this._currentLInfo=_546;this._createTable();},_updateSelection:function(_54a,_54b){this._selection=_54a||[];var _54c=this._layerInfos;_4f9.forEach(_54c,this._getSelection,this);var _54d=this._numFeatures=this._selection.length;var _54e=_54d?this._selection[this._featureIdx]:null;this._showFeature(_54e,_54b);},_getSelection:function(_54f){var _550=_54f.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(_550);},_updateUI:function(){var _551=this._numFeatures;var _552=this._currentLInfo;this.layerName.innerHTML=(!_552||_551===0)?this.NLS_noFeaturesSelected:(_552.featureLayer?_552.featureLayer.name:"");_4fd.set(this.attributeTable,"display",_551?"":"none");_4fd.set(this.editButtons,"display",_551?"":"none");_4fd.set(this.navButtons,"display",(!this._hideNavButtons&&(_551>1)?"":"none"));this.navMessage.innerHTML=_500.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);if(this._attachmentEditor){_4fd.set(this._attachmentEditor.domNode,"display",((_552&&_552.showAttachments)&&_551)?"":"none");}var _553=((_552&&_552.showDeleteButton===false)||!this._canDelete)?false:true;_4fd.set(this.deleteBtn.domNode,"display",_553?"":"none");if(this.domNode.parentNode&&this.domNode.parentNode.scrollTop>0){this.domNode.parentNode.scrollTop=0;}},_onNextFeature:function(_554){this._featureIdx+=_554;if(this._featureIdx<0){this._featureIdx=this._numFeatures-1;}else{if(this._featureIdx>=this._numFeatures){this._featureIdx=0;}}var _555=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(_555);this._updateUI();this.onNext(_555);},_deleteFeature:function(){this.onDelete(this._currentFeature);},_showFeature:function(_556,_557){if(!_556){return;}this._currentFeature=_556;var _558=_557?_557:_556.getLayer();var _559=_558.getEditCapabilities({feature:_556,userId:this._userIds[_558.id]});this._canUpdate=_559.canUpdate;this._canDelete=_559.canDelete;var _55a=this._getLInfoFromFeatureLayer(_558);if(!_55a){return;}this._setCurrentLInfo(_55a);var _55b=_556.attributes;var type=this._findFirst(_55a.types,"id",_55b[_55a.typeIdField]);var node,_55c=null;var _55d=_55a.fieldInfos;_4f9.forEach(_55d,function(_55e){_55c=_55e.field;node=_55e.dijit||null;if(!node){return;}var _55f=this._setFieldDomain(node,type,_55c);var _560=_55b[_55c.name];_560=(_560&&_55f&&_55f.codedValues&&_55f.codedValues.length)?(_55f.codedValues[_560]?_55f.codedValues[_560].name:_560):_560;if(!_500.isDefined(_560)){_560="";}if(node.declaredClass==="dijit.form.DateTextBox"){_560=(_560==="")?null:new Date(_560);}else{if(node.declaredClass==="dijit.form.FilteringSelect"){node._lastValueReported=null;_560=_55b[_55c.name]+"";}}try{this._setValue(node,_560);if(node.declaredClass==="dijit.form.FilteringSelect"&&node.isValid()===false){this._setValue(node,null);}}catch(error){node.set("displayedValue",this.NLS_errorInvalid,false);}},this);if(this._attachmentEditor&&_55a.showAttachments){this._attachmentEditor.showAttachments(this._currentFeature);}var _561=_558.getEditSummary(_556);if(_561){this.editorTrackingInfoDiv.innerHTML=_561;_501.show(this.editorTrackingInfoDiv);}else{_501.hide(this.editorTrackingInfoDiv);}},_setFieldDomain:function(node,type,_562){if(!node){return null;}var _563=_562.domain;if(type&&type.domains){if(type.domains[_562.name]&&type.domains[_562.name] instanceof _502===false){_563=type.domains[_562.name];}}if(!_563){return null;}if(_563.codedValues&&_563.codedValues.length>0){node.set("store",this._toStore(_4f9.map(_563.codedValues,function(item){return {id:item.code+="",name:item.name};})));this._setValue(node,_563.codedValues[0].code);}else{node.constraints={min:_500.isDefined(_563.minValue)?_563.minValue:Number.MIN_VALUE,max:_500.isDefined(_563.maxValue)?_563.maxValue:Number.MAX_VALUE};this._setValue(node,node.constraints.min);}return _563;},_setValue:function(node,_564){if(!node.set){return;}node._onChangeActive=false;node.set("value",_564,true);node._onChangeActive=true;},_getFields:function(_565){var _566=_565._getOutFields();if(!_566){return null;}var _567=_565.fields;return (_566=="*")?_567:_4f9.filter(_4f9.map(_566,lang.hitch(this,"_findFirst",_567,"name")),_500.isDefined);},_isInFields:function(_568,_569){if(!_568||!_569&&!_569.length){return false;}return _4f9.some(_569,function(name){return name.toLowerCase()===_568.toLowerCase();});},_findFirst:function(_56a,_56b,_56c){var _56d=_4f9.filter(_56a,function(item){return item.hasOwnProperty(_56b)&&item[_56b]===_56c;});return (_56d&&_56d.length)?_56d[0]:null;},_getLInfoFromFeatureLayer:function(_56e){var _56f=_56e?_56e.id:null;return this._findFirst(this._layerInfos,"layerId",_56f);},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=_4fe.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var _570=_4fe.create("tbody",null,this._attributes);var _571=this._currentFeature;var _572=this._currentLInfo;var type=this._findFirst(_572.types,"id",_571.attributes[_572.typeIdField]);var _573=_572.fieldInfos;_4f9.forEach(_573,lang.hitch(this,"_createField",type,_570),this);this._createOnlyFirstTime=false;},_createField:function(type,_574,_575){var _576=this._currentLInfo;var _577=_575.field;if(this._isInFields(_577.name,_576.hideFields)){return;}if(this._isInFields(_577.name,this._editorTrackingInfos[_576.featureLayer.id])){return;}var node=_4fe.create("tr",null,_574);var td=_4fe.create("td",{innerHTML:_575.label||_577.alias||_577.name,"class":"atiLabel"},node);td=_4fe.create("td",null,node);var _578=null;var _579=false;if(_575.customField){_4fe.place(_575.customField.domNode||_575.customField,_4fe.create("div",null,td),"first");_578=_575.customField;}else{if(_576.isEditable===false||_577.editable===false||_575.isEditable===false||_577.type==="esriFieldTypeOID"||_577.type==="esriFieldTypeGlobalID"||(!this._canUpdate&&!this._createOnlyFirstTime)){_579=true;}}if(!_578&&(_576.typeIdField&&_577.name.toLowerCase()==_576.typeIdField.toLowerCase())){_578=this._createTypeField(_577,_575,td);}else{if(!_578){_578=this._createDomainField(_577,_575,type,td);}}if(!_578){switch(_577.type){case "esriFieldTypeString":_578=this._createStringField(_577,_575,td);break;case "esriFieldTypeDate":_578=this._createDateField(_577,_575,td);break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":_578=this._createIntField(_577,_575,td);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":_578=this._createFltField(_577,_575,td);break;default:_578=this._createStringField(_577,_575,td);break;}}if(_575.tooltip&&_575.tooltip.length){this._toolTips.push(new _513({connectId:[_578.id],label:_575.tooltip}));}_578.onChange=lang.hitch(this,"onFieldValueChange",_575);_578.set("disabled",_579);_575.dijit=_578;},_createTypeField:function(_57a,_57b,node){return new _50f({"class":"atiField",name:_57a.alias||_57a.name,store:this._toStore(_4f9.map(this._currentLInfo.types,function(item){return {id:item.id,name:item.name};})),searchAttr:"name"},_4fe.create("div",null,node));},_createDomainField:function(_57c,_57d,type,node){var _57e=_57c.domain;if(type&&type.domains){if(type.domains[_57c.name]&&type.domains[_57c.name] instanceof _502===false){_57e=type.domains[_57c.name];}}if(!_57e){return null;}if(_57e.codedValues){return new _50f({"class":"atiField",name:_57c.alias||_57c.name,searchAttr:"name",required:_57c.nullable||false},_4fe.create("div",null,node));}else{return new _510({"class":"atiField"},_4fe.create("div",null,node));}},_createStringField:function(_57f,_580,node){var _581={"class":"atiField",trim:true,maxLength:_57f.length};if(_580.stringFieldOption===ATI.STRING_FIELD_OPTION_TEXTAREA){_581["class"]+=" atiTextAreaField";return new _512(_581,_4fe.create("div",null,node));}else{if(_580.stringFieldOption===ATI.STRING_FIELD_OPTION_RICHTEXT){_581["class"]+=" atiRichTextField";_581.height="100%";_581.width="100%";_581.plugins=_580.richTextPlugins||["bold","italic","underline","foreColor","hiliteColor","|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];return new _507(_581,_4fe.create("div",null,node));}else{return new _50d(_581,_4fe.create("div",null,node));}}},_createDateField:function(_582,_583,node){var _584={"class":"atiField","trim":true};if(this._datePackage){_584.datePackage=this._datePackage;}return new _50c(_584,_4fe.create("div",null,node));},_createIntField:function(_585,_586,node){return new _50e({"class":"atiField",constraints:{places:0},invalidMessage:this.NLS_validationInt,trim:true},_4fe.create("div",null,node));},_createFltField:function(_587,_588,node){return new _50e({"class":"atiField",trim:true,invalidMessage:this.NLS_validationFlt},_4fe.create("div",null,node));},_toStore:function(_589){return new _514({data:{identifier:"id",label:"name",items:_589}});},_connect:function(node,evt,func){this._aiConnects.push(_4fa.connect(node,evt,func));},_getDatePackage:function(_58a){if(_58a.datePackage===null){return null;}else{if(_58a.datePackage){return _58a.datePackage;}else{if(_4fc.locale==="ar"){return "dojox.date.islamic";}}}return null;},_destroyAttributeTable:function(){var _58b=this._layerInfos;_4f9.forEach(_58b,function(_58c){var _58d=_58c.fieldInfos;_4f9.forEach(_58d,function(_58e){var _58f=_58e.dijit;if(_58f){_58f._onChangeHandle=null;if(_58e.customField){return;}if(_58f.destroyRecursive){_58f.destroyRecursive();}else{if(_58f.destroy){_58f.destroy();}}}_58e.dijit=null;},this);},this);var _590=this._toolTips;_4f9.forEach(_590,function(item){item.destroy();delete item;});this._toolTips=[];if(this._attributes){_4fe.destroy(this._attributes);}}});lang.mixin(ATI,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});if(has("extend-esri")){lang.setObject("dijit.AttributeInspector",ATI,_4ff);}return ATI;});},"dojox/date/islamic/locale":function(){define("dojox/date/islamic/locale",["../..","dojo/_base/lang","dojo/_base/array","dojo/date","dojo/i18n","dojo/regexp","dojo/string","./Date","dojo/i18n!dojo/cldr/nls/islamic"],function(_591,lang,arr,dd,i18n,_592,_593,_594,_595){var _596=lang.getObject("date.islamic.locale",true,_591);function _597(_598,_599,_59a,_59b,_59c){return _59c.replace(/([a-z])\1*/ig,function(_59d){var s,pad;var c=_59d.charAt(0);var l=_59d.length;var _59e=["abbr","wide","narrow"];switch(c){case "G":s=_599["eraAbbr"][0];break;case "y":s=String(_598.getFullYear());break;case "M":var m=_598.getMonth();if(l<3){s=m+1;pad=true;}else{var _59f=["months","format",_59e[l-3]].join("-");s=_599[_59f][m];}break;case "d":s=_598.getDate(true);pad=true;break;case "E":var d=_598.getDay();if(l<3){s=d+1;pad=true;}else{var _5a0=["days","format",_59e[l-3]].join("-");s=_599[_5a0][d];}break;case "a":var _5a1=(_598.getHours()<12)?"am":"pm";s=_599["dayPeriods-format-wide-"+_5a1];break;case "h":case "H":case "K":case "k":var h=_598.getHours();switch(c){case "h":s=(h%12)||12;break;case "H":s=h;break;case "K":s=(h%12);break;case "k":s=h||24;break;}pad=true;break;case "m":s=_598.getMinutes();pad=true;break;case "s":s=_598.getSeconds();pad=true;break;case "S":s=Math.round(_598.getMilliseconds()*Math.pow(10,l-3));pad=true;break;case "z":s=dd.getTimezoneName(_598.toGregorian());if(s){break;}l=4;case "Z":var _5a2=_598.toGregorian().getTimezoneOffset();var tz=[(_5a2<=0?"+":"-"),_593.pad(Math.floor(Math.abs(_5a2)/60),2),_593.pad(Math.abs(_5a2)%60,2)];if(l==4){tz.splice(0,0,"GMT");tz.splice(3,0,":");}s=tz.join("");break;default:throw new Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+_59c);}if(pad){s=_593.pad(s,l);}return s;});};_596.format=function(_5a3,_5a4){_5a4=_5a4||{};var _5a5=i18n.normalizeLocale(_5a4.locale);var _5a6=_5a4.formatLength||"short";var _5a7=_596._getIslamicBundle(_5a5);var str=[];var _5a8=lang.hitch(this,_597,_5a3,_5a7,_5a5,_5a4.fullYear);if(_5a4.selector=="year"){var year=_5a3.getFullYear();return year;}if(_5a4.selector!="time"){var _5a9=_5a4.datePattern||_5a7["dateFormat-"+_5a6];if(_5a9){str.push(_5aa(_5a9,_5a8));}}if(_5a4.selector!="date"){var _5ab=_5a4.timePattern||_5a7["timeFormat-"+_5a6];if(_5ab){str.push(_5aa(_5ab,_5a8));}}var _5ac=str.join(" ");return _5ac;};_596.regexp=function(_5ad){return _596._parseInfo(_5ad).regexp;};_596._parseInfo=function(_5ae){_5ae=_5ae||{};var _5af=i18n.normalizeLocale(_5ae.locale);var _5b0=_596._getIslamicBundle(_5af);var _5b1=_5ae.formatLength||"short";var _5b2=_5ae.datePattern||_5b0["dateFormat-"+_5b1];var _5b3=_5ae.timePattern||_5b0["timeFormat-"+_5b1];var _5b4;if(_5ae.selector=="date"){_5b4=_5b2;}else{if(_5ae.selector=="time"){_5b4=_5b3;}else{_5b4=(typeof (_5b3)=="undefined")?_5b2:_5b2+" "+_5b3;}}var _5b5=[];var re=_5aa(_5b4,lang.hitch(this,_5b6,_5b5,_5b0,_5ae));return {regexp:re,tokens:_5b5,bundle:_5b0};};_596.parse=function(_5b7,_5b8){_5b7=_5b7.replace(/[\u200E\u200F\u202A\u202E]/g,"");if(!_5b8){_5b8={};}var info=_596._parseInfo(_5b8);var _5b9=info.tokens,_595=info.bundle;var _5ba=info.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");var re=new RegExp("^"+_5ba+"$");var _5bb=re.exec(_5b7);var _5bc=i18n.normalizeLocale(_5b8.locale);if(!_5bb){return null;}var date,_5bd;var _5be=[1389,0,1,0,0,0,0];var amPm="";var _5bf=0;var _5c0=["abbr","wide","narrow"];var _5c1=arr.every(_5bb,function(v,i){if(!i){return true;}var _5c2=_5b9[i-1];var l=_5c2.length;switch(_5c2.charAt(0)){case "y":_5be[0]=Number(v);break;case "M":if(l>2){var _5c3=_595["months-format-"+_5c0[l-3]].concat();if(!_5b8.strict){v=v.replace(".","").toLowerCase();_5c3=arr.map(_5c3,function(s){return s?s.replace(".","").toLowerCase():s;});}v=arr.indexOf(_5c3,v);if(v==-1){return false;}_5bf=l;}else{v--;}_5be[1]=Number(v);break;case "D":_5be[1]=0;case "d":_5be[2]=Number(v);break;case "a":var am=_5b8.am||_595["dayPeriods-format-wide-am"],pm=_5b8.pm||_595["dayPeriods-format-wide-pm"];if(!_5b8.strict){var _5c4=/\./g;v=v.replace(_5c4,"").toLowerCase();am=am.replace(_5c4,"").toLowerCase();pm=pm.replace(_5c4,"").toLowerCase();}if(_5b8.strict&&v!=am&&v!=pm){return false;}amPm=(v==pm)?"p":(v==am)?"a":"";break;case "K":if(v==24){v=0;}case "h":case "H":case "k":_5be[3]=Number(v);break;case "m":_5be[4]=Number(v);break;case "s":_5be[5]=Number(v);break;case "S":_5be[6]=Number(v);}return true;});var _5c5=+_5be[3];if(amPm==="p"&&_5c5<12){_5be[3]=_5c5+12;}else{if(amPm==="a"&&_5c5==12){_5be[3]=0;}}var _5c6=new _594(_5be[0],_5be[1],_5be[2],_5be[3],_5be[4],_5be[5],_5be[6]);return _5c6;};function _5aa(_5c7,_5c8,_5c9,_5ca){var _5cb=function(x){return x;};_5c8=_5c8||_5cb;_5c9=_5c9||_5cb;_5ca=_5ca||_5cb;var _5cc=_5c7.match(/(''|[^'])+/g);var _5cd=_5c7.charAt(0)=="'";arr.forEach(_5cc,function(_5ce,i){if(!_5ce){_5cc[i]="";}else{_5cc[i]=(_5cd?_5c9:_5c8)(_5ce);_5cd=!_5cd;}});return _5ca(_5cc.join(""));};function _5b6(_5cf,_5d0,_5d1,_5d2){_5d2=_592.escapeString(_5d2);var _5d3=i18n.normalizeLocale(_5d1.locale);return _5d2.replace(/([a-z])\1*/ig,function(_5d4){var s;var c=_5d4.charAt(0);var l=_5d4.length;var p2="",p3="";if(_5d1.strict){if(l>1){p2="0"+"{"+(l-1)+"}";}if(l>2){p3="0"+"{"+(l-2)+"}";}}else{p2="0?";p3="0{0,2}";}switch(c){case "y":s="\\d+";break;case "M":s=(l>2)?"\\S+ ?\\S+":p2+"[1-9]|1[0-2]";break;case "d":s="[12]\\d|"+p2+"[1-9]|3[01]";break;case "E":s="\\S+";break;case "h":s=p2+"[1-9]|1[0-2]";break;case "k":s=p2+"\\d|1[01]";break;case "H":s=p2+"\\d|1\\d|2[0-3]";break;case "K":s=p2+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":s=p2+"\\d|[0-5]\\d";break;case "S":s="\\d{"+l+"}";break;case "a":var am=_5d1.am||_5d0["dayPeriods-format-wide-am"],pm=_5d1.pm||_5d0["dayPeriods-format-wide-pm"];if(_5d1.strict){s=am+"|"+pm;}else{s=am+"|"+pm;if(am!=am.toLowerCase()){s+="|"+am.toLowerCase();}if(pm!=pm.toLowerCase()){s+="|"+pm.toLowerCase();}}break;default:s=".*";}if(_5cf){_5cf.push(_5d4);}return "("+s+")";}).replace(/[\xa0 ]/g,"[\\s\\xa0]");};var _5d5=[];_596.addCustomFormats=function(_5d6,_5d7){_5d5.push({pkg:_5d6,name:_5d7});};_596._getIslamicBundle=function(_5d8){var _5d9={};arr.forEach(_5d5,function(desc){var _5da=i18n.getLocalization(desc.pkg,desc.name,_5d8);_5d9=lang.mixin(_5d9,_5da);},this);return _5d9;};_596.addCustomFormats("dojo.cldr","islamic");_596.getNames=function(item,type,_5db,_5dc,date){var _5dd;var _5de=_596._getIslamicBundle(_5dc);var _5df=[item,_5db,type];if(_5db=="standAlone"){var key=_5df.join("-");_5dd=_5de[key];if(_5dd[0]==1){_5dd=undefined;}}_5df[1]="format";return (_5dd||_5de[_5df.join("-")]).concat();};_596.weekDays=_596.getNames("days","wide","format");_596.months=_596.getNames("months","wide","format");return _596;});},"esri/layers/FeatureLayer":function(){define("esri/layers/FeatureLayer",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/Deferred","dojo/date/locale","dojo/sniff","dojo/io-query","dojo/dom-construct","dojo/i18n","esri/kernel","esri/lang","esri/request","esri/deferredUtils","esri/SpatialReference","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/jsonUtils","esri/renderers/SimpleRenderer","esri/renderers/UniqueValueRenderer","esri/renderers/jsonUtils","esri/tasks/QueryTask","esri/tasks/query","esri/tasks/FeatureSet","esri/geometry/Extent","esri/geometry/jsonUtils","esri/geometry/normalizeUtils","esri/layers/GraphicsLayer","esri/layers/Field","esri/layers/TimeInfo","esri/layers/FeatureType","esri/layers/FeatureTemplate","esri/layers/FeatureEditResult","esri/layers/SnapshotMode","esri/layers/OnDemandMode","esri/layers/SelectionMode","esri/layers/TrackManager","dojo/i18n!esri/nls/jsapi","dojo/has!extend-esri?esri/layers/agscommon"],function(_5e0,_5e1,lang,_5e2,_5e3,_5e4,_5e5,has,ioq,_5e6,i18n,_5e7,_5e8,_5e9,_5ea,_5eb,_5ec,_5ed,_5ee,_5ef,_5f0,_5f1,_5f2,_5f3,_5f4,_5f5,_5f6,_5f7,_5f8,_5f9,_5fa,_5fb,_5fc,_5fd,_5fe,_5ff,_600,_601,_602){var _603=_5e0(_5f9,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",constructor:function(url,_604){this.i18n=i18n.getLocalization("esri","jsapi");this._outFields=_604&&_604.outFields;this._loadCallback=_604&&_604.loadCallback;var _605=_604&&_604._usePatch;this._usePatch=(_605===null||_605===undefined)?true:_605;this._trackIdField=_604&&_604.trackIdField;this.objectIdField=_604&&_604.objectIdField;this._maxOffset=_604&&_604.maxAllowableOffset;this._optEditable=_604&&_604.editable;this._optAutoGen=_604&&_604.autoGeneralize;this.editSummaryCallback=_604&&_604.editSummaryCallback;this.userId=_604&&_604.userId;this.userIsAdmin=_604&&_604.userIsAdmin;this.useMapTime=(_604&&_604.hasOwnProperty("useMapTime"))?(!!_604.useMapTime):true;this.source=_604&&_604.source;this.gdbVersion=_604&&_604.gdbVersion;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var ctor=this.constructor,mode=this.mode=(_5e8.isDefined(_604&&_604.mode)?_604.mode:ctor.MODE_ONDEMAND);switch(mode){case ctor.MODE_SNAPSHOT:this._mode=new _5ff(this);this._isSnapshot=true;break;case ctor.MODE_ONDEMAND:this._tileWidth=(_604&&_604.tileWidth)||512;this._tileHeight=(_604&&_604.tileHeight)||512;this._mode=new _600(this);var _606=_604&&_604.latticeTiling;this.latticeTiling=_606;break;case ctor.MODE_SELECTION:this._mode=new _601(this);this._isSelOnly=true;break;}this._initLayer=lang.hitch(this,this._initLayer);this._selectHandler=lang.hitch(this,this._selectHandler);this._editable=false;if(lang.isObject(url)&&url.layerDefinition){var json=url;this._collection=true;this.mode=ctor.MODE_SNAPSHOT;this._initLayer(json);return this;}this._task=new _5f3(this.url,{source:this.source,gdbVersion:this.gdbVersion});var _607=this._url.path;this._fserver=false;if(_607.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _608=_604&&_604.resourceInfo;if(_608){this._initLayer(_608);}else{if(this.source){var _609={source:this.source.toJson()};this._url.query=lang.mixin(this._url.query,{layer:_5e3.toJson(_609)});}if(this.gdbVersion){this._url.query=lang.mixin(this._url.query,{gdbVersion:this.gdbVersion});}_5e9({url:_607,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}this.registerConnectEvents("esri.layers.FeatureLayer",{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]});},_initLayer:function(_60a,io){if(_60a||io){this._json=_60a;this._findCredential();var ssl=(this.credential&&this.credential.ssl)||(_60a&&_60a._ssl);if(ssl){this._useSSL();this._task._useSSL();}if(this._collection){this._mode=new _5ff(this);this._isSnapshot=true;this._featureSet=_60a.featureSet;this._nextId=_60a.nextObjectId;_60a=_60a.layerDefinition;}if(_60a.hasOwnProperty("capabilities")){var _60b=(this.capabilities=_60a.capabilities);if(_60b&&_60b.toLowerCase().indexOf("editing")!==-1){this._editable=true;}else{this._editable=false;}}else{if(!this._collection){this._editable=this._fserver;}}if(_5e8.isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_5e3.toJson(this._json);if(this.isEditable()){delete this._maxOffset;}else{if(this.mode!==this.constructor.MODE_SNAPSHOT&&((_60a.geometryType==="esriGeometryPolyline")||(_60a.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_5e8.isDefined(this._optAutoGen)?this._optAutoGen:(this.mode===this.constructor.MODE_ONDEMAND);delete this._optAutoGen;}}var _60c=_60a.effectiveMinScale||_60a.minScale,_60d=_60a.effectiveMaxScale||_60a.maxScale;if(!this._hasMin&&_60c){this.setMinScale(_60c);}if(!this._hasMax&&_60d){this.setMaxScale(_60d);}this.layerId=_60a.id;this.name=_60a.name;this.description=_60a.description;this.copyright=_60a.copyrightText;this.type=_60a.type;this.geometryType=_60a.geometryType;this.displayField=_60a.displayField;this.defaultDefinitionExpression=_60a.definitionExpression;this.fullExtent=new _5f6(_60a.extent);this.initialExtent=new _5f6(this.fullExtent.toJson());if(this.fullExtent.spatialReference){this.spatialReference=new _5eb(this.fullExtent.spatialReference.toJson());}this.defaultVisibility=_60a.defaultVisibility;if((this.geometryType==="esriGeometryPoint")||(this.geometryType==="esriGeometryMultipoint")){this.latticeTiling=false;}this.indexedFields=_60a.indexedFields;this.maxRecordCount=_60a.maxRecordCount;this.canModifyLayer=_60a.canModifyLayer;this.supportsStatistics=_60a.supportsStatistics;this.supportsAdvancedQueries=_60a.supportsAdvancedQueries;this.hasLabels=_60a.hasLabels;this.canScaleSymbols=_60a.canScaleSymbols;this.supportsRollbackOnFailure=_60a.supportsRollbackOnFailure;this.syncCanReturnChanges=_60a.syncCanReturnChanges;this.isDataVersioned=_60a.isDataVersioned;this.editFieldsInfo=_60a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=_60a.ownershipBasedAccessControlForFeatures;if(this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures){this.creatorField=this.editFieldsInfo.creatorField;}this.relationships=_60a.relationships;this.allowGeometryUpdates=_5e8.isDefined(_60a.allowGeometryUpdates)?_60a.allowGeometryUpdates:true;this._isTable=(this.type==="Table");var _60e=(this.fields=[]),_60f=_60a.fields,i;for(i=0;i<_60f.length;i++){_60e.push(new _5fa(_60f[i]));}if(!this.objectIdField){this.objectIdField=_60a.objectIdField;if(!this.objectIdField){_60f=_60a.fields;for(i=0;i<_60f.length;i++){var _610=_60f[i];if(_610.type==="esriFieldTypeOID"){this.objectIdField=_610.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+_5e8.substitute({url:this.url},"objectIdField is not set [url: ${url}]"));}}if(!_5e8.isDefined(this._nextId)){var _611=this.objectIdField,_612=-1;if(this._collection&&_611){var fset=this._featureSet,_613=fset&&fset.features,il=_613?_613.length:0,oid,attr;for(i=0;i<il;i++){attr=_613[i].attributes;oid=attr&&attr[_611];if(oid>_612){_612=oid;}}}this._nextId=(_612+1);}this.globalIdField=_60a.globalIdField;var _614=(this.typeIdField=_60a.typeIdField),_615;if(_614){_615=!this._getField(_614)&&this._getField(_614,true);if(_615){this.typeIdField=_615.name;}}this.visibilityField=_60a.visibilityField;var _616=_60a.defaultSymbol;if(_616){this.defaultSymbol=_5ef.fromJson(_616);}var _617=this.types=[],_618=_60a.types,_619,_61a,_61b,_61c=this.editFieldsInfo,_61d=_61c&&_61c.creatorField,_61e=_61c&&_61c.editorField,fix=(_61d||_61e),_61f=[];if(_618){for(i=0;i<_618.length;i++){_619=new _5fc(_618[i]);_61a=_619.templates;if(fix&&_61a&&_61a.length){_61f=_61f.concat(_61a);}_617.push(_619);}}var _620=_60a.templates,_621,_622=this.templates=[];if(_620){for(i=0;i<_620.length;i++){_621=new _5fd(_620[i]);if(fix){_61f.push(_621);}_622.push(_621);}}for(i=0;i<_61f.length;i++){_61b=lang.getObject("prototype.attributes",false,_61f[i]);if(_61b){if(_61d){delete _61b[_61d];}if(_61e){delete _61b[_61e];}}}var _623=_60a.timeInfo;if(_623){this.timeInfo=new _5fb(_623);this._startTimeField=_623.startTimeField;this._endTimeField=_623.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_623.trackIdField=this._trackIdField;}else{this._trackIdField=_623.trackIdField;}}this.hasAttachments=(!this._collection&&_60a.hasAttachments)?true:false;this.htmlPopupType=_60a.htmlPopupType;var _624=_60a.drawingInfo,_625;if(!this.renderer){if(_624&&_624.renderer){_625=_624.renderer;this.setRenderer(_5f2.fromJson(_625));if(_625.type==="classBreaks"){this.renderer.setMaxInclusive(true);}if(!this._collection){var _626=_625.type,_627=[];_625=this.renderer;switch(_626){case "simple":_627.push(_625.symbol);break;case "uniqueValue":case "classBreaks":_627.push(_625.defaultSymbol);_627=_627.concat(_5e2.map(_625.infos,function(info){return info.symbol;}));break;}_627=_5e2.filter(_627,_5e8.isDefined);var _628=this._url.path+"/images/",_629=this._getToken();_5e2.forEach(_627,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_628+url;}if(_629&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_629);}}});}}else{if(_616){_618=this.types;if(_618.length>0){_625=new _5f1(this.defaultSymbol,this.typeIdField);_5e2.forEach(_618,function(type){_625.addValue(type.id,type.symbol);});}else{_625=new _5f0(this.defaultSymbol);}this.setRenderer(_625);}else{if(!this._isTable){var _62a;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_62a=new _5ec();break;case "esriGeometryPolyline":_62a=new _5ed();break;case "esriGeometryPolygon":_62a=new _5ee();break;}this.setRenderer(_62a?new _5f0(_62a):null);}}}}var _62b=(_624&&_624.transparency)||0;if(!_5e8.isDefined(this.opacity)&&_62b>0){this.opacity=1-(_62b/100);}this.version=_60a.currentVersion;if(!this.version){var ver;if("capabilities" in _60a||"drawingInfo" in _60a||"hasAttachments" in _60a||"htmlPopupType" in _60a||"relationships" in _60a||"timeInfo" in _60a||"typeIdField" in _60a||"types" in _60a){ver=10;}else{ver=9.3;}this.version=ver;}if((has("ie")||has("safari"))&&this.isEditable()&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();this._updateCaps();var _62c=function(){this.onLoad(this);var _62d=this._loadCallback;if(_62d){delete this._loadCallback;_62d(this);}};if(this._collection){this._fireUpdateStart();var _62e=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new _5f5(_62e));this._fcAdded=true;_62c.call(this);}else{this._forceIdentity(_62c);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _62f=this.renderer;if(_62f){this._ager=(_62f.declaredClass.indexOf("TemporalRenderer")!==-1&&_62f.observationAger&&_62f.observationRenderer);var _630=_5e2.filter([_62f,_62f.observationRenderer,_62f.latestObservationRenderer,_62f.trackRenderer],_5e8.isDefined);var _631=[];_5e2.forEach(_630,function(rnd){if(!lang.isFunction(rnd.attributeField)){_631.push(rnd.attributeField);}_631.push(rnd.attributeField2);_631.push(rnd.attributeField3);},this);this._rendererFields=_5e2.filter(_631,_5e8.isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map){var div=this.inherited(arguments),mode=this._mode;if(mode){mode.initialize(map);}return div;},_unsetMap:function(map){var mode=this._mode;if(mode){mode.suspend();}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_5e1.disconnect(this._zoomConnect);this._zoomConnect=null;this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var mode=this._mode;if(mode){mode.refresh();}},getOutFields:function(){return _5e2.filter(this._getOutFields(),function(_632){return (_632==="*"||!!this._getField(_632));},this);},setEditable:function(_633){if(!this._collection){console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service");return this;}if(!this.loaded){this._optEditable=_633;return this;}var _634=this._editable;this._editable=_633;this._updateCaps();if(_634!==_633){this.onCapabilitiesChange();}return this;},getEditCapabilities:function(_635){var _636={"canCreate":false,"canUpdate":false,"canDelete":false};if(!this.loaded||!this.isEditable()){return _636;}var _637=_635&&_635.feature,_638=_635&&_635.userId,caps=_5e2.map((this.capabilities?this.capabilities.toLowerCase().split(","):[]),lang.trim),_639=_5e2.indexOf(caps,"editing")>-1,_63a=_639&&(_5e2.indexOf(caps,"create")>-1),_63b=_639&&(_5e2.indexOf(caps,"update")>-1),_63c=_639&&(_5e2.indexOf(caps,"delete")>-1),_63d=this.ownershipBasedAccessControlForFeatures,_63e=this.editFieldsInfo,_63f=_63e&&_63e.creatorField,_640=_63e&&_63e.realm,_641=_637&&_637.attributes,_642=(_641&&_63f)?_641[_63f]:undefined,_643,_644=!!this.userIsAdmin,_645=!_63d||_644||!!(_63d.allowOthersToUpdate||_63d.allowUpdateToOthers),_646=!_63d||_644||!!(_63d.allowOthersToDelete||_63d.allowDeleteToOthers);if(_644||(_639&&!(_63a||_63b||_63c))){_63a=_63b=_63c=true;}_643={"canCreate":_63a,"canUpdate":_63b,"canDelete":_63c};if(_642===null){_643.canUpdate=_63b&&_645;_643.canDelete=_63c&&_646;}else{if(_642===""){return _643;}else{if(_642){_638=_638||this.getUserId();if(_638&&_640){_638=_638+"@"+_640;}if(_638.toLowerCase()===_642.toLowerCase()){return _643;}else{_643.canUpdate=_63b&&_645;_643.canDelete=_63c&&_646;}}}}return _643;},getUserId:function(){var _647;if(this.loaded){_647=(this.credential&&this.credential.userId)||this.userId||"";}return _647;},setUserIsAdmin:function(_648){this.userIsAdmin=_648;},setEditSummaryCallback:function(_649){this.editSummaryCallback=_649;},getEditSummary:function(_64a,_64b,_64c){_64c=_5e8.isDefined(_64c)?_64c:(new Date()).getTime();var _64d="",info=this.getEditInfo(_64a,_64b,_64c),_64e=(_64b&&_64b.callback)||this.editSummaryCallback;if(_64e){info=_64e(_64a,info)||"";}if(lang.isString(info)){_64d=info;}else{if(info){var _64f=info.action,_650=info.userId,_651=info.timeValue,_652=0;if(_64f){_652++;}if(_650){_652++;}if(_5e8.isDefined(_651)){_652++;}if(_652>1){_64d=(_64f==="edit"?"edit":"create")+(_650?"User":"")+(_5e8.isDefined(_651)?info.displayPattern:"");}}_64d=_64d&&_5e8.substitute(info,this.i18n.layers.FeatureLayer[_64d]);}return _64d;},getEditInfo:function(_653,_654,_655){if(!this.loaded){return;}_655=_5e8.isDefined(_655)?_655:(new Date()).getTime();var _656=(_654&&_654.action)||"last",_657=this.editFieldsInfo,_658=_657&&_657.creatorField,_659=_657&&_657.creationDateField,_65a=_657&&_657.editorField,_65b=_657&&_657.editDateField,_65c=_657&&_657.realm,_65d=_653&&_653.attributes,_65e=(_65d&&_658)?_65d[_658]:undefined,_65f=(_65d&&_659)?_65d[_659]:null,_660=(_65d&&_65a)?_65d[_65a]:undefined,_661=(_65d&&_65b)?_65d[_65b]:null,_662=this._getEditData(_65e,_65f,_655),_663=this._getEditData(_660,_661,_655),_664;switch(_656){case "creation":_664=_662;break;case "edit":_664=_663;break;case "last":_664=_663||_662;break;}if(_664){_664.action=(_664===_663)?"edit":"creation";}return _664;},_getEditData:function(_665,_666,_667){var data,_668,_669,_66a=60000,_66b=3600000,_66c=2*_66b,_66d=24*_66b,_66e=7*_66d;if(_5e8.isDefined(_666)){_668=_667-_666;if(_668<0){_669="Full";}else{if(_668<_66a){_669="Seconds";}else{if(_668<(2*_66a)){_669="Minute";}else{if(_668<_66b){_669="Minutes";}else{if(_668<_66c){_669="Hour";}else{if(_668<_66d){_669="Hours";}else{if(_668<_66e){_669="WeekDay";}else{_669="Full";}}}}}}}}if((_665!==undefined)||_669){data=data||{};data.userId=_665;if(_669){var _66f=_5e5.format,_670=new Date(_666);data.minutes=Math.floor(_668/_66a);data.hours=Math.floor(_668/_66b);data.weekDay=_66f(_670,{datePattern:"EEEE",selector:"date"});data.formattedDate=_66f(_670,{selector:"date"});data.formattedTime=_66f(_670,{selector:"time"});data.displayPattern=_669;data.timeValue=_666;}}return data;},isEditable:function(){return !!(this._editable||this.userIsAdmin);},setMaxAllowableOffset:function(_671){if(!this.isEditable()){this._maxOffset=_671;}return this;},getMaxAllowableOffset:function(){return this._maxOffset;},setAutoGeneralize:function(_672){if(!this.loaded){this._optAutoGen=_672;}else{if(!this.isEditable()&&(this.mode!==this.constructor.MODE_SNAPSHOT)&&((this.geometryType==="esriGeometryPolyline")||(this.geometryType==="esriGeometryPolygon"))){this._autoGeneralize=_672;if(_672){var map=this._map;if(map&&map.loaded){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}else{delete this._maxOffset;}}}return this;},setGDBVersion:function(_673){if(!this._collection&&(_673!==this.gdbVersion)&&(_673||this.gdbVersion)){this.gdbVersion=_673;this._task.gdbVersion=_673;this._url.query=lang.mixin(this._url.query,{gdbVersion:_673});if(this.loaded){this.clearSelection();if(this._map){this.refresh();}}this.onGDBVersionChange();}return this;},setDefinitionExpression:function(expr){this._defnExpr=expr;var mode=this._mode;if(mode){mode.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_674){if(this._isSnapshot){this._timeDefn=_674;var mode=this._mode;if(mode){mode.propertyChangeHandler(2);}}else{console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id = "+this.id+", Layer URL = "+this.url);}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_675,_676){this._timeOffset=_675;this._timeOffsetUnits=_676;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this.suspended);var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},selectFeatures:function(_677,_678,_679,_67a){_678=_678||this.constructor.SELECTION_NEW;var _67b=this._getShallowClone(_677),map=this._map,_67c,dfd=_5ea._fixDfd(new _5e4(_5ea._dfdCanceller));_67b.outFields=this.getOutFields();_67b.returnGeometry=true;if(map){_67b.outSpatialReference=new _5eb(map.spatialReference.toJson());}if(!this._applyQueryFilters(_67b)){_67c={features:[]};this._selectHandler(_67c,_678,_679,_67a,dfd);return dfd;}var _67d=this._canDoClientSideQuery(_67b);if(_67d){_67c={features:this._doQuery(_67b,_67d)};this._selectHandler(_67c,_678,_679,_67a,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+this.invalidParams);this._resolve([err],null,_67a,dfd,true);return dfd;}var self=this;if(this._ts){_67b._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task.execute(_67b);temp.addCallbacks(function(_67e){self._selectHandler(_67e,_678,_679,_67a,dfd);},function(err){self._resolve([err],null,_67a,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _67f=this._selectedFeatures,_680=[],item;for(item in _67f){if(_67f.hasOwnProperty(item)){_680.push(_67f[item]);}}return _680;},clearSelection:function(_681){var _682=this._selectedFeatures,mode=this._mode,item;for(item in _682){if(_682.hasOwnProperty(item)){this._unSelectFeatureIIf(item,mode);mode._removeFeatureIIf(item);}}this._selectedFeatures={};if(this._isSelOnly){mode._applyTimeFilter(true);}if(!_681){this.onSelectionClear();}return this;},setSelectionSymbol:function(_683){this._selectionSymbol=_683;if(_683){var _684=this._selectedFeatures,item;for(item in _684){if(_684.hasOwnProperty(item)){_684[item].setSymbol(_683);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(adds,_685,_686,_687,_688,_689){var _68a=_689.assembly,dfd=_689.dfd;this._applyNormalized(adds,_68a&&_68a[0]);this._applyNormalized(_685,_68a&&_68a[1]);this.onBeforeApplyEdits(adds,_685,_686);var i,_68b={},_68c=this.objectIdField,_68d={f:"json"},_68e=false;if(this._collection){var _68f={};_68f.addResults=adds?_5e2.map(adds,function(){_68e=true;return {objectId:this._nextId++,success:true};},this):null;_68f.updateResults=_685?_5e2.map(_685,function(_690){_68e=true;var oid=_690.attributes[_68c];_68b[oid]=_690;return {objectId:oid,success:true};},this):null;_68f.deleteResults=_686?_5e2.map(_686,function(_691){_68e=true;return {objectId:_691.attributes[_68c],success:true};},this):null;if(_68e){this._editHandler(_68f,adds,_68b,_687,_688,dfd);}return;}if(adds&&adds.length>0){_68d.adds=this._convertFeaturesToJson(adds,0,1);_68e=true;}if(_685&&_685.length>0){for(i=0;i<_685.length;i++){var _692=_685[i];_68b[_692.attributes[_68c]]=_692;}_68d.updates=this._convertFeaturesToJson(_685,0,0,1);_68e=true;}if(_686&&_686.length>0){var ids=[];for(i=0;i<_686.length;i++){ids.push(_686[i].attributes[_68c]);}_68d.deletes=ids.join(",");_68e=true;}if(_68e){var self=this;return _5e9({url:this._url.path+"/applyEdits",content:lang.mixin(_68d,this._url.query),callbackParamName:"callback",load:function(_693){self._editHandler(_693,adds,_68b,_687,_688,dfd);},error:function(err){self._resolve([err],null,_688,dfd,true);}},{usePost:true});}},queryFeatures:function(_694,_695,_696){return this._query("execute","onQueryFeaturesComplete",_694,_695,_696);},queryRelatedFeatures:function(_697,_698,_699){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_697,_698,_699);},queryIds:function(_69a,_69b,_69c){return this._query("executeForIds","onQueryIdsComplete",_69a,_69b,_69c);},queryCount:function(_69d,_69e,_69f){return this._query("executeForCount","onQueryCountComplete",_69d,_69e,_69f);},queryAttachmentInfos:function(_6a0,_6a1,_6a2){var url=this._url.path+"/"+_6a0+"/attachments",dfd=new _5e4(_5ea._dfdCanceller),self=this;dfd._pendingDfd=_5e9({url:url,content:lang.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_6a3){var _6a4=_6a3.attachmentInfos,_6a5;_5e2.forEach(_6a4,function(info){_6a5=ioq.objectToQuery({gdbVersion:self._url.query&&self._url.query.gdbVersion,layer:self._url.query&&self._url.query.layer,token:self._getToken()});info.url=url+"/"+info.id+(_6a5?("?"+_6a5):"");info.objectId=_6a0;});self._resolve([_6a4],"onQueryAttachmentInfosComplete",_6a1,dfd);},error:function(err){self._resolve([err],null,_6a2,dfd,true);}});return dfd;},addAttachment:function(_6a6,_6a7,_6a8,_6a9){return this._sendAttachment("add",_6a6,_6a7,_6a8,_6a9);},updateAttachment:function(_6aa,_6ab,_6ac,_6ad,_6ae){_6ac.appendChild(_5e6.create("input",{type:"hidden",name:"attachmentId",value:_6ab}));return this._sendAttachment("update",_6aa,_6ac,_6ad,_6ae);},deleteAttachments:function(_6af,_6b0,_6b1,_6b2){var url=this._url.path+"/"+_6af+"/deleteAttachments",dfd=new _5e4(_5ea._dfdCanceller),self=this,_6b3={f:"json",attachmentIds:_6b0.join(",")};dfd._pendingDfd=_5e9({url:url,content:lang.mixin(_6b3,this._url.query),callbackParamName:"callback",load:lang.hitch(this,function(_6b4){var _6b5=_6b4.deleteAttachmentResults;_6b5=_5e2.map(_6b5,function(_6b6){var res=new _5fe(_6b6);res.attachmentId=res.objectId;res.objectId=_6af;return res;});self._resolve([_6b5],"onDeleteAttachmentsComplete",_6b1,dfd);}),error:function(err){self._resolve([err],null,_6b2,dfd,true);}},{usePost:true});return dfd;},addType:function(_6b7){var _6b8=this.types;if(_6b8){var _6b9=_5e2.some(_6b8,function(type){if(type.id==_6b7.id){return true;}return false;});if(_6b9){return false;}else{_6b8.push(_6b7);}}else{this.types=[_6b7];}this._typesDirty=true;return true;},deleteType:function(_6ba){if(!this._collection){return;}var _6bb=this.types;if(_6bb){var _6bc=-1;_5e2.some(_6bb,function(type,_6bd){if(type.id==_6ba){_6bc=_6bd;return true;}return false;});if(_6bc>-1){this._typesDirty=true;return _6bb.splice(_6bc,1)[0];}}},toJson:function(){var _6be=this._json,json=lang.isString(_6be)?_5e3.fromJson(_6be):lang.clone(_6be);if(!json){return;}json=json.layerDefinition?json:{layerDefinition:json};var _6bf=json.layerDefinition,_6c0=this._collection;if(_6c0&&this._typesDirty){_6bf.types=_5e2.map(this.types||[],function(type){return type.toJson();});var _6c1=this.renderer,_6c2=_6bf.drawingInfo;if(_6c2&&_6c1&&_6c1.declaredClass.indexOf("TemporalRenderer")===-1){_6c2.renderer=_6c1.toJson();}}var _6c3=null;if(!(_6c0&&!this._fcAdded)){_6c3={geometryType:_6bf.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}json.featureSet=lang.mixin({},json.featureSet||{},_6c3);if(_6c0){json.nextObjectId=this._nextId;_6bf.capabilities=this.capabilities;}return json;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},_forceIdentity:function(_6c4){var self=this,path=this._url&&this._url.path;if((this.ownershipBasedAccessControlForFeatures||this.userIsAdmin)&&!this._getToken()&&path&&_5e7.id&&_5e7.id._hasPortalSession()&&_5e7.id._doPortalSignIn(path)){_5e7.id.getCredential(path).then(function(){self._findCredential();_6c4.call(self);},function(){_6c4.call(self);});}else{_6c4.call(this);}},_updateCaps:function(){var _6c5=this._editable,_6c6=lang.trim(this.capabilities||""),_6c7=_5e2.map((_6c6?_6c6.split(","):[]),lang.trim),caps=_5e2.map((_6c6?_6c6.toLowerCase().split(","):[]),lang.trim),_6c8=_5e2.indexOf(caps,"editing"),cap,i,_6c9,_6ca={"Create":_5e2.indexOf(caps,"create"),"Update":_5e2.indexOf(caps,"update"),"Delete":_5e2.indexOf(caps,"delete")};if(_6c5&&_6c8===-1){_6c7.push("Editing");}else{if(!_6c5&&_6c8>-1){_6c9=[_6c8];for(cap in _6ca){if(_6ca[cap]>-1){_6c9.push(_6ca[cap]);}}_6c9.sort();for(i=_6c9.length-1;i>=0;i--){_6c7.splice(_6c9[i],1);}}}this.capabilities=_6c7.join(",");},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},onSuspend:function(){this.inherited(arguments);this._toggleTime(false);var mode=this._mode;if(mode){mode.suspend();}},onResume:function(evt){this.inherited(arguments);this._toggleTime(true);this._updateMaxOffset();var mode=this._mode,map=this._map,_6cb=this.renderer;if(evt.firstOccurrence){this.clearSelection();if(this.timeInfo){if(this._trackIdField||(_6cb&&(_6cb.latestObservationRenderer||_6cb.trackRenderer))){this._trackManager=new _602(this);this._trackManager.initialize(map);}}this._zoomConnect=_5e1.connect(map,"onZoomEnd",this,this._updateMaxOffset);}if(mode){evt.firstOccurrence?mode.startup():mode.resume();}},_updateMaxOffset:function(){var map=this._map;if(map&&map.loaded){if(this._autoGeneralize){this._maxOffset=Math.floor(map.extent.getWidth()/map.width);}}},_toggleTime:function(_6cc){var map=this._map;if(_6cc&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_5e1.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_5e1.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_6cd){this._mapTimeExtent=_6cd;var mode=this._mode;if(mode){mode.propertyChangeHandler(0);}},_getOffsettedTE:function(_6ce){var _6cf=this._timeOffset,_6d0=this._timeOffsetUnits;return (_6ce&&_6cf&&_6d0)?_6ce.offset(-1*_6cf,_6d0):_6ce;},_getTimeOverlap:function(_6d1,_6d2){if(_6d1&&_6d2){return _6d1.intersection(_6d2);}else{return _6d1||_6d2;}},_getTimeFilter:function(_6d3){var _6d4=this.getTimeDefinition(),_6d5=null,_6d6;if(_6d4||_6d5){_6d6=this._getTimeOverlap(_6d4,_6d5);if(!_6d6){return [false];}}if(_6d3){_6d3=_6d6?this._getTimeOverlap(_6d3,_6d6):_6d3;if(!_6d3){return [false];}}else{_6d3=_6d6;}return [true,_6d3];},_getAttributeFilter:function(_6d7){var _6d8=this.getDefinitionExpression();if(_6d7){_6d7=_6d8?"("+_6d8+") AND ("+_6d7+")":_6d7;}else{_6d7=_6d8;}return _6d7;},_applyQueryFilters:function(_6d9){_6d9.where=this._getAttributeFilter(_6d9.where);_6d9.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _6da=this._getTimeFilter(_6d9.timeExtent);if(!_6da[0]){return false;}else{_6d9.timeExtent=_6da[1];}}return true;},_add:function(_6db){var _6dc=this._selectionSymbol,attr=_6db.attributes,_6dd=this.visibilityField;if(_6dc&&this._isSelOnly){_6db.setSymbol(_6dc);}if(_6dd&&attr&&attr.hasOwnProperty(_6dd)){_6db[attr[_6dd]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_6de){var _6df=[],map=this._map;if(this._isTable||!map){return;}if(_6de.text||(_6de.where&&_6de.where!==this.getDefinitionExpression())){return;}var _6e0=this._isSnapshot,_6e1=this._isSelOnly;var _6e2=_6de.geometry;if(_6e2){if(!_6e1&&_6de.spatialRelationship===_5f4.SPATIAL_REL_INTERSECTS&&(_6e2.type==="extent"&&(_6e0||map.extent.contains(_6e2)))){_6df.push(1);}else{return;}}var ids=_6de.objectIds;if(ids){if(_6e0){_6df.push(2);}else{var len=ids.length,mode=this._mode,_6e3=0,i;for(i=0;i<len;i++){if(mode._getFeature(ids[i])){_6e3++;}}if(_6e3===len){_6df.push(2);}else{return;}}}if(this.timeInfo){var _6e4=_6de.timeExtent,_6e5=this._mapTimeExtent;if(_6e0){if(_6e4){_6df.push(3);}}else{if(_6e1){if(_6e4){return;}}else{if(_6e5){if(_5e2.indexOf(_6df,2)!==-1){if(_6e4){_6df.push(3);}}else{return;}}else{if(_6df.length>0){if(_6e4){_6df.push(3);}}else{if(_6e4){return;}}}}}}return _6df.length>0?_6df:null;},_doQuery:function(_6e6,_6e7,_6e8){var _6e9=[],mode=this._mode,_6ea=this.objectIdField,i,len,_6eb;if(_5e2.indexOf(_6e7,2)!==-1){_6e9=[];var ids=_6e6.objectIds;len=ids.length;for(i=0;i<len;i++){var obj=mode._getFeature(ids[i]);if(obj){_6e9.push(obj);}}if(_6e9.length===0){return [];}}if(_5e2.indexOf(_6e7,1)!==-1){_6eb=_6e9.length>0?_6e9:this.graphics;len=_6eb.length;var _6ec=_6e6.geometry._normalize(null,true);_6e9=[];for(i=0;i<len;i++){var _6ed=_6eb[i],_6ee=_6ed.geometry;if(_6ee){if(this.normalization&&_6ec.length){if(_6ec[0].intersects(_6ee)||_6ec[1].intersects(_6ee)){_6e9.push(_6ed);}}else{if(_6ec.intersects(_6ee)){_6e9.push(_6ed);}}}}if(_6e9.length===0){return [];}}if(_5e2.indexOf(_6e7,3)!==-1){if(this.timeInfo){_6eb=_6e9.length>0?_6e9:this.graphics;var time=_6e6.timeExtent,_6ef=this._filterByTime(_6eb,time.startTime,time.endTime);_6e9=_6ef.match;}}if(_6e8){return _5e2.map(_6e9,function(obj){return obj.attributes[_6ea];},this);}else{return _6e9;}},_filterByTime:function(_6f0,_6f1,_6f2){var _6f3=this._startTimeField,_6f4=this._endTimeField,_6f5;if(!this._twoTimeFields){_6f5=_6f3||_6f4;}var _6f6=_5e8.isDefined,yea=[],nay=[],i,len=_6f0.length,_6f7,_6f8;_6f1=_6f1?_6f1.getTime():-Infinity;_6f2=_6f2?_6f2.getTime():Infinity;if(_6f5){for(i=0;i<len;i++){_6f7=_6f0[i];_6f8=_6f7.attributes;var time=_6f8[_6f5];if(time>=_6f1&&time<=_6f2){yea.push(_6f7);}else{nay.push(_6f7);}}}else{for(i=0;i<len;i++){_6f7=_6f0[i];_6f8=_6f7.attributes;var _6f9=_6f8[_6f3],end=_6f8[_6f4];_6f9=_6f6(_6f9)?_6f9:-Infinity;end=_6f6(end)?end:Infinity;if((_6f9>=_6f1&&_6f9<=_6f2)||(end>=_6f1&&end<=_6f2)||(_6f1>=_6f9&&_6f2<=end)){yea.push(_6f7);}else{nay.push(_6f7);}}}return {match:yea,noMatch:nay};},_resolve:function(args,_6fa,_6fb,dfd,_6fc){if(_6fa){this[_6fa].apply(this,args);}if(_6fb){_6fb.apply(null,args);}if(dfd){_5ea._resDfd(dfd,args,_6fc);}},_getShallowClone:function(_6fd){var _6fe=new _5f4(),prop;for(prop in _6fd){if(_6fd.hasOwnProperty(prop)){_6fe[prop]=_6fd[prop];}}return _6fe;},_query:function(type,_6ff,_700,_701,_702){var that=this,map=this._map,dfd=new _5e4(_5ea._dfdCanceller),_703=_700;var _704=function(_705,_706){if(!_706&&type==="execute"&&!that._isTable){var _707=_705.features,mode=that._mode,_708=that.objectIdField,il=_707.length,i;for(i=il-1;i>=0;i--){var oid=_707[i].attributes[_708];var _709=mode._getFeature(oid);if(_709){_707.splice(i,1,_709);}}}that._resolve([_705],_6ff,_701,dfd);};if(type!=="executeRelationshipQuery"){_703=this._getShallowClone(_700);_703.outFields=this.getOutFields();_703.returnGeometry=_700.hasOwnProperty("returnGeometry")?_700.returnGeometry:true;var _70a;if(map){_703.outSpatialReference=new _5eb(map.spatialReference.toJson());}if(!this._applyQueryFilters(_703)){switch(type){case "execute":_70a=new _5f5({features:[]});break;case "executeForIds":_70a=[];break;case "executeForCount":_70a=0;break;}_704(_70a,true);return dfd;}var _70b=this._canDoClientSideQuery(_703);if(_70b){var _70c=this._doQuery(_703,_70b,(type==="executeForIds"||type==="executeForCount"));switch(type){case "execute":_70a=new _5f5();_70a.features=_70c;break;case "executeForIds":_70a=_70c;break;case "executeForCount":_70a=_70c.length;break;}_704(_70a,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+this.invalidParams);this._resolve([err],null,_702,dfd,true);return dfd;}if(this._ts){_703._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_703);temp.addCallbacks(_704,function(err){that._resolve([err],null,_702,dfd,true);});return dfd;},_convertFeaturesToJson:function(_70d,_70e,_70f,_710){var json=[],_711=this._selectionSymbol,_712=this.visibilityField,i,_713,_714=this.objectIdField;if(this.loaded&&(_70f||_710)){_713=_5e2.filter(this.fields,function(_715){return (_715.editable===false)&&(!_710||(_715.name!==_714));});}for(i=0;i<_70d.length;i++){var _716=_70d[i],_717={},_718=_716.geometry,attr=_716.attributes,_719=_716.symbol;if(_718&&(!_710||!this.loaded||this.allowGeometryUpdates)){_717.geometry=_718.toJson();}if(_712){_717.attributes=attr=lang.mixin({},attr);attr[_712]=_716.visible?1:0;}else{if(attr){_717.attributes=lang.mixin({},attr);}}if(_717.attributes&&_713&&_713.length){_5e2.forEach(_713,function(_71a){delete _717.attributes[_71a.name];});}if(_719&&(_719!==_711)){_717.symbol=_719.toJson();}json.push(_717);}return _70e?json:_5e3.toJson(json);},_selectHandler:function(_71b,_71c,_71d,_71e,dfd){var _71f,ctor=this.constructor;switch(_71c){case ctor.SELECTION_NEW:this.clearSelection(true);_71f=true;break;case ctor.SELECTION_ADD:_71f=true;break;case ctor.SELECTION_SUBTRACT:_71f=false;break;}var i,_720=_71b.features,mode=this._mode,_721=[],_722=this.objectIdField,_723,oid;if(_71f){for(i=0;i<_720.length;i++){_723=_720[i];oid=_723.attributes[_722];var _724=mode._addFeatureIIf(oid,_723);_721.push(_724);this._selectFeatureIIf(oid,_724,mode);}}else{for(i=0;i<_720.length;i++){_723=_720[i];oid=_723.attributes[_722];this._unSelectFeatureIIf(oid,mode);var _725=mode._removeFeatureIIf(oid);_721.push(_725||_723);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_721,_71c,_71b.exceededTransferLimit?{queryLimitExceeded:true}:null],"onSelectionComplete",_71d,dfd);if(_71b.exceededTransferLimit){this.onQueryLimitExceeded();}},_selectFeatureIIf:function(oid,_726,mode){var _727=this._selectedFeatures,_728=_727[oid];if(!_728){mode._incRefCount(oid);_727[oid]=_726;if(!this._isTable){this._setSelectSymbol(_726);}}return _728||_726;},_unSelectFeatureIIf:function(oid,mode){var _729=this._selectedFeatures[oid];if(_729){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_729);}}return _729;},_isSelected:function(_72a){},_setSelectSymbol:function(_72b){var _72c=this._selectionSymbol;if(_72c&&!this._isSelOnly){_72b.setSymbol(_72c);}},_setUnSelectSymbol:function(_72d){var _72e=this._selectionSymbol;if(_72e&&!this._isSelOnly){if(_72e===_72d.symbol){_72d.setSymbol(null,true);}}},_getOutFields:function(){var _72f=_5e2.filter([this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_730,_731,arr){return !!_730&&(_5e2.indexOf(arr,_730)===_731);});var _732=lang.clone(this._outFields);if(_732){if(_5e2.indexOf(_732,"*")!==-1){return _732;}_5e2.forEach(_72f,function(_733){if(_5e2.indexOf(_732,_733)===-1){_732.push(_733);}});return _732;}else{return _72f;}},_checkFields:function(_734){var _735=_734||this._getOutFields();_5e2.forEach(_735,function(_736){if(_736==="*"){return;}if(!this._getField(_736)){console.debug("esri.layers.FeatureLayer: "+_5e8.substitute({url:this.url,field:_736},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]"));}},this);if(!_734&&!this._isTable&&!this._fserver&&!this._collection){var _737=_5e2.some(this.fields,function(_738){return (_738&&_738.type==="esriFieldTypeGeometry")?true:false;});if(!_737){console.debug("esri.layers.FeatureLayer: "+_5e8.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"));}}},_fixRendererFields:function(){var _739=this.renderer;if(_739&&this.fields.length>0){var _73a=_5e2.filter([_739,_739.observationRenderer,_739.latestObservationRenderer,_739.trackRenderer],_5e8.isDefined);var _73b=[];_5e2.forEach(_73a,function(rnd){var _73c,_73d;_73d=rnd.attributeField;if(_73d&&!lang.isFunction(_73d)){_73c=!this._getField(_73d)&&this._getField(_73d,true);if(_73c){rnd.attributeField=_73c.name;}}_73d=rnd.attributeField2;if(_73d){_73c=!this._getField(_73d)&&this._getField(_73d,true);if(_73c){rnd.attributeField2=_73c.name;}}_73d=rnd.attributeField3;if(_73d){_73c=!this._getField(_73d)&&this._getField(_73d,true);if(_73c){rnd.attributeField3=_73c.name;}}if(!lang.isFunction(rnd.attributeField)){_73b.push(rnd.attributeField);}_73b.push(rnd.attributeField2);_73b.push(rnd.attributeField3);},this);this._rendererFields=_5e2.filter(_73b,_5e8.isDefined);}},_getField:function(_73e,_73f){var _740=this.fields;if(!_740||_740.length===0){return null;}var _741;if(_73f){_73e=_73e.toLowerCase();}_5e2.some(_740,function(_742){var _743=false;if(_73f){_743=(_742&&_742.name.toLowerCase()===_73e)?true:false;}else{_743=(_742&&_742.name===_73e)?true:false;}if(_743){_741=_742;}return _743;});return _741;},_getDateOpts:function(){if(!this._dtOpts){var _744=_5e2.map(_5e2.filter(this.fields,function(_745){return !!(_745&&_745.type==="esriFieldTypeDate");}),function(_746){return _746.name;});this._dtOpts={properties:_744};}return this._dtOpts;},_applyNormalized:function(_747,_748){if(_747&&_748){_5e2.forEach(_747,function(_749,_74a){if(_749&&_748[_74a]){_749.setGeometry(_748[_74a]);}});}},_editHandler:function(_74b,adds,_74c,_74d,_74e,dfd){var _74f=_74b.addResults,_750=_74b.updateResults,_751=_74b.deleteResults,i,_752,oid,_753,attr,_754=this.objectIdField,mode=this._mode,_755=this._isTable;var _756=this.editFieldsInfo,_757=this.getOutFields()||[],_758=_756&&_756.creatorField,_759=_756&&_756.creationDateField,_75a=_756&&_756.editorField,_75b=_756&&_756.editDateField,_75c=_756&&_756.realm;if(_5e2.indexOf(_757,"*")===-1){if(_758&&_5e2.indexOf(_757,_758)===-1){_758=null;}if(_759&&_5e2.indexOf(_757,_759)===-1){_759=null;}if(_75a&&_5e2.indexOf(_757,_75a)===-1){_75a=null;}if(_75b&&_5e2.indexOf(_757,_75b)===-1){_75b=null;}}var _75d=(_759||_75b)?(new Date()).getTime():null,_75e=(_758||_75a)?this.getUserId():undefined;if(_75e&&_75c){_75e=_75e+"@"+_75c;}if(_74f){for(i=0;i<_74f.length;i++){_74f[i]=new _5fe(_74f[i]);if(_755){continue;}_752=_74f[i];if(_752.success){oid=_752.objectId;_753=adds[i];var gl=_753._graphicsLayer;if(gl&&gl!==this){gl.remove(_753);}attr=_753.attributes||{};attr[_754]=oid;if(_758){attr[_758]=_75e;}if(_75a){attr[_75a]=_75e;}if(_759){attr[_759]=_75d;}if(_75b){attr[_75b]=_75d;}_753.setAttributes(attr);if(mode._init){mode.drawFeature(_753);}}}}if(_750){for(i=0;i<_750.length;i++){_750[i]=new _5fe(_750[i]);if(_755){continue;}_752=_750[i];if(_752.success){oid=_752.objectId;_753=_74c[oid];var _75f=mode._getFeature(oid);if(_75f){if(_75f.geometry!==_753.geometry){_75f.setGeometry(_5f7.fromJson(_753.geometry.toJson()));}this._repaint(_75f,oid);}_753=_75f||_753;attr=_753.attributes||{};if(_75a){attr[_75a]=_75e;}if(_75b){attr[_75b]=_75d;}_753.setAttributes(attr);}}}if(_751){var _760=[];for(i=0;i<_751.length;i++){_751[i]=new _5fe(_751[i]);if(_755){continue;}_752=_751[i];if(_752.success){oid=_752.objectId;_753=mode._getFeature(oid);if(_753){if(this._unSelectFeatureIIf(oid,mode)){_760.push(_753);}_753._count=0;mode._removeFeatureIIf(oid);}}}if(_760.length>0){this.onSelectionComplete(_760,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_74f,_750,_751],"onEditsComplete",_74d,dfd);},_sendAttachment:function(type,_761,_762,_763,_764){var _765=(type==="add")?"addAttachment":"updateAttachment",url=this._url.path+"/"+_761+"/"+_765,self=this;var dfd=_5e9({url:url,form:_762,content:lang.mixin(this._url.query,{f:"json",token:this._getToken()||undefined}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(_766){var _767=(type==="add")?"addAttachmentResult":"updateAttachmentResult",_768=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete",_769=new _5fe(_766[_767]);_769.attachmentId=_769.objectId;_769.objectId=_761;self._resolve([_769],_768,_763);return _769;}).addErrback(function(_76a){self._resolve([_76a],null,_764,null,true);});return dfd;},_repaint:function(_76b,oid,_76c){oid=_5e8.isDefined(oid)?oid:_76b.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_76b.setSymbol(_76b.symbol,_76c);}},_getKind:function(_76d){var _76e=this._trackManager;if(_76e){return _76e.isLatestObservation(_76d)?1:0;}return 0;}});lang.mixin(_603,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});_5f8._createWrappers(_603);if(has("extend-esri")){lang.setObject("layers.FeatureLayer",_603,_5e7);}return _603;});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/mouse","dojo/on","dojo/touch","./_ListBase"],function(_76f,_770,on,_771,_772){return _76f("dijit.form._ListMouseMixin",_772,{postCreate:function(){this.inherited(arguments);this.own(on(this.domNode,_771.press,function(evt){evt.preventDefault();}));this._listConnect(_771.press,"_onMouseDown");this._listConnect(_771.release,"_onMouseUp");this._listConnect(_770.enter,"_onMouseOver");this._listConnect(_770.leave,"_onMouseOut");},_onMouseDown:function(evt,_773){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(_773);},_onMouseUp:function(evt,_774){this._isDragging=false;var _775=this.selected;var _776=this._hoveredNode;if(_775&&_774==_775){this.onClick(_775);}else{if(_776&&_774==_776){this._setSelectedAttr(_776);this.onClick(_776);}}},_onMouseOut:function(evt,_777){if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt,_778){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}this._hoveredNode=_778;this.onHover(_778);if(this._isDragging){this._setSelectedAttr(_778);}}});});},"dojox/gfx/Moveable":function(){define("dojox/gfx/Moveable",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover","dojo/mouse"],function(lang,_779,arr,_77a,_77b,_77c,_77d,win,_77e,_77f){return _779("dojox.gfx.Moveable",null,{constructor:function(_780,_781){this.shape=_780;this.delay=(_781&&_781.delay>0)?_781.delay:0;this.mover=(_781&&_781.mover)?_781.mover:_77e;this.leftButtonOnly=_781&&_781.leftButtonOnly;this.events=[this.shape.connect(_77c.press,lang.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_782){_782.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.connect(_77c.move,lang.hitch(this,"onMouseMove")),this.shape.connect(_77c.release,lang.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{if(!this.leftButtonOnly||_77f.isLeft(e)){new this.mover(this.shape,e,this);}}_77a.stop(e);},onMouseMove:function(e){var _783=e.clientX,_784=e.clientY;if(Math.abs(_783-this._lastX)>this.delay||Math.abs(_784-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_77a.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_785){_77b.publish("/gfx/move/start",_785);_77d.add(win.body(),"dojoMove");},onMoveStop:function(_786){_77b.publish("/gfx/move/stop",_786);_77d.remove(win.body(),"dojoMove");},onFirstMove:function(_787){},onMove:function(_788,_789){this.onMoving(_788,_789);this.shape.applyLeftTransform(_789);this.onMoved(_788,_789);},onMoving:function(_78a,_78b){},onMoved:function(_78c,_78d){}});});},"dijit/_editor/RichText":function(){define("dijit/_editor/RichText",["dojo/_base/array","dojo/_base/config","dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/query","dojo/ready","dojo/sniff","dojo/topic","dojo/_base/unload","dojo/_base/url","dojo/_base/window","../_Widget","../_CssStateMixin","./selection","./range","./html","../focus","../main"],function(_78e,_78f,_790,_791,dom,_792,_793,_794,_795,_796,_797,_798,keys,lang,on,_799,_79a,has,_79b,_79c,_79d,win,_79e,_79f,_7a0,_7a1,_7a2,_7a3,_7a4){var _7a5=_790("dijit._editor.RichText",[_79e,_79f],{constructor:function(_7a6){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};if(_7a6&&lang.isString(_7a6.value)){this.value=_7a6.value;}this.onLoadDeferred=new _791();},baseClass:"dijitEditor",inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"===this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}this.contentPreFilters=[lang.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);if(has("mozilla")){this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters);this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters);}if(has("webkit")){this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters);this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters);}if(has("ie")){this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters);this.contentDomPostFilters=[lang.hitch(this,this._stripBreakerNodes)].concat(this.contentDomPostFilters);}this.inherited(arguments);_79b.publish(_7a4._scopeName+"._editor.RichText::init",this);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var exec=lang.hitch(this,function(cmd,arg){return function(){return !this.execCommand(cmd,arg);};});var _7a7={b:exec("bold"),i:exec("italic"),u:exec("underline"),a:exec("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":exec("formatblock","h1"),"2":exec("formatblock","h2"),"3":exec("formatblock","h3"),"4":exec("formatblock","h4"),"\\":exec("insertunorderedlist")};if(!has("ie")){_7a7.Z=exec("redo");}var key;for(key in _7a7){this.addKeyHandler(key,true,false,_7a7[key]);}},events:["onKeyPress","onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(_7a5._editorCommandsLocalized){this._local2NativeFormatNames=_7a5._local2NativeFormatNames;this._native2LocalFormatNames=_7a5._native2LocalFormatNames;return;}_7a5._editorCommandsLocalized=true;_7a5._local2NativeFormatNames={};_7a5._native2LocalFormatNames={};this._local2NativeFormatNames=_7a5._local2NativeFormatNames;this._native2LocalFormatNames=_7a5._native2LocalFormatNames;var _7a8=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _7a9="",_7aa,i=0;while((_7aa=_7a8[i++])){if(_7aa.charAt(1)!=="l"){_7a9+="<"+_7aa+"><span>content</span></"+_7aa+"><br/>";}else{_7a9+="<"+_7aa+"><li>content</li></"+_7aa+"><br/>";}}var _7ab={position:"absolute",top:"0px",zIndex:10,opacity:0.01};var div=_794.create("div",{style:_7ab,innerHTML:_7a9});this.ownerDocumentBody.appendChild(div);var _7ac=lang.hitch(this,function(){var node=div.firstChild;while(node){try{this._sCall("selectElement",[node.firstChild]);var _7ad=node.tagName.toLowerCase();this._local2NativeFormatNames[_7ad]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_7ad]]=_7ad;node=node.nextSibling.nextSibling;}catch(e){}}_794.destroy(div);});this.defer(_7ac);},open:function(_7ae){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _791();}if(!this.isClosed){this.close();}_79b.publish(_7a4._scopeName+"._editor.RichText::open",this);if(arguments.length===1&&_7ae.nodeName){this.domNode=_7ae;}var dn=this.domNode;var html;if(lang.isString(this.value)){html=this.value;delete this.value;dn.innerHTML="";}else{if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;html=ta.value;dn=this.domNode=this.ownerDocument.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_794.place(dn,ta,"before");var _7af=lang.hitch(this,function(){_796.set(ta,{display:"block",position:"absolute",top:"-1000px"});if(has("ie")){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(has("ie")){this.defer(_7af,10);}else{_7af();}if(ta.form){var _7b0=ta.value;this.reset=function(){var _7b1=this.getValue();if(_7b1!==_7b0){this.replaceValue(_7b0);}};on(ta.form,"submit",lang.hitch(this,function(){_792.set(ta,"disabled",this.disabled);ta.value=this.getValue();}));}}else{html=_7a2.getChildrenHtml(dn);dn.innerHTML="";}}this.value=html;if(dn.nodeName&&dn.nodeName==="LI"){dn.innerHTML=" <br>";}this.header=dn.ownerDocument.createElement("div");dn.appendChild(this.header);this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);this.footer=dn.ownerDocument.createElement("div");dn.appendChild(this.footer);if(!this.name){this.name=this.id+"_AUTOGEN";}if(this.name!==""&&(!_78f["useXDomain"]||_78f["allowXdRichTextSave"])){var _7b2=dom.byId(_7a4._scopeName+"._editor.RichText.value");if(_7b2&&_7b2.value!==""){var _7b3=_7b2.value.split(this._SEPARATOR),i=0,dat;while((dat=_7b3[i++])){var data=dat.split(this._NAME_CONTENT_SEP);if(data[0]===this.name){html=data[1];_7b3=_7b3.splice(i,1);_7b2.value=_7b3.join(this._SEPARATOR);break;}}}if(!_7a5._globalSaveHandler){_7a5._globalSaveHandler={};_79c.addOnUnload(function(){var id;for(id in _7a5._globalSaveHandler){var f=_7a5._globalSaveHandler[id];if(lang.isFunction(f)){f();}}});}_7a5._globalSaveHandler[this.id]=lang.hitch(this,"_saveContent");}this.isClosed=false;var ifr=(this.editorObject=this.iframe=this.ownerDocument.createElement("iframe"));ifr.id=this.id+"_iframe";ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(has("ie")>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=lang.hitch(this,function(w){this.window=w;this.document=this.window.document;if(has("ie")){this._localizeEditorCommands();}this.onLoad(html);});var src=this._getIframeDocTxt(),s="javascript: '"+src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(has("safari")<=4){src=ifr.getAttribute("src");if(!src||src.indexOf("javascript")===-1){this.defer(function(){ifr.setAttribute("src",s);});}}if(dn.nodeName==="LI"){dn.lastChild.style.marginTop="-1.2em";}_793.add(this.domNode,this.baseClass);},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var _7b4=_796.getComputedStyle(this.domNode);var html="";var _7b5=true;if(has("ie")||has("webkit")||(!this.height&&!has("mozilla"))){html="<div id='dijitEditorBody'></div>";_7b5=false;}else{if(has("mozilla")){this._cursorToStart=true;html="&#160;";}}var font=[_7b4.fontWeight,_7b4.fontSize,_7b4.fontFamily].join(" ");var _7b6=_7b4.lineHeight;if(_7b6.indexOf("px")>=0){_7b6=parseFloat(_7b6)/parseFloat(_7b4.fontSize);}else{if(_7b6.indexOf("em")>=0){_7b6=parseFloat(_7b6);}else{_7b6="normal";}}var _7b7="";var self=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(_7b8){_7b8=_7b8.replace(/^;/ig,"")+";";var s=_7b8.split(":")[0];if(s){s=lang.trim(s);s=s.toLowerCase();var i;var sC="";for(i=0;i<s.length;i++){var c=s.charAt(i);switch(c){case "-":i++;c=s.charAt(i).toUpperCase();default:sC+=c;}}_796.set(self.domNode,sC,"");}_7b7+=_7b8+";";});var _7b9=_799("label[for=\""+this.id+"\"]");return [this.isLeftToRight()?"<html>\n<head>\n":"<html dir='rtl'>\n<head>\n",(has("mozilla")&&_7b9.length?"<title>"+_7b9[0].innerHTML+"</title>\n":""),"<meta http-equiv='Content-Type' content='text/html'>\n","<style>\n","\tbody,html {\n","\t\tbackground:transparent;\n","\t\tpadding: 1px 0 0 0;\n","\t\tmargin: -1px 0 0 0;\n",((has("webkit"))?"\t\twidth: 100%;\n":""),((has("webkit"))?"\t\theight: 100%;\n":""),"\t}\n","\tbody{\n","\t\ttop:0px;\n","\t\tleft:0px;\n","\t\tright:0px;\n","\t\tfont:",font,";\n",((this.height||has("opera"))?"":"\t\tposition: fixed;\n"),"\t\tmin-height:",this.minHeight,";\n","\t\tline-height:",_7b6,";\n","\t}\n","\tp{ margin: 1em 0; }\n",(!_7b5&&!this.height?"\tbody,html {overflow-y: hidden;}\n":""),"\t#dijitEditorBody{overflow-x: auto; overflow-y:"+(this.height?"auto;":"hidden;")+" outline: 0px;}\n","\tli > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; }\n",(!has("ie")?"\tli{ min-height:1.2em; }\n":""),"</style>\n",this._applyEditingAreaStyleSheets(),"\n","</head>\n<body ",(_7b5?"id='dijitEditorBody' ":""),"onload='frameElement && frameElement._loadFunc(window,document)' ","style='"+_7b7+"'>",html,"</body>\n</html>"].join("");},_applyEditingAreaStyleSheets:function(){var _7ba=[];if(this.styleSheets){_7ba=this.styleSheets.split(";");this.styleSheets="";}_7ba=_7ba.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var text="",i=0,url;while((url=_7ba[i++])){var _7bb=(new _79d(win.global.location,url)).toString();this.editingAreaStyleSheets.push(_7bb);text+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_7bb+"\"/>";}return text;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _79d(win.global.location,url)).toString();}if(_78e.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);this.onLoadDeferred.then(lang.hitch(this,function(){if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var head=this.document.getElementsByTagName("head")[0];var _7bc=this.document.createElement("link");_7bc.rel="stylesheet";_7bc.type="text/css";_7bc.href=url;head.appendChild(_7bc);}}));},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)==="."||(url.charAt(0)!=="/"&&!uri.host)){url=(new _79d(win.global.location,url)).toString();}var _7bd=_78e.indexOf(this.editingAreaStyleSheets,url);if(_7bd===-1){return;}delete this.editingAreaStyleSheets[_7bd];_799("link:[href=\""+url+"\"]",this.window.document).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_7be){_7be=!!_7be;this._set("disabled",_7be);if(!this.isLoaded){return;}if(has("ie")||has("webkit")||has("opera")){var _7bf=has("ie")&&(this.isLoaded||!this.focusOnLoad);if(_7bf){this.editNode.unselectable="on";}this.editNode.contentEditable=!_7be;if(_7bf){this.defer(function(){if(this.editNode){this.editNode.unselectable="off";}});}}else{try{this.document.designMode=(_7be?"off":"on");}catch(e){return;}if(!_7be&&this._mozSettingProps){var ps=this._mozSettingProps;var n;for(n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e2){}}}}}this._disabledOK=true;},onLoad:function(html){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;this._iframeRegHandle=_7a3.registerIframe(this.iframe);}if(!has("ie")&&!has("webkit")&&(this.height||has("mozilla"))){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _7c0=this;if(has("ie")){this.tabStop=_794.create("div",{tabIndex:-1},this.editingArea);this.iframe.onfocus=function(){_7c0.editNode.setActive();};}}this.focusNode=this.editNode;var _7c1=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_78e.forEach(_7c1,function(item){this.connect(ap,item.toLowerCase(),item);},this);this.connect(ap,"onmouseup","onClick");if(has("ie")){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}else{this.connect(this.document,"onmousedown",function(){delete this._cursorToStart;});}if(has("webkit")){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");this.connect(this.document,"onmousedown",function(e){var t=e.target;if(t&&(t===this.document.body||t===this.document)){this.defer("placeCursorAtEnd");}});}if(has("ie")){try{this.document.execCommand("RespectVisibilityInDesign",true,null);}catch(e){}}this.isLoaded=true;this.set("disabled",this.disabled);var _7c2=lang.hitch(this,function(){this.setValue(html);if(this.onLoadDeferred){this.onLoadDeferred.resolve(true);}this.onDisplayChanged();if(this.focusOnLoad){_79a(lang.hitch(this,"defer","focus",this.updateInterval));}this.value=this.getValue(true);});if(this.setValueDeferred){this.setValueDeferred.then(_7c2);}else{_7c2();}},onKeyDown:function(e){if(e.keyCode===keys.TAB&&this.isTabIndent){_797.stop(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(has("ie")){if(e.keyCode==keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===keys.BACKSPACE&&this.document.selection.type==="Control"){_797.stop(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}if(has("ff")){if(e.keyCode===keys.PAGE_UP||e.keyCode===keys.PAGE_DOWN){if(this.editNode.clientHeight>=this.editNode.scrollHeight){e.preventDefault();}}}return true;},onKeyUp:function(){},setDisabled:function(_7c3){_798.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.set("disabled",_7c3);},_setValueAttr:function(_7c4){this.setValue(_7c4);},_setDisableSpellCheckAttr:function(_7c5){if(this.document){_792.set(this.document.body,"spellcheck",!_7c5);}else{this.onLoadDeferred.then(lang.hitch(this,function(){_792.set(this.document.body,"spellcheck",!_7c5);}));}this._set("disableSpellCheck",_7c5);},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode,_7c6=this._keyHandlers[c],args=arguments;if(_7c6&&!e.altKey){_78e.some(_7c6,function(h){if(!(h.shift^e.shiftKey)&&!(h.ctrl^(e.ctrlKey||e.metaKey))){if(!h.handler.apply(this,args)){e.preventDefault();}return true;}},this);}if(!this._onKeyHitch){this._onKeyHitch=lang.hitch(this,"onKeyPressed");}this.defer("_onKeyHitch",1);return true;},addKeyHandler:function(key,ctrl,_7c7,_7c8){if(!lang.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_7c7||false,ctrl:ctrl||false,handler:_7c8});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(){if(!this.focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _7c9=this.getValue(true);if(_7c9!==this.value){this.onChange(_7c9);}this._set("value",_7c9);},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.set("disabled",false);}this.inherited(arguments);}},blur:function(){if(!has("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(this.ownerDocumentBody.focus){this.ownerDocumentBody.focus();}}},focus:function(){if(!this.isLoaded){this.focusOnLoad=true;return;}if(this._cursorToStart){delete this._cursorToStart;if(this.editNode.childNodes){this.placeCursorAtStart();return;}}if(!has("ie")){_7a3.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(){if(this._updateTimer){this._updateTimer.remove();}this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(){},_normalizeCommand:function(cmd,_7ca){var _7cb=cmd.toLowerCase();if(_7cb==="formatblock"){if(has("safari")&&_7ca===undefined){_7cb="heading";}}else{if(_7cb==="hilitecolor"&&!has("mozilla")){_7cb="backcolor";}}return _7cb;},_qcaCache:{},queryCommandAvailable:function(_7cc){var ca=this._qcaCache[_7cc];if(ca!==undefined){return ca;}return (this._qcaCache[_7cc]=this._queryCommandAvailable(_7cc));},_queryCommandAvailable:function(_7cd){var ie=1;var _7ce=1<<1;var _7cf=1<<2;var _7d0=1<<3;function _7d1(_7d2){return {ie:Boolean(_7d2&ie),mozilla:Boolean(_7d2&_7ce),webkit:Boolean(_7d2&_7cf),opera:Boolean(_7d2&_7d0)};};var _7d3=null;switch(_7cd.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_7d3=_7d1(_7ce|ie|_7cf|_7d0);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_7d3=_7d1(_7ce|ie|_7d0|_7cf);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_7d3=_7d1(ie);break;case "cut":case "copy":case "paste":_7d3=_7d1(ie|_7ce|_7cf|_7d0);break;case "inserttable":_7d3=_7d1(_7ce|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_7d3=_7d1(ie|_7ce);break;default:return false;}return (has("ie")&&_7d3.ie)||(has("mozilla")&&_7d3.mozilla)||(has("webkit")&&_7d3.webkit)||(has("opera")&&_7d3.opera);},execCommand:function(_7d4,_7d5){var _7d6;this.focus();_7d4=this._normalizeCommand(_7d4,_7d5);if(_7d5!==undefined){if(_7d4==="heading"){throw new Error("unimplemented");}else{if((_7d4==="formatblock")&&has("ie")){_7d5="<"+_7d5+">";}}}var _7d7="_"+_7d4+"Impl";if(this[_7d7]){_7d6=this[_7d7](_7d5);}else{_7d5=arguments.length>1?_7d5:null;if(_7d5||_7d4!=="createlink"){_7d6=this.document.execCommand(_7d4,false,_7d5);}}this.onDisplayChanged();return _7d6;},queryCommandEnabled:function(_7d8){if(this.disabled||!this._disabledOK){return false;}_7d8=this._normalizeCommand(_7d8);var _7d9="_"+_7d8+"EnabledImpl";if(this[_7d9]){return this[_7d9](_7d8);}else{return this._browserQueryCommandEnabled(_7d8);}},queryCommandState:function(_7da){if(this.disabled||!this._disabledOK){return false;}_7da=this._normalizeCommand(_7da);try{return this.document.queryCommandState(_7da);}catch(e){return false;}},queryCommandValue:function(_7db){if(this.disabled||!this._disabledOK){return false;}var r;_7db=this._normalizeCommand(_7db);if(has("ie")&&_7db==="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_7db)];}else{if(has("mozilla")&&_7db==="hilitecolor"){var _7dc;try{_7dc=this.document.queryCommandValue("styleWithCSS");}catch(e){_7dc=false;}this.document.execCommand("styleWithCSS",false,true);r=this.document.queryCommandValue(_7db);this.document.execCommand("styleWithCSS",false,_7dc);}else{r=this.document.queryCommandValue(_7db);}}return r;},_sCall:function(name,args){return win.withGlobal(this.window,name,_7a0,args);},placeCursorAtStart:function(){this.focus();var _7dd=false;if(has("mozilla")){var _7de=this.editNode.firstChild;while(_7de){if(_7de.nodeType===3){if(_7de.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7dd=true;this._sCall("selectElement",[_7de]);break;}}else{if(_7de.nodeType===1){_7dd=true;var tg=_7de.tagName?_7de.tagName.toLowerCase():"";if(/br|input|img|base|meta|area|basefont|hr|link/.test(tg)){this._sCall("selectElement",[_7de]);}else{this._sCall("selectElementChildren",[_7de]);}break;}}_7de=_7de.nextSibling;}}else{_7dd=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7dd){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _7df=false;if(has("mozilla")){var last=this.editNode.lastChild;while(last){if(last.nodeType===3){if(last.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7df=true;this._sCall("selectElement",[last]);break;}}else{if(last.nodeType===1){_7df=true;this._sCall("selectElement",[last.lastChild||last]);break;}}last=last.previousSibling;}}else{_7df=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7df){this._sCall("collapse",[false]);}},getValue:function(_7e0){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_7e0);},_getValueAttr:function(){return this.getValue(true);},setValue:function(html){if(!this.isLoaded){this.onLoadDeferred.then(lang.hitch(this,function(){this.setValue(html);}));return;}this._cursorToStart=true;if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=html;}else{html=this._preFilterContent(html);var node=this.isClosed?this.domNode:this.editNode;if(html&&has("mozilla")&&html.toLowerCase()==="<p></p>"){html="<p>&#160;</p>";}if(!html&&has("webkit")){html="&#160;";}node.innerHTML=html;this._preDomFilterContent(node);}this.onDisplayChanged();this._set("value",this.getValue(true));},replaceValue:function(html){if(this.isClosed){this.setValue(html);}else{if(this.window&&this.window.getSelection&&!has("mozilla")){this.setValue(html);}else{if(this.window&&this.window.getSelection){html=this._preFilterContent(html);this.execCommand("selectall");if(!html){this._cursorToStart=true;html="&#160;";}this.execCommand("inserthtml",html);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(html);}}}}this._set("value",this.getValue(true));},_preFilterContent:function(html){var ec=html;_78e.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_78e.forEach(this.contentDomPreFilters,function(ef){if(ef&&lang.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_7e1){var ec;if(!lang.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_7e1){dom=lang.clone(dom);}_78e.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_7a2.getChildrenHtml(dom);}else{ec=dom;}if(!lang.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_78e.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(){var _7e2=dom.byId(_7a4._scopeName+"._editor.RichText.value");if(_7e2){if(_7e2.value){_7e2.value+=this._SEPARATOR;}_7e2.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(true);}},escapeXml:function(str,_7e3){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_7e3){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(node){_798.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",2);return _7a2.getNodeHtml(node);},getNodeChildrenHtml:function(dom){_798.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return _7a2.getChildrenHtml(dom);},close:function(save){if(this.isClosed){return;}if(!arguments.length){save=true;}if(save){this._set("value",this.getValue(true));}if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(has("ie")){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this._iframeRegHandle){this._iframeRegHandle.remove();delete this._iframeRegHandle;}if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(has("ie")){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=this.value;_794.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=this.value;}delete this.iframe;_793.remove(this.domNode,this.baseClass);this.isClosed=true;this.isLoaded=false;delete this.editNode;delete this.focusNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;},destroy:function(){if(!this.isClosed){this.close(false);}if(this._updateTimer){this._updateTimer.remove();}this.inherited(arguments);if(_7a5._globalSaveHandler){delete _7a5._globalSaveHandler[this.id];}},_removeMozBogus:function(html){return html.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"");},_removeWebkitBogus:function(html){html=html.replace(/\sclass="webkit-block-placeholder"/gi,"");html=html.replace(/\sclass="apple-style-span"/gi,"");html=html.replace(/<meta charset=\"utf-8\" \/>/gi,"");return html;},_normalizeFontStyle:function(html){return html.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(html){return html.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");},_browserQueryCommandEnabled:function(_7e4){if(!_7e4){return false;}var elem=has("ie")?this.document.selection.createRange():this.document;try{return elem.queryCommandEnabled(_7e4);}catch(e){return false;}},_createlinkEnabledImpl:function(){var _7e5=true;if(has("opera")){var sel=this.window.getSelection();if(sel.isCollapsed){_7e5=true;}else{_7e5=this.document.queryCommandEnabled("createlink");}}else{_7e5=this._browserQueryCommandEnabled("createlink");}return _7e5;},_unlinkEnabledImpl:function(){var _7e6=true;if(has("mozilla")||has("webkit")){_7e6=this._sCall("hasAncestorElement",["a"]);}else{_7e6=this._browserQueryCommandEnabled("unlink");}return _7e6;},_inserttableEnabledImpl:function(){var _7e7=true;if(has("mozilla")||has("webkit")){_7e7=true;}else{_7e7=this._browserQueryCommandEnabled("inserttable");}return _7e7;},_cutEnabledImpl:function(){var _7e8=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_7e8=!!sel;}else{_7e8=this._browserQueryCommandEnabled("cut");}return _7e8;},_copyEnabledImpl:function(){var _7e9=true;if(has("webkit")){var sel=this.window.getSelection();if(sel){sel=sel.toString();}_7e9=!!sel;}else{_7e9=this._browserQueryCommandEnabled("copy");}return _7e9;},_pasteEnabledImpl:function(){var _7ea=true;if(has("webkit")){return true;}else{_7ea=this._browserQueryCommandEnabled("paste");}return _7ea;},_inserthorizontalruleImpl:function(_7eb){if(has("ie")){return this._inserthtmlImpl("<hr>");}return this.document.execCommand("inserthorizontalrule",false,_7eb);},_unlinkImpl:function(_7ec){if((this.queryCommandEnabled("unlink"))&&(has("mozilla")||has("webkit"))){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);return this.document.execCommand("unlink",false,null);}return this.document.execCommand("unlink",false,_7ec);},_hilitecolorImpl:function(_7ed){var _7ee;var _7ef=this._handleTextColorOrProperties("hilitecolor",_7ed);if(!_7ef){if(has("mozilla")){this.document.execCommand("styleWithCSS",false,true);console.log("Executing color command.");_7ee=this.document.execCommand("hilitecolor",false,_7ed);this.document.execCommand("styleWithCSS",false,false);}else{_7ee=this.document.execCommand("hilitecolor",false,_7ed);}}return _7ee;},_backcolorImpl:function(_7f0){if(has("ie")){_7f0=_7f0?_7f0:null;}var _7f1=this._handleTextColorOrProperties("backcolor",_7f0);if(!_7f1){_7f1=this.document.execCommand("backcolor",false,_7f0);}return _7f1;},_forecolorImpl:function(_7f2){if(has("ie")){_7f2=_7f2?_7f2:null;}var _7f3=false;_7f3=this._handleTextColorOrProperties("forecolor",_7f2);if(!_7f3){_7f3=this.document.execCommand("forecolor",false,_7f2);}return _7f3;},_inserthtmlImpl:function(_7f4){_7f4=this._preFilterContent(_7f4);var rv=true;if(has("ie")){var _7f5=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()==="CONTROL"){var n=_7f5.item(0);while(_7f5.length){_7f5.remove(_7f5.item(0));}n.outerHTML=_7f4;}else{_7f5.pasteHTML(_7f4);}_7f5.select();}else{if(has("mozilla")&&!_7f4.length){this._sCall("remove");}else{rv=this.document.execCommand("inserthtml",false,_7f4);}}return rv;},_boldImpl:function(_7f6){var _7f7=false;if(has("ie")){this._adaptIESelection();_7f7=this._adaptIEFormatAreaAndExec("bold");}if(!_7f7){_7f7=this.document.execCommand("bold",false,_7f6);}return _7f7;},_italicImpl:function(_7f8){var _7f9=false;if(has("ie")){this._adaptIESelection();_7f9=this._adaptIEFormatAreaAndExec("italic");}if(!_7f9){_7f9=this.document.execCommand("italic",false,_7f8);}return _7f9;},_underlineImpl:function(_7fa){var _7fb=false;if(has("ie")){this._adaptIESelection();_7fb=this._adaptIEFormatAreaAndExec("underline");}if(!_7fb){_7fb=this.document.execCommand("underline",false,_7fa);}return _7fb;},_strikethroughImpl:function(_7fc){var _7fd=false;if(has("ie")){this._adaptIESelection();_7fd=this._adaptIEFormatAreaAndExec("strikethrough");}if(!_7fd){_7fd=this.document.execCommand("strikethrough",false,_7fc);}return _7fd;},_superscriptImpl:function(_7fe){var _7ff=false;if(has("ie")){this._adaptIESelection();_7ff=this._adaptIEFormatAreaAndExec("superscript");}if(!_7ff){_7ff=this.document.execCommand("superscript",false,_7fe);}return _7ff;},_subscriptImpl:function(_800){var _801=false;if(has("ie")){this._adaptIESelection();_801=this._adaptIEFormatAreaAndExec("subscript");}if(!_801){_801=this.document.execCommand("subscript",false,_800);}return _801;},_fontnameImpl:function(_802){var _803;if(has("ie")){_803=this._handleTextColorOrProperties("fontname",_802);}if(!_803){_803=this.document.execCommand("fontname",false,_802);}return _803;},_fontsizeImpl:function(_804){var _805;if(has("ie")){_805=this._handleTextColorOrProperties("fontsize",_804);}if(!_805){_805=this.document.execCommand("fontsize",false,_804);}return _805;},_insertorderedlistImpl:function(_806){var _807=false;if(has("ie")){_807=this._adaptIEList("insertorderedlist",_806);}if(!_807){_807=this.document.execCommand("insertorderedlist",false,_806);}return _807;},_insertunorderedlistImpl:function(_808){var _809=false;if(has("ie")){_809=this._adaptIEList("insertunorderedlist",_808);}if(!_809){_809=this.document.execCommand("insertunorderedlist",false,_808);}return _809;},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header);},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer);},_getNodeChildrenHeight:function(node){var h=0;if(node&&node.childNodes){var i;for(i=0;i<node.childNodes.length;i++){var size=_795.position(node.childNodes[i]);h+=size.h;}}return h;},_isNodeEmpty:function(node,_80a){if(node.nodeType===1){if(node.childNodes.length>0){return this._isNodeEmpty(node.childNodes[0],_80a);}return true;}else{if(node.nodeType===3){return (node.nodeValue.substring(_80a)==="");}}return false;},_removeStartingRangeFromRange:function(node,_80b){if(node.nextSibling){_80b.setStart(node.nextSibling,0);}else{var _80c=node.parentNode;while(_80c&&_80c.nextSibling==null){_80c=_80c.parentNode;}if(_80c){_80b.setStart(_80c.nextSibling,0);}}return _80b;},_adaptIESelection:function(){var _80d=_7a1.getSelection(this.window);if(_80d&&_80d.rangeCount&&!_80d.isCollapsed){var _80e=_80d.getRangeAt(0);var _80f=_80e.startContainer;var _810=_80e.startOffset;while(_80f.nodeType===3&&_810>=_80f.length&&_80f.nextSibling){_810=_810-_80f.length;_80f=_80f.nextSibling;}var _811=null;while(this._isNodeEmpty(_80f,_810)&&_80f!==_811){_811=_80f;_80e=this._removeStartingRangeFromRange(_80f,_80e);_80f=_80e.startContainer;_810=0;}_80d.removeAllRanges();_80d.addRange(_80e);}},_adaptIEFormatAreaAndExec:function(_812){var _813=_7a1.getSelection(this.window);var doc=this.document;var rs,ret,_814,txt,_815,_816,_817,_818;if(_812&&_813&&_813.isCollapsed){var _819=this.queryCommandValue(_812);if(_819){var _81a=this._tagNamesForCommand(_812);_814=_813.getRangeAt(0);var fs=_814.startContainer;if(fs.nodeType===3){var _81b=_814.endOffset;if(fs.length<_81b){ret=this._adjustNodeAndOffset(rs,_81b);fs=ret.node;_81b=ret.offset;}}var _81c;while(fs&&fs!==this.editNode){var _81d=fs.tagName?fs.tagName.toLowerCase():"";if(_78e.indexOf(_81a,_81d)>-1){_81c=fs;break;}fs=fs.parentNode;}if(_81c){rs=_814.startContainer;var _81e=doc.createElement(_81c.tagName);_794.place(_81e,_81c,"after");if(rs&&rs.nodeType===3){var _81f,_820;var _821=_814.endOffset;if(rs.length<_821){ret=this._adjustNodeAndOffset(rs,_821);rs=ret.node;_821=ret.offset;}txt=rs.nodeValue;_815=doc.createTextNode(txt.substring(0,_821));var _822=txt.substring(_821,txt.length);if(_822){_816=doc.createTextNode(_822);}_794.place(_815,rs,"before");if(_816){_817=doc.createElement("span");_817.className="ieFormatBreakerSpan";_794.place(_817,rs,"after");_794.place(_816,_817,"after");_816=_817;}_794.destroy(rs);var _823=_815.parentNode;var _824=[];var _825;while(_823!==_81c){var tg=_823.tagName;_825={tagName:tg};_824.push(_825);var _826=doc.createElement(tg);if(_823.style){if(_826.style){if(_823.style.cssText){_826.style.cssText=_823.style.cssText;_825.cssText=_823.style.cssText;}}}if(_823.tagName==="FONT"){if(_823.color){_826.color=_823.color;_825.color=_823.color;}if(_823.face){_826.face=_823.face;_825.face=_823.face;}if(_823.size){_826.size=_823.size;_825.size=_823.size;}}if(_823.className){_826.className=_823.className;_825.className=_823.className;}if(_816){_81f=_816;while(_81f){_820=_81f.nextSibling;_826.appendChild(_81f);_81f=_820;}}if(_826.tagName==_823.tagName){_817=doc.createElement("span");_817.className="ieFormatBreakerSpan";_794.place(_817,_823,"after");_794.place(_826,_817,"after");}else{_794.place(_826,_823,"after");}_815=_823;_816=_826;_823=_823.parentNode;}if(_816){_81f=_816;if(_81f.nodeType===1||(_81f.nodeType===3&&_81f.nodeValue)){_81e.innerHTML="";}while(_81f){_820=_81f.nextSibling;_81e.appendChild(_81f);_81f=_820;}}var _827;if(_824.length){_825=_824.pop();var _828=doc.createElement(_825.tagName);if(_825.cssText&&_828.style){_828.style.cssText=_825.cssText;}if(_825.className){_828.className=_825.className;}if(_825.tagName==="FONT"){if(_825.color){_828.color=_825.color;}if(_825.face){_828.face=_825.face;}if(_825.size){_828.size=_825.size;}}_794.place(_828,_81e,"before");while(_824.length){_825=_824.pop();var _829=doc.createElement(_825.tagName);if(_825.cssText&&_829.style){_829.style.cssText=_825.cssText;}if(_825.className){_829.className=_825.className;}if(_825.tagName==="FONT"){if(_825.color){_829.color=_825.color;}if(_825.face){_829.face=_825.face;}if(_825.size){_829.size=_825.size;}}_828.appendChild(_829);_828=_829;}_818=doc.createTextNode(".");_817.appendChild(_818);_828.appendChild(_818);_827=_7a1.create(this.window);_827.setStart(_818,0);_827.setEnd(_818,_818.length);_813.removeAllRanges();_813.addRange(_827);this._sCall("collapse",[false]);_818.parentNode.innerHTML="";}else{_817=doc.createElement("span");_817.className="ieFormatBreakerSpan";_818=doc.createTextNode(".");_817.appendChild(_818);_794.place(_817,_81e,"before");_827=_7a1.create(this.window);_827.setStart(_818,0);_827.setEnd(_818,_818.length);_813.removeAllRanges();_813.addRange(_827);this._sCall("collapse",[false]);_818.parentNode.innerHTML="";}if(!_81e.firstChild){_794.destroy(_81e);}return true;}}return false;}else{_814=_813.getRangeAt(0);rs=_814.startContainer;if(rs&&rs.nodeType===3){var _81b=_814.startOffset;if(rs.length<_81b){ret=this._adjustNodeAndOffset(rs,_81b);rs=ret.node;_81b=ret.offset;}txt=rs.nodeValue;_815=doc.createTextNode(txt.substring(0,_81b));var _822=txt.substring(_81b);if(_822!==""){_816=doc.createTextNode(txt.substring(_81b));}_817=doc.createElement("span");_818=doc.createTextNode(".");_817.appendChild(_818);if(_815.length){_794.place(_815,rs,"after");}else{_815=rs;}_794.place(_817,_815,"after");if(_816){_794.place(_816,_817,"after");}_794.destroy(rs);var _827=_7a1.create(this.window);_827.setStart(_818,0);_827.setEnd(_818,_818.length);_813.removeAllRanges();_813.addRange(_827);doc.execCommand(_812);_794.place(_817.firstChild,_817,"before");_794.destroy(_817);_827.setStart(_818,0);_827.setEnd(_818,_818.length);_813.removeAllRanges();_813.addRange(_827);this._sCall("collapse",[false]);_818.parentNode.innerHTML="";return true;}}}else{return false;}},_adaptIEList:function(_82a){var _82b=_7a1.getSelection(this.window);if(_82b.isCollapsed){if(_82b.rangeCount&&!this.queryCommandValue(_82a)){var _82c=_82b.getRangeAt(0);var sc=_82c.startContainer;if(sc&&sc.nodeType==3){if(!_82c.startOffset){var _82d="ul";if(_82a==="insertorderedlist"){_82d="ol";}var list=this.document.createElement(_82d);var li=_794.create("li",null,list);_794.place(list,sc,"before");li.appendChild(sc);_794.create("br",null,list,"after");var _82e=_7a1.create(this.window);_82e.setStart(sc,0);_82e.setEnd(sc,sc.length);_82b.removeAllRanges();_82b.addRange(_82e);this._sCall("collapse",[true]);return true;}}}}return false;},_handleTextColorOrProperties:function(_82f,_830){var _831=_7a1.getSelection(this.window);var doc=this.document;var rs,ret,_832,txt,_833,_834,_835,_836;_830=_830||null;if(_82f&&_831&&_831.isCollapsed){if(_831.rangeCount){_832=_831.getRangeAt(0);rs=_832.startContainer;if(rs&&rs.nodeType===3){var _837=_832.startOffset;if(rs.length<_837){ret=this._adjustNodeAndOffset(rs,_837);rs=ret.node;_837=ret.offset;}txt=rs.nodeValue;_833=doc.createTextNode(txt.substring(0,_837));var _838=txt.substring(_837);if(_838!==""){_834=doc.createTextNode(txt.substring(_837));}_835=doc.createElement("span");_836=doc.createTextNode(".");_835.appendChild(_836);var _839=doc.createElement("span");_835.appendChild(_839);if(_833.length){_794.place(_833,rs,"after");}else{_833=rs;}_794.place(_835,_833,"after");if(_834){_794.place(_834,_835,"after");}_794.destroy(rs);var _83a=_7a1.create(this.window);_83a.setStart(_836,0);_83a.setEnd(_836,_836.length);_831.removeAllRanges();_831.addRange(_83a);if(has("webkit")){var _83b="color";if(_82f==="hilitecolor"||_82f==="backcolor"){_83b="backgroundColor";}_796.set(_835,_83b,_830);this._sCall("remove",[]);_794.destroy(_839);_835.innerHTML="&#160;";this._sCall("selectElement",[_835]);this.focus();}else{this.execCommand(_82f,_830);_794.place(_835.firstChild,_835,"before");_794.destroy(_835);_83a.setStart(_836,0);_83a.setEnd(_836,_836.length);_831.removeAllRanges();_831.addRange(_83a);this._sCall("collapse",[false]);_836.parentNode.removeChild(_836);}return true;}}}return false;},_adjustNodeAndOffset:function(node,_83c){while(node.length<_83c&&node.nextSibling&&node.nextSibling.nodeType===3){_83c=_83c-node.length;node=node.nextSibling;}return {"node":node,"offset":_83c};},_tagNamesForCommand:function(_83d){if(_83d==="bold"){return ["b","strong"];}else{if(_83d==="italic"){return ["i","em"];}else{if(_83d==="strikethrough"){return ["s","strike"];}else{if(_83d==="superscript"){return ["sup"];}else{if(_83d==="subscript"){return ["sub"];}else{if(_83d==="underline"){return ["u"];}}}}}}return [];},_stripBreakerNodes:function(node){if(!this.isLoaded){return;}_799(".ieFormatBreakerSpan",node).forEach(function(b){while(b.firstChild){_794.place(b.firstChild,b,"before");}_794.destroy(b);});return node;}});return _7a5;});},"dojox/html/metrics":function(){define("dojox/html/metrics",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/sniff","dojo/ready","dojo/_base/unload","dojo/_base/window","dojo/dom-geometry"],function(_83e,lang,has,_83f,_840,_841,_842){var dhm=lang.getObject("dojox.html.metrics",true);var _843=lang.getObject("dojox");dhm.getFontMeasurements=function(){var _844={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};if(has("ie")){_841.doc.documentElement.style.fontSize="100%";}var div=_841.doc.createElement("div");var ds=div.style;ds.position="absolute";ds.left="-100px";ds.top="0";ds.width="30px";ds.height="1000em";ds.borderWidth="0";ds.margin="0";ds.padding="0";ds.outline="0";ds.lineHeight="1";ds.overflow="hidden";_841.body().appendChild(div);for(var p in _844){ds.fontSize=p;_844[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_841.body().removeChild(div);div=null;return _844;};var _845=null;dhm.getCachedFontMeasurements=function(_846){if(_846||!_845){_845=dhm.getFontMeasurements();}return _845;};var _847=null,_848={};dhm.getTextBox=function(text,_849,_84a){var m,s;if(!_847){m=_847=_841.doc.createElement("div");var c=_841.doc.createElement("div");c.appendChild(m);s=c.style;s.overflow="scroll";s.position="absolute";s.left="0px";s.top="-10000px";s.width="1px";s.height="1px";s.visibility="hidden";s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";_841.body().appendChild(c);}else{m=_847;}m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(arguments.length>1&&_849){for(var i in _849){if(i in _848){continue;}s[i]=_849[i];}}if(arguments.length>2&&_84a){m.className=_84a;}m.innerHTML=text;var box=_842.position(m);box.w=m.parentNode.scrollWidth;return box;};var _84b={w:16,h:16};dhm.getScrollbar=function(){return {w:_84b.w,h:_84b.h};};dhm._fontResizeNode=null;dhm.initOnFontResize=function(_84c){var f=dhm._fontResizeNode=_841.doc.createElement("iframe");var fs=f.style;fs.position="absolute";fs.width="5em";fs.height="10em";fs.top="-10000px";fs.display="none";if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onresize=f.contentWindow.parent[_843._scopeName].html.metrics._fontresize;}};}else{f.onload=function(){f.contentWindow.onresize=f.contentWindow.parent[_843._scopeName].html.metrics._fontresize;};}f.setAttribute("src","javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'");_841.body().appendChild(f);dhm.initOnFontResize=function(){};};dhm.onFontResize=function(){};dhm._fontresize=function(){dhm.onFontResize();};_840.addOnUnload(function(){var f=dhm._fontResizeNode;if(f){if(has("ie")&&f.onresize){f.onresize=null;}else{if(f.contentWindow&&f.contentWindow.onresize){f.contentWindow.onresize=null;}}dhm._fontResizeNode=null;}});_83f(function(){try{var n=_841.doc.createElement("div");n.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";_841.body().appendChild(n);_84b.w=n.offsetWidth-n.clientWidth;_84b.h=n.offsetHeight-n.clientHeight;_841.body().removeChild(n);delete n;}catch(e){}if("fontSizeWatch" in _83e.config&&!!_83e.config.fontSizeWatch){dhm.initOnFontResize();}});return dhm;});},"esri/layers/SelectionMode":function(){define("esri/layers/SelectionMode",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/layers/RenderMode"],function(_84d,lang,has,_84e,_84f){var _850=_84d([_84f],{declaredClass:"esri.layers._SelectionMode",constructor:function(_851){this.featureLayer=_851;this._featureMap={};},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},resume:function(){this.propertyChangeHandler(0);}});if(has("extend-esri")){lang.setObject("layers._SelectionMode",_850,_84e);}return _850;});},"dojox/grid/_EditManager":function(){define("dojox/grid/_EditManager",["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/_base/connect","dojo/_base/sniff","./util"],function(lang,_852,_853,_854,has,util){return _853("dojox.grid._EditManager",null,{constructor:function(_855){this.grid=_855;if(has("ie")){this.connections=[_854.connect(document.body,"onfocus",lang.hitch(this,"_boomerangFocus"))];}else{this.connections=[_854.connect(this.grid,"onBlur",this,"apply")];}},info:{},destroy:function(){_852.forEach(this.connections,_854.disconnect);},cellFocus:function(_856,_857){if(this.grid.singleClickEdit||this.isEditRow(_857)){this.setEditCell(_856,_857);}else{this.apply();}if(this.isEditing()||(_856&&_856.editable&&_856.alwaysEditing)){this._focusEditor(_856,_857);}},rowClick:function(e){if(this.isEditing()&&!this.isEditRow(e.rowIndex)){this.apply();}},styleRow:function(_858){if(_858.index==this.info.rowIndex){_858.customClasses+=" dojoxGridRowEditing";}},dispatchEvent:function(e){var c=e.cell,ed=(c&&c["editable"])?c:0;return ed&&ed.dispatchEvent(e.dispatch,e);},isEditing:function(){return this.info.rowIndex!==undefined;},isEditCell:function(_859,_85a){return (this.info.rowIndex===_859)&&(this.info.cell.index==_85a);},isEditRow:function(_85b){return this.info.rowIndex===_85b;},setEditCell:function(_85c,_85d){if(!this.isEditCell(_85d,_85c.index)&&this.grid.canEdit&&this.grid.canEdit(_85c,_85d)){this.start(_85c,_85d,this.isEditRow(_85d)||_85c.editable);}},_focusEditor:function(_85e,_85f){util.fire(_85e,"focus",[_85f]);},focusEditor:function(){if(this.isEditing()){this._focusEditor(this.info.cell,this.info.rowIndex);}},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>new Date().getTime();},_boomerangFocus:function(){if(this._shouldCatchBoomerang()){this.grid.focus.focusGrid();this.focusEditor();this._catchBoomerang=0;}},_doCatchBoomerang:function(){if(has("ie")){this._catchBoomerang=new Date().getTime()+this._boomerangWindow;}},start:function(_860,_861,_862){if(!this._isValidInput()){return;}this.grid.beginUpdate();this.editorApply();if(this.isEditing()&&!this.isEditRow(_861)){this.applyRowEdit();this.grid.updateRow(_861);}if(_862){this.info={cell:_860,rowIndex:_861};this.grid.doStartEdit(_860,_861);this.grid.updateRow(_861);}else{this.info={};}this.grid.endUpdate();this.grid.focus.focusGrid();this._focusEditor(_860,_861);this._doCatchBoomerang();},_editorDo:function(_863){var c=this.info.cell;if(c&&c.editable){c[_863](this.info.rowIndex);}},editorApply:function(){this._editorDo("apply");},editorCancel:function(){this._editorDo("cancel");},applyCellEdit:function(_864,_865,_866){if(this.grid.canEdit(_865,_866)){this.grid.doApplyCellEdit(_864,_866,_865.field);}},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field);},apply:function(){if(this.isEditing()&&this._isValidInput()){this.grid.beginUpdate();this.editorApply();this.applyRowEdit();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},cancel:function(){if(this.isEditing()){this.grid.beginUpdate();this.editorCancel();this.info={};this.grid.endUpdate();this.grid.focus.focusGrid();this._doCatchBoomerang();}},save:function(_867,_868){var c=this.info.cell;if(this.isEditRow(_867)&&(!_868||c.view==_868)&&c.editable){c.save(c,this.info.rowIndex);}},restore:function(_869,_86a){var c=this.info.cell;if(this.isEditRow(_86a)&&c.view==_869&&c.editable){c.restore(this.info.rowIndex);}},_isValidInput:function(){var w=(this.info.cell||{}).widget;if(!w||!w.isValid){return true;}w.focused=true;return w.isValid(true);}});});},"dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/data/util/filter","dojo/_base/declare","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/sniff","dojo/string","./DataList","../registry","./_TextBoxMixin","./_SearchMixin"],function(_86b,_86c,_86d,_86e,keys,lang,_86f,_870,has,_871,_872,_873,_874,_875){return _86c("dijit.form._AutoCompleterMixin",_875,{item:null,autoComplete:true,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_876){var pos=0;if(typeof (_876.selectionStart)=="number"){pos=_876.selectionStart;}else{if(has("ie")){var tr=_876.ownerDocument.selection.createRange().duplicate();var ntr=_876.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_877,_878){_878=parseInt(_878);_874.selectInputText(_877,_878,_878);},_setDisabledAttr:function(_879){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_879?"true":"false");},_onKey:function(evt){if(evt.charCode>=32){return;}var key=evt.charCode||evt.keyCode;if(key==keys.ALT||key==keys.CTRL||key==keys.META||key==keys.SHIFT){return;}var pw=this.dropDown;var _87a=null;this._abortQuery();this.inherited(arguments);if(evt.altKey||evt.ctrlKey||evt.metaKey){return;}if(this._opened){_87a=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_87a);}_86e.stop(evt);break;case keys.ENTER:if(_87a){if(_87a==pw.nextButton){this._nextSearch(1);_86e.stop(evt);break;}else{if(_87a==pw.previousButton){this._nextSearch(-1);_86e.stop(evt);break;}}_86e.stop(evt);}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}case keys.TAB:var _87b=this.get("displayedValue");if(pw&&(_87b==pw._messages["previousMessage"]||_87b==pw._messages["nextMessage"])){break;}if(_87a){this._selectOption(_87a);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;}},_autoCompleteText:function(text){var fn=this.focusNode;_874.selectInputText(fn,fn.value.length);var _87c=this.ignoreCase?"toLowerCase":"substr";if(text[_87c](0).indexOf(this.focusNode.value[_87c](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_874.selectInputText(fn,cpos);}}else{fn.value=text;_874.selectInputText(fn);}},_openResultList:function(_87d,_87e,_87f){var _880=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_87d.length&&_87f.start==0){this.closeDropDown();return;}this._nextSearch=this.dropDown.onPage=lang.hitch(this,function(_881){_87d.nextPage(_881!==-1);this.focus();});this.dropDown.createOptions(_87d,_87f,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if("direction" in _87f){if(_87f.direction){this.dropDown.highlightFirstOption();}else{if(!_87f.direction){this.dropDown.highlightLastOption();}}if(_880){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_87e[this.searchAttr].toString())){this._announceOption(this.dropDown.containerNode.firstChild.nextSibling);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _882=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_882==pw._messages["previousMessage"]||_882==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_882);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_883,_884){var _885="";if(item){if(!_884){_884=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_885=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_884;}this.set("value",_885,_883,_884,item);},_announceOption:function(node){if(!node){return;}var _886;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_886=node.innerHTML;this.item=undefined;this.value="";}else{var item=this.dropDown.items[node.getAttribute("item")];_886=(this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr]).toString();this.set("item",item,false,_886);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_86d.get(node,"id"));this._autoCompleteText(_886);},_selectOption:function(_887){this.closeDropDown();if(_887){this._announceOption(_887);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this.item=undefined;this.inherited(arguments);},_startSearch:function(key){if(!this.dropDown){var _888=this.id+"_popup",_889=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _889({onChange:lang.hitch(this,this._selectOption),id:_888,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_888);}this._lastInput=key;this.inherited(arguments);},_getValueField:function(){return this.searchAttr;},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _88a=this.srcNodeRef;this.store=new _872({},_88a);if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _88b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_88b):item[_88b];}}}},postCreate:function(){var _88c=_86f("label[for=\""+this.id+"\"]");if(_88c.length){if(!_88c[0].id){_88c[0].id=this.id+"_label";}this.domNode.setAttribute("aria-labelledby",_88c[0].id);}this.inherited(arguments);this.connect(this,"onSearch","_openResultList");},_getMenuLabelFromItem:function(item){var _88d=this.labelFunc(item,this.store),_88e=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_88d=this.doHighlight(_88d,this._lastInput);_88e="html";}return {html:_88e=="html",label:_88d};},doHighlight:function(_88f,find){var _890=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_870.escapeString(find);return this._escapeHtml(_88f.replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_890),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_891){return (_891._oldAPI?_891.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_892,_893,_894,item){this._set("item",item||null);if(_892==null){_892="";}this.inherited(arguments);},_setTextDirAttr:function(_895){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_895);}}});});},"esri/layers/TrackManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/graphic","esri/geometry/Polyline","esri/layers/GraphicsLayer"],function(_896,lang,_897,has,_898,_899,_89a,_89b){var _89c=_896(null,{declaredClass:"esri.layers._TrackManager",constructor:function(_89d){this.layer=_89d;this.trackMap={};},initialize:function(map){this.map=map;var _89e=this.layer,_89f=_89e.renderer.trackRenderer;if(_89f&&(_89e.geometryType==="esriGeometryPoint")){var _8a0=(this.container=new _89b._GraphicsLayer({id:_89e.id+"_tracks",_child:true}));_8a0.loaded=true;_8a0.onLoad(_8a0);_8a0._setMap(map,_89e._div);_8a0.setRenderer(_89f);}},addFeatures:function(_8a1){var tkid,_8a2=this.trackMap,_8a3=this.layer,_8a4=_8a3._trackIdField;_897.forEach(_8a1,function(_8a5){var _8a6=_8a5.attributes;tkid=_8a6[_8a4];var ary=(_8a2[tkid]=(_8a2[tkid]||[]));ary.push(_8a5);});var _8a7=_8a3._startTimeField,_8a8=_8a3.objectIdField;var _8a9=function(a,b){var _8aa=a.attributes[_8a7],_8ab=b.attributes[_8a7];if(_8aa===_8ab){return (a.attributes[_8a8]<b.attributes[_8a8])?-1:1;}else{return (_8aa<_8ab)?-1:1;}};for(tkid in _8a2){_8a2[tkid].sort(_8a9);}},drawTracks:function(){var _8ac=this.container;if(!_8ac){return;}var _8ad=this.trackMap,sr=this.map.spatialReference,tkid,ary,path,i,_8ae,_8af=this.layer._trackIdField,_8b0;for(tkid in _8ad){ary=_8ad[tkid];path=[];for(i=ary.length-1;i>=0;i--){_8ae=ary[i].geometry;if(_8ae){path.push([_8ae.x,_8ae.y]);}}_8b0={};_8b0[_8af]=tkid;if(path.length>0){_8ac.add(new _899(new _89a({paths:[path],spatialReference:sr}),null,_8b0));}}},moveLatestToFront:function(){_897.forEach(this.getLatestObservations(),function(_8b1){var _8b2=_8b1._shape;_8b2&&_8b2._moveToFront();this._repaint(_8b1,null,true);},this.layer);},getLatestObservations:function(){var _8b3=[];if(!this.layer.renderer.latestObservationRenderer){return _8b3;}var _8b4=this.trackMap,tkid;for(tkid in _8b4){var ary=_8b4[tkid];_8b3.push(ary[ary.length-1]);}return _8b3;},clearTracks:function(){var _8b5=this.getLatestObservations();this.trackMap={};var _8b6=this.container;if(_8b6){_8b6.clear();}_897.forEach(_8b5,function(_8b7){this._repaint(_8b7,null,true);},this.layer);},isLatestObservation:function(_8b8){var _8b9=this.layer._trackIdField;var _8ba=this.trackMap[_8b8.attributes[_8b9]];if(_8ba){return (_8ba[_8ba.length-1]===_8b8);}return false;},destroy:function(){var _8bb=this.container;if(_8bb){_8bb.clear();_8bb._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});if(has("extend-esri")){lang.setObject("layers._TrackManager",_89c,_898);}return _89c;});},"esri/dijit/editing/tools/ToolBase":function(){define("esri/dijit/editing/tools/ToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","dojo/i18n!esri/nls/jsapi"],function(_8bc,lang,has,_8bd,_8be){var _8bf=_8bc(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:true,showLabel:false,constructor:function(_8c0,_8c1){_8c0=_8c0||{};lang.mixin(this,_8c0);this.label=this._label?_8be.widgets.editor.tools[this._label]:"";this._settings=_8c0.settings;this._toolbar=_8c0.settings.drawToolbar;this._editToolbar=_8c0.settings.editToolbar;this._initializeTool();},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments);},destroy:function(){},activate:function(_8c2){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}if(!this._enabled){return;}this._checked=true;this._layer=_8c2;if(this._toolbar&&this._drawType){this._toolbar.activate(this._drawType);}},deactivate:function(){if(this._toolbar){this._toolbar.deactivate();}if(this._editToolbar){this._editToolbar.deactivate();}this.setChecked(false);this._updateUI();},setEnabled:function(_8c3){this._enabled=_8c3;this._updateUI();},setChecked:function(_8c4){this._checked=_8c4;},enable:function(_8c5){this._updateUI();},isEnabled:function(){return this._enabled;},getToolName:function(){return this._toolName;},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ToolBase",_8bf,_8bd);}return _8bf;});},"esri/dijit/editing/tools/MenuItemBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/MenuItem","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_8c6,lang,has,_8c7,_8c8,_8c9){var MIB=_8c6([_8c7,_8c8],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",destroy:function(){_8c7.prototype.destroy.apply(this,arguments);_8c8.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.MenuItemBase",MIB,_8c9);}return MIB;});},"dojox/date/islamic":function(){define("dojox/date/islamic",["..","dojo/_base/lang","dojo/date","./islamic/Date"],function(_8ca,lang,dd,_8cb){var _8cc=lang.getObject("date.islamic",true,_8ca);_8cc.getDaysInMonth=function(_8cd){return _8cd.getDaysInIslamicMonth(_8cd.getMonth(),_8cd.getFullYear());};_8cc.compare=function(_8ce,_8cf,_8d0){if(_8ce instanceof _8cb){_8ce=_8ce.toGregorian();}if(_8cf instanceof _8cb){_8cf=_8cf.toGregorian();}return dd.compare.apply(null,arguments);};_8cc.add=function(date,_8d1,_8d2){var _8d3=new _8cb(date);switch(_8d1){case "day":_8d3.setDate(date.getDate()+_8d2);break;case "weekday":var day=date.getDay();if(((day+_8d2)<5)&&((day+_8d2)>0)){_8d3.setDate(date.getDate()+_8d2);}else{var _8d4=0,_8d5=0;if(day==5){day=4;_8d5=(_8d2>0)?-1:1;}else{if(day==6){day=4;_8d5=(_8d2>0)?-2:2;}}var add=(_8d2>0)?(5-day-1):-day;var _8d6=_8d2-add;var div=parseInt(_8d6/5);if(_8d6%5!=0){_8d4=(_8d2>0)?2:-2;}_8d4=_8d4+div*7+_8d6%5+add;_8d3.setDate(date.getDate()+_8d4+_8d5);}break;case "year":_8d3.setFullYear(date.getFullYear()+_8d2);break;case "week":_8d2*=7;_8d3.setDate(date.getDate()+_8d2);break;case "month":var _8d7=date.getMonth();_8d3.setMonth(_8d7+_8d2);break;case "hour":_8d3.setHours(date.getHours()+_8d2);break;case "minute":_8d3._addMinutes(_8d2);break;case "second":_8d3._addSeconds(_8d2);break;case "millisecond":_8d3._addMilliseconds(_8d2);break;}return _8d3;};_8cc.difference=function(_8d8,_8d9,_8da){_8d9=_8d9||new _8cb();_8da=_8da||"day";var _8db=_8d9.getFullYear()-_8d8.getFullYear();var _8dc=1;switch(_8da){case "weekday":var days=Math.round(_8cc.difference(_8d8,_8d9,"day"));var _8dd=parseInt(_8cc.difference(_8d8,_8d9,"week"));var mod=days%7;if(mod==0){days=_8dd*5;}else{var adj=0;var aDay=_8d8.getDay();var bDay=_8d9.getDay();_8dd=parseInt(days/7);mod=days%7;var _8de=new _8cb(_8d8);_8de.setDate(_8de.getDate()+(_8dd*7));var _8df=_8de.getDay();if(days>0){switch(true){case aDay==5:adj=-1;break;case aDay==6:adj=0;break;case bDay==5:adj=-1;break;case bDay==6:adj=-2;break;case (_8df+mod)>5:adj=-2;}}else{if(days<0){switch(true){case aDay==5:adj=0;break;case aDay==6:adj=1;break;case bDay==5:adj=2;break;case bDay==6:adj=1;break;case (_8df+mod)<0:adj=2;}}}days+=adj;days-=(_8dd*2);}_8dc=days;break;case "year":_8dc=_8db;break;case "month":var _8e0=(_8d9.toGregorian()>_8d8.toGregorian())?_8d9:_8d8;var _8e1=(_8d9.toGregorian()>_8d8.toGregorian())?_8d8:_8d9;var _8e2=_8e0.getMonth();var _8e3=_8e1.getMonth();if(_8db==0){_8dc=_8e0.getMonth()-_8e1.getMonth();}else{_8dc=12-_8e3;_8dc+=_8e2;var i=_8e1.getFullYear()+1;var e=_8e0.getFullYear();for(i;i<e;i++){_8dc+=12;}}if(_8d9.toGregorian()<_8d8.toGregorian()){_8dc=-_8dc;}break;case "week":_8dc=parseInt(_8cc.difference(_8d8,_8d9,"day")/7);break;case "day":_8dc/=24;case "hour":_8dc/=60;case "minute":_8dc/=60;case "second":_8dc/=1000;case "millisecond":_8dc*=_8d9.toGregorian().getTime()-_8d8.toGregorian().getTime();}return Math.round(_8dc);};return _8cc;});},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(dojo,_8e4,_8e5){dojo.DeferredList=function(list,_8e6,_8e7,_8e8,_8e9){var _8ea=[];_8e4.call(this);var self=this;if(list.length===0&&!_8e6){this.resolve([0,[]]);}var _8eb=0;_8e5.forEach(list,function(item,i){item.then(function(_8ec){if(_8e6){self.resolve([i,_8ec]);}else{_8ed(true,_8ec);}},function(_8ee){if(_8e7){self.reject(_8ee);}else{_8ed(false,_8ee);}if(_8e8){return null;}throw _8ee;});function _8ed(_8ef,_8f0){_8ea[i]=[_8ef,_8f0];_8eb++;if(_8eb===list.length){self.resolve(_8ea);}};});};dojo.DeferredList.prototype=new _8e4();dojo.DeferredList.prototype.gatherResults=function(_8f1){var d=new dojo.DeferredList(_8f1,false,true,false);d.addCallback(function(_8f2){var ret=[];_8e5.forEach(_8f2,function(_8f3){ret.push(_8f3[1]);});return ret;});return d;};return dojo.DeferredList;});},"dijit/CheckedMenuItem":function(){require({cache:{"url:dijit/templates/CheckedMenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemcheckbox\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>\n"}});define("dijit/CheckedMenuItem",["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(_8f4,_8f5,_8f6,_8f7){return _8f4("dijit.CheckedMenuItem",_8f6,{templateString:_8f7,checked:false,_setCheckedAttr:function(_8f8){_8f5.toggle(this.domNode,"dijitCheckedMenuItemChecked",_8f8);this.domNode.setAttribute("aria-checked",_8f8?"true":"false");this._set("checked",_8f8);},iconClass:"",onChange:function(){},_onClick:function(evt){if(!this.disabled){this.set("checked",!this.checked);this.onChange(this.checked);}this.onClick(evt);}});});},"dijit/Menu":function(){define("dijit/Menu",["require","dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/dom","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","dojo/window","./popup","./DropDownMenu","dojo/ready"],function(_8f9,_8fa,_8fb,_8fc,dom,_8fd,_8fe,_8ff,keys,lang,on,has,win,_900,pm,_901,_902){if(has("dijit-legacy-requires")){_902(0,function(){var _903=["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"];_8f9(_903);});}return _8fb("dijit.Menu",_901,{constructor:function(){this._bindings=[];},targetNodeIds:[],selector:"",contextMenuForWindow:false,leftClickToOpen:false,refocus:true,postCreate:function(){if(this.contextMenuForWindow){this.bindDomNode(this.ownerDocumentBody);}else{_8fa.forEach(this.targetNodeIds,this.bindDomNode,this);}this.inherited(arguments);},_iframeContentWindow:function(_904){return _900.get(this._iframeContentDocument(_904))||this._iframeContentDocument(_904)["__parent__"]||(_904.name&&win.doc.frames[_904.name])||null;},_iframeContentDocument:function(_905){return _905.contentDocument||(_905.contentWindow&&_905.contentWindow.document)||(_905.name&&win.doc.frames[_905.name]&&win.doc.frames[_905.name].document)||null;},bindDomNode:function(node){node=dom.byId(node,this.ownerDocument);var cn;if(node.tagName.toLowerCase()=="iframe"){var _906=node,_907=this._iframeContentWindow(_906);cn=win.body(_907.document);}else{cn=(node==win.body(this.ownerDocument)?this.ownerDocument.documentElement:node);}var _908={node:node,iframe:_906};_8fd.set(node,"_dijitMenu"+this.id,this._bindings.push(_908));var _909=lang.hitch(this,function(cn){var _90a=this.selector,_90b=_90a?function(_90c){return on.selector(_90a,_90c);}:function(_90d){return _90d;},self=this;return [on(cn,_90b(this.leftClickToOpen?"click":"contextmenu"),function(evt){_8fc.stop(evt);self._scheduleOpen(this,_906,{x:evt.pageX,y:evt.pageY});}),on(cn,_90b("keydown"),function(evt){if(evt.shiftKey&&evt.keyCode==keys.F10){_8fc.stop(evt);self._scheduleOpen(this,_906);}})];});_908.connects=cn?_909(cn):[];if(_906){_908.onloadHandler=lang.hitch(this,function(){var _90e=this._iframeContentWindow(_906);cn=win.body(_90e.document);_908.connects=_909(cn);});if(_906.addEventListener){_906.addEventListener("load",_908.onloadHandler,false);}else{_906.attachEvent("onload",_908.onloadHandler);}}},unBindDomNode:function(_90f){var node;try{node=dom.byId(_90f,this.ownerDocument);}catch(e){return;}var _910="_dijitMenu"+this.id;if(node&&_8fd.has(node,_910)){var bid=_8fd.get(node,_910)-1,b=this._bindings[bid],h;while((h=b.connects.pop())){h.remove();}var _911=b.iframe;if(_911){if(_911.removeEventListener){_911.removeEventListener("load",b.onloadHandler,false);}else{_911.detachEvent("onload",b.onloadHandler);}}_8fd.remove(node,_910);delete this._bindings[bid];}},_scheduleOpen:function(_912,_913,_914){if(!this._openTimer){this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:_912,iframe:_913,coords:_914});},1);}},_openMyself:function(args){var _915=args.target,_916=args.iframe,_917=args.coords;this.currentTarget=_915;if(_917){if(_916){var ifc=_8fe.position(_916,true),_918=this._iframeContentWindow(_916),_919=_8fe.docScroll(_918.document);var cs=_8ff.getComputedStyle(_916),tp=_8ff.toPixelValue,left=(has("ie")&&has("quirks")?0:tp(_916,cs.paddingLeft))+(has("ie")&&has("quirks")?tp(_916,cs.borderLeftWidth):0),top=(has("ie")&&has("quirks")?0:tp(_916,cs.paddingTop))+(has("ie")&&has("quirks")?tp(_916,cs.borderTopWidth):0);_917.x+=ifc.x+left-_919.x;_917.y+=ifc.y+top-_919.y;}}else{_917=_8fe.position(_915,true);_917.x+=10;_917.y+=10;}var self=this;var _91a=this._focusManager.get("prevNode");var _91b=this._focusManager.get("curNode");var _91c=!_91b||(dom.isDescendant(_91b,this.domNode))?_91a:_91b;function _91d(){if(self.refocus&&_91c){_91c.focus();}pm.close(self);};pm.open({popup:this,x:_917.x,y:_917.y,onExecute:_91d,onCancel:_91d,orient:this.isLeftToRight()?"L":"R"});this.focus();this._onBlur=function(){this.inherited("_onBlur",arguments);pm.close(this);};},destroy:function(){_8fa.forEach(this._bindings,function(b){if(b){this.unBindDomNode(b.node);}},this);this.inherited(arguments);}});});},"esri/layers/GridLayout":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/SpatialReference","esri/geometry/Extent","esri/geometry/Polyline"],function(_91e,lang,_91f,has,_920,_921,_922,_923){var _924=_91e(null,{declaredClass:"esri.layers._GridLayout",constructor:function(_925,_926,_927,_928){this.origin=_925;this.cellWidth=_926.width;this.cellHeight=_926.height;this.mapWidth=_927.width;this.mapHeight=_927.height;this.srInfo=_928;},setResolution:function(_929){this._resolution=(_929.xmax-_929.xmin)/this.mapWidth;if(this.srInfo){var _92a=Math.round((2*this.srInfo.valid[1])/this._resolution),_92b=Math.round(_92a/this.cellWidth);this._frameStats=[_92b,0,_92b-1];}},getCellCoordinates:function(_92c){var res=this._resolution,_92d=this.origin;return {row:Math.floor((_92d.y-_92c.y)/(this.cellHeight*res)),col:Math.floor((_92c.x-_92d.x)/(this.cellWidth*res))};},normalize:function(col){var _92e=this._frameStats;if(_92e){var _92f=_92e[0],m180=_92e[1],p180=_92e[2];if(col<m180){col=col%_92f;col=col<m180?col+_92f:col;}else{if(col>p180){col=col%_92f;}}}return col;},intersects:function(_930,_931){var _932=this.srInfo;if(_932){return _91f.some(_931._getParts(_932),function(_933){return _930.intersects(_933.extent);});}else{return _930.intersects(_931);}},getCellExtent:function(row,col){var res=this._resolution,_934=this.origin,_935=this.cellWidth,_936=this.cellHeight;return new _922((col*_935*res)+_934.x,_934.y-((row+1)*_936*res),((col+1)*_935*res)+_934.x,_934.y-(row*_936*res),new _921(_934.spatialReference.toJson()));},getLatticeID:function(_937){var _938=this.getCellCoordinates({x:_937.xmin,y:_937.ymax}),_939=this.getCellCoordinates({x:_937.xmax,y:_937.ymin}),_93a=_938.row,_93b=_939.row,_93c=this.normalize(_938.col),_93d=this.normalize(_939.col);return _93a+"_"+_93b+"_"+_93c+"_"+_93d;},sorter:function(a,b){return (a<b)?-1:1;},getCellsInExtent:function(_93e,_93f){var _940=this.getCellCoordinates({x:_93e.xmin,y:_93e.ymax}),_941=this.getCellCoordinates({x:_93e.xmax,y:_93e.ymin}),_942=_940.row,_943=_941.row,_944=_940.col,_945=_941.col,_946=[],i,j,nj,_947=[],_948=[],len,xmin,xmax,ymin,ymax,_949=[],_94a,_94b;for(i=_942;i<=_943;i++){for(j=_944;j<=_945;j++){nj=this.normalize(j);_93e=this.getCellExtent(i,nj);_946.push({row:i,col:nj,extent:_93e,resolution:this._resolution});if(_93f){_947.push(_93e.xmin,_93e.xmax);_948.push(_93e.ymin,_93e.ymax);}}}_944=this.normalize(_944);_945=this.normalize(_945);_947.sort(this.sorter);_948.sort(this.sorter);len=_947.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_947[i]===_947[i+1]){_947.splice(i,1);}}}len=_948.length;for(i=len-1;i>=0;i--){if(i<(len-1)){if(_948[i]===_948[i+1]){_948.splice(i,1);}}}if(_947.length&&_948.length){xmin=_947[0];xmax=_947[_947.length-1];ymin=_948[0];ymax=_948[_948.length-1];len=_947.length;for(i=0;i<len;i++){_949.push([[_947[i],ymax],[_947[i],ymin]]);}len=_948.length;for(i=0;i<len;i++){_949.push([[xmin,_948[i]],[xmax,_948[i]]]);}_94a=new _923({paths:_949,spatialReference:this.origin.spatialReference.toJson()});_94b=_942+"_"+_943+"_"+_944+"_"+_945;_946.push({latticeID:_94b,lattice:_94a,resolution:this._resolution});}return {minRow:_942,maxRow:_943,minCol:_944,maxCol:_945,cells:_946};}});if(has("extend-esri")){lang.setObject("layers._GridLayout",_924,_920);}return _924;});},"dojo/dnd/Container":function(){define(["../_base/array","../_base/declare","../_base/event","../_base/kernel","../_base/lang","../_base/window","../dom","../dom-class","../dom-construct","../Evented","../has","../on","../query","../ready","../touch","./common"],function(_94c,_94d,_94e,_94f,lang,win,dom,_950,_951,_952,has,on,_953,_954,_955,dnd){var _956=_94d("dojo.dnd.Container",_952,{skipForm:false,allowNested:false,constructor:function(node,_957){this.node=dom.byId(node);if(!_957){_957={};}this.creator=_957.creator||null;this.skipForm=_957.skipForm;this.parent=_957.dropParent&&dom.byId(_957.dropParent);this.map={};this.current=null;this.containerState="";_950.add(this.node,"dojoDndContainer");if(!(_957&&_957._skipStartup)){this.startup();}this.events=[on(this.node,_955.over,lang.hitch(this,"onMouseOver")),on(this.node,_955.out,lang.hitch(this,"onMouseOut")),on(this.node,"dragstart",lang.hitch(this,"onSelectStart")),on(this.node,"selectstart",lang.hitch(this,"onSelectStart"))];},creator:function(){},getItem:function(key){return this.map[key];},setItem:function(key,data){this.map[key]=data;},delItem:function(key){delete this.map[key];},forInItems:function(f,o){o=o||_94f.global;var m=this.map,e=dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _953((this.allowNested?"":"> ")+".dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(node){if(node.id){var item=this.getItem(node.id);if(item){map[node.id]=item;return;}}else{node.id=dnd.getUniqueId();}var type=node.getAttribute("dndType"),data=node.getAttribute("dndData");map[node.id]={data:data||node.innerHTML,type:type?type.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(data,_958,_959){if(!this.parent.firstChild){_959=null;}else{if(_958){if(!_959){_959=this.parent.firstChild;}}else{if(_959){_959=_959.nextSibling;}}}var i,t;if(_959){for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});_959.parentNode.insertBefore(t.node,_959);}}else{for(i=0;i<data.length;++i){t=this._normalizedCreator(data[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_94c.forEach(this.events,function(_95a){_95a.remove();});this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_95b,node,Ctor){_95b._skipStartup=true;return new Ctor(node,_95b);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!dnd.isFormElement(e)){_94e.stop(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(type,_95c){var _95d="dojoDnd"+type;var _95e=type.toLowerCase()+"State";_950.replace(this.node,_95d+_95c,_95d+this[_95e]);this[_95e]=_95c;},_addItemClass:function(node,type){_950.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_950.remove(node,"dojoDndItem"+type);},_getChildByEvent:function(e){var node=e.target;if(node){for(var _95f=node.parentNode;_95f;node=_95f,_95f=node.parentNode){if((_95f==this.parent||this.allowNested)&&_950.contains(node,"dojoDndItem")){return node;}}}return null;},_normalizedCreator:function(item,hint){var t=(this.creator||this.defaultCreator).call(this,item,hint);if(!lang.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=dnd.getUniqueId();}_950.add(t.node,"dojoDndItem");return t;}});dnd._createNode=function(tag){if(!tag){return dnd._createSpan;}return function(text){return _951.create(tag,{innerHTML:text});};};dnd._createTrTd=function(text){var tr=_951.create("tr");_951.create("td",{innerHTML:text},tr);return tr;};dnd._createSpan=function(text){return _951.create("span",{innerHTML:text});};dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};dnd._defaultCreator=function(node){var tag=node.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?dnd._createTrTd:dnd._createNode(dnd._defaultCreatorNodes[tag]);return function(item,hint){var _960=item&&lang.isObject(item),data,type,n;if(_960&&item.tagName&&item.nodeType&&item.getAttribute){data=item.getAttribute("dndData")||item.innerHTML;type=item.getAttribute("dndType");type=type?type.split(/\s*,\s*/):["text"];n=item;}else{data=(_960&&item.data)?item.data:item;type=(_960&&item.type)?item.type:["text"];n=(hint=="avatar"?dnd._createSpan:c)(String(data));}if(!n.id){n.id=dnd.getUniqueId();}return {node:n,data:data,type:type};};};return _956;});},"dojox/grid/_ViewManager":function(){define("dojox/grid/_ViewManager",["dojo/_base/declare","dojo/_base/sniff","dojo/dom-class"],function(_961,has,_962){return _961("dojox.grid._ViewManager",null,{constructor:function(_963){this.grid=_963;},defaultWidth:200,views:[],resize:function(){this.onEach("resize");},render:function(){this.onEach("render");},addView:function(_964){_964.idx=this.views.length;this.views.push(_964);},destroyViews:function(){for(var i=0,v;v=this.views[i];i++){v.destroy();}this.views=[];},getContentNodes:function(){var _965=[];for(var i=0,v;v=this.views[i];i++){_965.push(v.contentNode);}return _965;},forEach:function(_966){for(var i=0,v;v=this.views[i];i++){_966(v,i);}},onEach:function(_967,_968){_968=_968||[];for(var i=0,v;v=this.views[i];i++){if(_967 in v){v[_967].apply(v,_968);}}},normalizeHeaderNodeHeight:function(){var _969=[];for(var i=0,v;(v=this.views[i]);i++){if(v.headerContentNode.firstChild){_969.push(v.headerContentNode);}}this.normalizeRowNodeHeights(_969);},normalizeRowNodeHeights:function(_96a){var h=0;var _96b=[];if(this.grid.rowHeight){h=this.grid.rowHeight;}else{if(_96a.length<=1){return;}for(var i=0,n;(n=_96a[i]);i++){if(!_962.contains(n,"dojoxGridNonNormalizedCell")){_96b[i]=n.firstChild.offsetHeight;h=Math.max(h,_96b[i]);}}h=(h>=0?h:0);if((has("mozilla")||has("ie")>8)&&h){h++;}}for(i=0;(n=_96a[i]);i++){if(_96b[i]!=h){n.firstChild.style.height=h+"px";}}},resetHeaderNodeHeight:function(){for(var i=0,v,n;(v=this.views[i]);i++){n=v.headerContentNode.firstChild;if(n){n.style.height="";}}},renormalizeRow:function(_96c){var _96d=[];for(var i=0,v,n;(v=this.views[i])&&(n=v.getRowNode(_96c));i++){n.firstChild.style.height="";_96d.push(n);}this.normalizeRowNodeHeights(_96d);},getViewWidth:function(_96e){return this.views[_96e].getWidth()||this.defaultWidth;},measureHeader:function(){this.resetHeaderNodeHeight();this.forEach(function(_96f){_96f.headerContentNode.style.height="";});var h=0;this.forEach(function(_970){h=Math.max(_970.headerNode.offsetHeight,h);});return h;},measureContent:function(){var h=0;this.forEach(function(_971){h=Math.max(_971.domNode.offsetHeight,h);});return h;},findClient:function(_972){var c=this.grid.elasticView||-1;if(c<0){for(var i=1,v;(v=this.views[i]);i++){if(v.viewWidth){for(i=1;(v=this.views[i]);i++){if(!v.viewWidth){c=i;break;}}break;}}}if(c<0){c=Math.floor(this.views.length/2);}return c;},arrange:function(l,w){var i,v,vw,len=this.views.length,self=this;var c=(w<=0?len:this.findClient());var _973=function(v,l){var ds=v.domNode.style;var hs=v.headerNode.style;if(!self.grid.isLeftToRight()){ds.right=l+"px";if(has("ff")<4){hs.right=l+v.getScrollbarWidth()+"px";}else{hs.right=l+"px";}if(!has("webkit")){hs.width=parseInt(hs.width,10)-v.getScrollbarWidth()+"px";}}else{ds.left=l+"px";hs.left=l+"px";}ds.top=0+"px";hs.top=0;};for(i=0;(v=this.views[i])&&(i<c);i++){vw=this.getViewWidth(i);v.setSize(vw,0);_973(v,l);if(v.headerContentNode&&v.headerContentNode.firstChild){vw=v.getColumnsWidth()+v.getScrollbarWidth();}else{vw=v.domNode.offsetWidth;}l+=vw;}i++;var r=w;for(var j=len-1;(v=this.views[j])&&(i<=j);j--){vw=this.getViewWidth(j);v.setSize(vw,0);vw=v.domNode.offsetWidth;r-=vw;_973(v,r);}if(c<len){v=this.views[c];vw=Math.max(1,r-l);v.setSize(vw+"px",0);_973(v,l);}return l;},renderRow:function(_974,_975,_976){var _977=[];for(var i=0,v,n,_978;(v=this.views[i])&&(n=_975[i]);i++){_978=v.renderRow(_974);n.appendChild(_978);_977.push(_978);}if(!_976){this.normalizeRowNodeHeights(_977);}},rowRemoved:function(_979){this.onEach("rowRemoved",[_979]);},updateRow:function(_97a,_97b){for(var i=0,v;v=this.views[i];i++){v.updateRow(_97a);}if(!_97b){this.renormalizeRow(_97a);}},updateRowStyles:function(_97c){this.onEach("updateRowStyles",[_97c]);},setScrollTop:function(_97d){var top=_97d;for(var i=0,v;v=this.views[i];i++){top=v.setScrollTop(_97d);if(has("ie")&&v.headerNode&&v.scrollboxNode){v.headerNode.scrollLeft=v.scrollboxNode.scrollLeft;}}return top;},getFirstScrollingView:function(){for(var i=0,v;(v=this.views[i]);i++){if(v.hasHScrollbar()||v.hasVScrollbar()){return v;}}return null;}});});},"esri/dijit/editing/Union":function(){define("esri/dijit/editing/Union",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Cut"],function(_97e,lang,has,_97f,_980,Cut){var _981=_97e(_980,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(_982){_982=_982||{};this._cut=new Cut({featureLayer:_982.featureLayer,addedGraphics:_982.deletedGraphics,preUpdatedGraphics:_982.preUpdatedGraphics,postUpdatedGraphics:_982.postUpdatedGraphics});},performUndo:function(){this._cut.performRedo();},performRedo:function(){this._cut.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Union",_981,_97f);}return _981;});},"dijit/form/NumberTextBox":function(){define("dijit/form/NumberTextBox",["dojo/_base/declare","dojo/_base/lang","dojo/number","./RangeBoundTextBox"],function(_983,lang,_984,_985){var _986=_983("dijit.form.NumberTextBoxMixin",null,{pattern:_984.regexp,value:NaN,editOptions:{pattern:"#.######"},_formatter:_984.format,postMixInProperties:function(){this.inherited(arguments);this._set("type","text");},_setConstraintsAttr:function(_987){var _988=typeof _987.places=="number"?_987.places:0;if(_988){_988++;}if(typeof _987.max!="number"){_987.max=9*Math.pow(10,15-_988);}if(typeof _987.min!="number"){_987.min=-9*Math.pow(10,15-_988);}this.inherited(arguments,[_987]);if(this.focusNode&&this.focusNode.value&&!isNaN(this.value)){this.set("value",this.value);}},_onFocus:function(){if(this.disabled){return;}var val=this.get("value");if(typeof val=="number"&&!isNaN(val)){var _989=this.format(val,this.constraints);if(_989!==undefined){this.textbox.value=_989;}}this.inherited(arguments);},format:function(_98a,_98b){var _98c=String(_98a);if(typeof _98a!="number"){return _98c;}if(isNaN(_98a)){return "";}if(!("rangeCheck" in this&&this.rangeCheck(_98a,_98b))&&_98b.exponent!==false&&/\de[-+]?\d/i.test(_98c)){return _98c;}if(this.editOptions&&this.focused){_98b=lang.mixin({},_98b,this.editOptions);}return this._formatter(_98a,_98b);},_parser:_984.parse,parse:function(_98d,_98e){var v=this._parser(_98d,lang.mixin({},_98e,(this.editOptions&&this.focused)?this.editOptions:{}));if(this.editOptions&&this.focused&&isNaN(v)){v=this._parser(_98d,_98e);}return v;},_getDisplayedValueAttr:function(){var v=this.inherited(arguments);return isNaN(v)?this.textbox.value:v;},filter:function(_98f){return (_98f==null||_98f==="")?NaN:this.inherited(arguments);},serialize:function(_990,_991){return (typeof _990!="number"||isNaN(_990))?"":this.inherited(arguments);},_setBlurValue:function(){var val=lang.hitch(lang.mixin({},this,{focused:true}),"get")("value");this._setValueAttr(val,true);},_setValueAttr:function(_992,_993,_994){if(_992!==undefined&&_994===undefined){_994=String(_992);if(typeof _992=="number"){if(isNaN(_992)){_994="";}else{if(("rangeCheck" in this&&this.rangeCheck(_992,this.constraints))||this.constraints.exponent===false||!/\de[-+]?\d/i.test(_994)){_994=undefined;}}}else{if(!_992){_994="";_992=NaN;}else{_992=undefined;}}}this.inherited(arguments,[_992,_993,_994]);},_getValueAttr:function(){var v=this.inherited(arguments);if(isNaN(v)&&this.textbox.value!==""){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+_984._realNumberRegexp(lang.mixin({},this.constraints))+"$").test(this.textbox.value))){var n=Number(this.textbox.value);return isNaN(n)?undefined:n;}else{return undefined;}}else{return v;}},isValid:function(_995){if(!this.focused||this._isEmpty(this.textbox.value)){return this.inherited(arguments);}else{var v=this.get("value");if(!isNaN(v)&&this.rangeCheck(v,this.constraints)){if(this.constraints.exponent!==false&&/\de[-+]?\d/i.test(this.textbox.value)){return true;}else{return this.inherited(arguments);}}else{return false;}}}});var _996=_983("dijit.form.NumberTextBox",[_985,_986],{baseClass:"dijitTextBox dijitNumberTextBox"});_996.Mixin=_986;return _996;});},"dijit/DropDownMenu":function(){require({cache:{"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n"}});define("dijit/DropDownMenu",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/text!./templates/Menu.html","./_OnDijitClickMixin","./_MenuBase"],function(_997,_998,keys,_999,_99a,_99b){return _997("dijit.DropDownMenu",[_99b,_99a],{templateString:_999,baseClass:"dijitMenu",postCreate:function(){this.inherited(arguments);var l=this.isLeftToRight();this._openSubMenuKey=l?keys.RIGHT_ARROW:keys.LEFT_ARROW;this._closeSubMenuKey=l?keys.LEFT_ARROW:keys.RIGHT_ARROW;this.connectKeyNavHandlers([keys.UP_ARROW],[keys.DOWN_ARROW]);},_onKeyPress:function(evt){if(evt.ctrlKey||evt.altKey){return;}switch(evt.charOrCode){case this._openSubMenuKey:this._moveToPopup(evt);_998.stop(evt);break;case this._closeSubMenuKey:if(this.parentMenu){if(this.parentMenu._isMenuBar){this.parentMenu.focusPrev();}else{this.onCancel(false);}}else{_998.stop(evt);}break;}}});});},"dojox/grid/cells":function(){define("dojox/grid/cells",["../main","./cells/_base"],function(_99c){return _99c.grid.cells;});},"esri/dijit/editing/tools/Editing":function(){define("esri/dijit/editing/tools/Editing",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","esri/layers/FeatureTemplate","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/EditingTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel","esri/lang"],function(_99d,lang,_99e,has,_99f,Edit,_9a0,_9a1,_9a2,_9a3){var _9a4=_99d([_9a1],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:false,deactivate:function(){if(!this._enabled){return;}this._enabled=false;this.inherited(arguments);this._settings.templatePicker.clearSelection();},onItemClicked:function(_9a5,evt){this.inherited(arguments);if(this._activeTool===this._tools.AUTOCOMPLETE){this._settings.editor._drawingTool=_99f.TOOL_AUTO_COMPLETE_POLYGON;}},_activateTool:function(_9a6,_9a7){var i;this.enable(_9a7);for(i in this._tools){if(this._tools.hasOwnProperty(i)){this.dropDown.removeChild(this._tools[i]);if(this._tools[i]._enabled===true){this.dropDown.addChild(this._tools[i]);}}}if(this._geometryType!==_9a7||this._activeTool._enabled===false){this._activeTool=this._tools[_9a6.toUpperCase()];}this._geometryType=_9a7;this._activeTool.activate();this._activeTool.setChecked(true);this._updateUI();},_initializeTool:function(_9a8){this.inherited(arguments);this._initializeTools();},_initializeTools:function(){var _9a9=this._settings.layers;var _9aa=this._settings.editor;var _9ab=false,line=false,poly=false;var _9ac=this._toolTypes=[];var _9ad;_99e.forEach(_9a9,function(_9ae){_9ad=_9ae.geometryType;_9ab=_9ab||_9ad==="esriGeometryPoint";line=line||_9ad==="esriGeometryPolyline";poly=poly||_9ad==="esriGeometryPolygon";_9ac=_9ac.concat(_99e.map(this._getTemplatesFromLayer(_9ae),lang.hitch(this,function(_9af){return _9aa._toDrawTool(_9af.drawingTool,_9ae);})));},this);var _9b0=this._settings.createOptions;if(_9ab){this._toolTypes.push("point");}if(line){this._toolTypes=this._toolTypes.concat(_9b0.polylineDrawTools);}if(poly){this._toolTypes=this._toolTypes.concat(_9b0.polygonDrawTools);}this._toolTypes=this._toUnique(this._toolTypes.concat(_9ac));},_toUnique:function(arr){var test={};return _99e.filter(arr,function(val){return test[val]?false:(test[val]=true);});},_getTemplatesFromLayer:function(_9b1){var _9b2=_9b1.templates||[];var _9b3=_9b1.types;_99e.forEach(_9b3,function(type){_9b2=_9b2.concat(type.templates);});return _99e.filter(_9b2,_9a3.isDefined);},_createTools:function(){_99e.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_9b4){var _9b5=lang.mixin(_9a0[_9b4],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked",_9a0[_9b4].id)});this._tools[_9b4.toUpperCase()]=new Edit(_9b5);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Editing",_9a4,_9a2);}return _9a4;});},"esri/dijit/editing/tools/ToggleToolBase":function(){define("esri/dijit/editing/tools/ToggleToolBase",["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/ToggleButton","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_9b6,lang,has,_9b7,_9b8,_9b9){var TTB=_9b6([_9b7,_9b8],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_9b7.prototype.destroy.apply(this,arguments);_9b8.prototype.destroy.apply(this,arguments);},setChecked:function(_9ba){_9b7.prototype.setChecked.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ToggleToolBase",TTB,_9b9);}return TTB;});},"dojox/date/islamic/Date":function(){define("dojox/date/islamic/Date",["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(lang,_9bb,dd){var _9bc=_9bb("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var len=arguments.length;if(!len){this.fromGregorian(new Date());}else{if(len==1){var arg0=arguments[0];if(typeof arg0=="number"){arg0=new Date(arg0);}if(arg0 instanceof Date){this.fromGregorian(arg0);}else{if(arg0==""){this._date=new Date("");}else{this._year=arg0._year;this._month=arg0._month;this._date=arg0._date;this._hours=arg0._hours;this._minutes=arg0._minutes;this._seconds=arg0._seconds;this._milliseconds=arg0._milliseconds;}}}else{if(len>=3){this._year+=arguments[0];this._month+=arguments[1];this._date+=arguments[2];this._hours+=arguments[3]||0;this._minutes+=arguments[4]||0;this._seconds+=arguments[5]||0;this._milliseconds+=arguments[6]||0;}}}},getDate:function(){return this._date;},getMonth:function(){return this._month;},getFullYear:function(){return this._year;},getDay:function(){return this.toGregorian().getDay();},getHours:function(){return this._hours;},getMinutes:function(){return this._minutes;},getSeconds:function(){return this._seconds;},getMilliseconds:function(){return this._milliseconds;},setDate:function(date){date=parseInt(date);if(date>0&&date<=this.getDaysInIslamicMonth(this._month,this._year)){this._date=date;}else{var _9bd;if(date>0){for(_9bd=this.getDaysInIslamicMonth(this._month,this._year);date>_9bd;date-=_9bd,_9bd=this.getDaysInIslamicMonth(this._month,this._year)){this._month++;if(this._month>=12){this._year++;this._month-=12;}}this._date=date;}else{for(_9bd=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1);date<=0;_9bd=this.getDaysInIslamicMonth((this._month-1)>=0?(this._month-1):11,((this._month-1)>=0)?this._year:this._year-1)){this._month--;if(this._month<0){this._year--;this._month+=12;}date+=_9bd;}this._date=date;}}return this;},setFullYear:function(year){this._year=+year;},setMonth:function(_9be){this._year+=Math.floor(_9be/12);if(_9be>0){this._month=Math.floor(_9be%12);}else{this._month=Math.floor(((_9be%12)+12)%12);}},setHours:function(){var _9bf=arguments.length;var _9c0=0;if(_9bf>=1){_9c0=parseInt(arguments[0]);}if(_9bf>=2){this._minutes=parseInt(arguments[1]);}if(_9bf>=3){this._seconds=parseInt(arguments[2]);}if(_9bf==4){this._milliseconds=parseInt(arguments[3]);}while(_9c0>=24){this._date++;var _9c1=this.getDaysInIslamicMonth(this._month,this._year);if(this._date>_9c1){this._month++;if(this._month>=12){this._year++;this._month-=12;}this._date-=_9c1;}_9c0-=24;}this._hours=_9c0;},_addMinutes:function(_9c2){_9c2+=this._minutes;this.setMinutes(_9c2);this.setHours(this._hours+parseInt(_9c2/60));return this;},_addSeconds:function(_9c3){_9c3+=this._seconds;this.setSeconds(_9c3);this._addMinutes(parseInt(_9c3/60));return this;},_addMilliseconds:function(_9c4){_9c4+=this._milliseconds;this.setMilliseconds(_9c4);this._addSeconds(parseInt(_9c4/1000));return this;},setMinutes:function(_9c5){this._minutes=_9c5%60;return this;},setSeconds:function(_9c6){this._seconds=_9c6%60;return this;},setMilliseconds:function(_9c7){this._milliseconds=_9c7%1000;return this;},toString:function(){if(isNaN(this._date)){return "Invalidate Date";}else{var x=new Date();x.setHours(this._hours);x.setMinutes(this._minutes);x.setSeconds(this._seconds);x.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+x.toTimeString();}},toGregorian:function(){var _9c8=this._year;var _9c9=this._month;var _9ca=this._date;var _9cb=_9ca+Math.ceil(29.5*_9c9)+(_9c8-1)*354+Math.floor((3+(11*_9c8))/30)+this._ISLAMIC_EPOCH-1;var wjd=Math.floor(_9cb-0.5)+0.5,_9cc=wjd-this._GREGORIAN_EPOCH,_9cd=Math.floor(_9cc/146097),dqc=this._mod(_9cc,146097),cent=Math.floor(dqc/36524),_9ce=this._mod(dqc,36524),quad=Math.floor(_9ce/1461),_9cf=this._mod(_9ce,1461),_9d0=Math.floor(_9cf/365),year=(_9cd*400)+(cent*100)+(quad*4)+_9d0;if(!(cent==4||_9d0==4)){year++;}var _9d1=this._GREGORIAN_EPOCH+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400);var _9d2=wjd-_9d1;var tjd=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((739/12)+((dd.isLeapYear(new Date(year,3,1))?-1:-2))+1);var _9d3=((wjd<tjd)?0:(dd.isLeapYear(new Date(year,3,1))?1:2));var _9d4=Math.floor((((_9d2+_9d3)*12)+373)/367);var tjd2=(this._GREGORIAN_EPOCH-1)+(365*(year-1))+Math.floor((year-1)/4)-(Math.floor((year-1)/100))+Math.floor((year-1)/400)+Math.floor((((367*_9d4)-362)/12)+((_9d4<=2)?0:(dd.isLeapYear(new Date(year,_9d4,1))?-1:-2))+1);var day=(wjd-tjd2)+1;var _9d5=new Date(year,(_9d4-1),day,this._hours,this._minutes,this._seconds,this._milliseconds);return _9d5;},fromGregorian:function(_9d6){var date=new Date(_9d6);var _9d7=date.getFullYear(),_9d8=date.getMonth(),gDay=date.getDate();var _9d9=(this._GREGORIAN_EPOCH-1)+(365*(_9d7-1))+Math.floor((_9d7-1)/4)+(-Math.floor((_9d7-1)/100))+Math.floor((_9d7-1)/400)+Math.floor((((367*(_9d8+1))-362)/12)+(((_9d8+1)<=2)?0:(dd.isLeapYear(date)?-1:-2))+gDay);_9d9=Math.floor(_9d9)+0.5;var days=_9d9-this._ISLAMIC_EPOCH;var _9da=Math.floor((30*days+10646)/10631);var _9db=Math.ceil((days-29-this._yearStart(_9da))/29.5);_9db=Math.min(_9db,11);var hDay=Math.ceil(days-this._monthStart(_9da,_9db))+1;this._date=hDay;this._month=_9db;this._year=_9da;this._hours=date.getHours();this._minutes=date.getMinutes();this._seconds=date.getSeconds();this._milliseconds=date.getMilliseconds();this._day=date.getDay();return this;},valueOf:function(){return this.toGregorian().valueOf();},_yearStart:function(year){return (year-1)*354+Math.floor((3+11*year)/30);},_monthStart:function(year,_9dc){return Math.ceil(29.5*_9dc)+(year-1)*354+Math.floor((3+11*year)/30);},_civilLeapYear:function(year){return (14+11*year)%30<11;},getDaysInIslamicMonth:function(_9dd,year){var _9de=0;_9de=29+((_9dd+1)%2);if(_9dd==11&&this._civilLeapYear(year)){_9de++;}return _9de;},_mod:function(a,b){return a-(b*Math.floor(a/b));}});_9bc.getDaysInIslamicMonth=function(_9df){return new _9bc().getDaysInIslamicMonth(_9df.getMonth(),_9df.getFullYear());};return _9bc;});},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel"],function(lang,_9e0,has,_9e1){var util={};util={findFeatures:function(ids,_9e2,_9e3){var _9e4=_9e2.objectIdField;var _9e5=_9e2.graphics;var _9e6=_9e0.filter(_9e5,function(_9e7){return _9e0.some(ids,function(id){return _9e7.attributes[_9e4]===id.objectId;});});if(_9e3){_9e3(_9e6);}else{return _9e6;}},getSelection:function(_9e8){var _9e9=[];_9e0.forEach(_9e8,function(_9ea){var _9eb=_9ea.getSelectedFeatures();_9e0.forEach(_9eb,function(_9ec){_9e9.push(_9ec);});});return _9e9;}};if(has("extend-esri")){lang.setObject("dijit.editing.Util.LayerHelper",util,_9e1);}return util;});},"dojox/grid/util":function(){define("dojox/grid/util",["../main","dojo/_base/lang","dojo/dom"],function(_9ed,lang,dom){var dgu=lang.getObject("grid.util",true,_9ed);dgu.na="...";dgu.rowIndexTag="gridRowIndex";dgu.gridViewTag="gridView";dgu.fire=function(ob,ev,args){var fn=ob&&ev&&ob[ev];return fn&&(args?fn.apply(ob,args):ob[ev]());};dgu.setStyleHeightPx=function(_9ee,_9ef){if(_9ef>=0){var s=_9ee.style;var v=_9ef+"px";if(_9ee&&s["height"]!=v){s["height"]=v;}}};dgu.mouseEvents=["mouseover","mouseout","mousedown","mouseup","click","dblclick","contextmenu"];dgu.keyEvents=["keyup","keydown","keypress"];dgu.funnelEvents=function(_9f0,_9f1,_9f2,_9f3){var evts=(_9f3?_9f3:dgu.mouseEvents.concat(dgu.keyEvents));for(var i=0,l=evts.length;i<l;i++){_9f1.connect(_9f0,"on"+evts[i],_9f2);}};dgu.removeNode=function(_9f4){_9f4=dom.byId(_9f4);_9f4&&_9f4.parentNode&&_9f4.parentNode.removeChild(_9f4);return _9f4;};dgu.arrayCompare=function(inA,inB){for(var i=0,l=inA.length;i<l;i++){if(inA[i]!=inB[i]){return false;}}return (inA.length==inB.length);};dgu.arrayInsert=function(_9f5,_9f6,_9f7){if(_9f5.length<=_9f6){_9f5[_9f6]=_9f7;}else{_9f5.splice(_9f6,0,_9f7);}};dgu.arrayRemove=function(_9f8,_9f9){_9f8.splice(_9f9,1);};dgu.arraySwap=function(_9fa,inI,inJ){var _9fb=_9fa[inI];_9fa[inI]=_9fa[inJ];_9fa[inJ]=_9fb;};return dgu;});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/on","dojo/window"],function(_9fc,on,_9fd){return _9fc("dijit.form._ListBase",null,{selected:null,_listConnect:function(_9fe,_9ff){var self=this;return self.own(on(self.containerNode,on.selector(function(_a00,_a01,_a02){return _a00.parentNode==_a02;},_9fe),function(evt){evt.preventDefault();self[_9ff](evt,this);}));},selectFirstNode:function(){var _a03=this.containerNode.firstChild;while(_a03&&_a03.style.display=="none"){_a03=_a03.nextSibling;}this._setSelectedAttr(_a03);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _a04=this.selected;if(!_a04){this.selectFirstNode();}else{var next=_a04.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _a05=this.selected;if(!_a05){this.selectLastNode();}else{var prev=_a05.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _a06=this.selected;if(_a06){this.onDeselect(_a06);this.selected=null;}if(node){this.selected=node;_9fd.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}}});});},"dojox/grid/DataGrid":function(){define("dojox/grid/DataGrid",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/json","dojo/_base/sniff","dojo/_base/declare","./_Grid","./DataSelection","dojo/_base/html"],function(_a07,_a08,lang,json,has,_a09,_a0a,_a0b,html){var _a0c=_a09("dojox.grid.DataGrid",_a0a,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:false,_isLoading:false,keepSelection:false,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments);},destroy:function(){this.selection.destroy();this.inherited(arguments);},createSelection:function(){this.selection=new _a0b(this);},get:function(_a0d,_a0e){if(_a0e&&this.field=="_item"&&!this.fields){return _a0e;}else{if(_a0e&&this.fields){var ret=[];var s=this.grid.store;_a08.forEach(this.fields,function(f){ret=ret.concat(s.getValues(_a0e,f));});return ret;}else{if(!_a0e&&typeof _a0d==="string"){return this.inherited(arguments);}}}return (!_a0e?this.defaultValue:(!this.field?this.value:(this.field=="_item"?_a0e:this.grid.store.getValue(_a0e,this.field))));},_checkUpdateStatus:function(){if(this.updateDelay>0){var _a0f=false;if(this._endUpdateDelay){clearTimeout(this._endUpdateDelay);delete this._endUpdateDelay;_a0f=true;}if(!this.updating){this.beginUpdate();_a0f=true;}if(_a0f){var _a10=this;this._endUpdateDelay=setTimeout(function(){delete _a10._endUpdateDelay;_a10.endUpdate();},this.updateDelay);}}},_onSet:function(item,_a11,_a12,_a13){this._checkUpdateStatus();var idx=this.getItemIndex(item);if(idx>-1){this.updateRow(idx);}},_createItem:function(item,_a14){var idty=this._hasIdentity?this.store.getIdentity(item):json.toJson(this.query)+":idx:"+_a14+":sort:"+json.toJson(this.getSortProps());var o=this._by_idty[idty]={idty:idty,item:item};return o;},_addItem:function(item,_a15,_a16){this._by_idx[_a15]=this._createItem(item,_a15);if(!_a16){this.updateRow(_a15);}},_onNew:function(item,_a17){this._checkUpdateStatus();var _a18=this.get("rowCount");this._addingItem=true;this.updateRowCount(_a18+1);this._addingItem=false;this._addItem(item,_a18);this.showMessage();},_onDelete:function(item){this._checkUpdateStatus();var idx=this._getItemIndex(item,true);if(idx>=0){this._pages=[];this._bop=-1;this._eop=-1;var o=this._by_idx[idx];this._by_idx.splice(idx,1);delete this._by_idty[o.idty];this.updateRowCount(this.get("rowCount")-1);if(this.get("rowCount")===0){this.showMessage(this.noDataMessage);}}if(this.selection.isSelected(idx)){this.selection.deselect(idx);this.selection.selected.splice(idx,1);}},_onRevert:function(){this._refresh();},setStore:function(_a19,_a1a,_a1b){if(this._requestsPending(0)){return;}this._setQuery(_a1a,_a1b);this._setStore(_a19);this._refresh(true);},setQuery:function(_a1c,_a1d){if(this._requestsPending(0)){return;}this._setQuery(_a1c,_a1d);this._refresh(true);},setItems:function(_a1e){this.items=_a1e;this._setStore(this.store);this._refresh(true);},_setQuery:function(_a1f,_a20){this.query=_a1f;this.queryOptions=_a20||this.queryOptions;},_setStore:function(_a21){if(this.store&&this._store_connects){_a08.forEach(this._store_connects,this.disconnect,this);}this.store=_a21;if(this.store){var f=this.store.getFeatures();var h=[];this._canEdit=!!f["dojo.data.api.Write"]&&!!f["dojo.data.api.Identity"];this._hasIdentity=!!f["dojo.data.api.Identity"];if(!!f["dojo.data.api.Notification"]&&!this.items){h.push(this.connect(this.store,"onSet","_onSet"));h.push(this.connect(this.store,"onNew","_onNew"));h.push(this.connect(this.store,"onDelete","_onDelete"));}if(this._canEdit){h.push(this.connect(this.store,"revert","_onRevert"));}this._store_connects=h;}},_onFetchBegin:function(size,req){if(!this.scroller){return;}if(this.rowCount!=size){if(req.isRender){this.scroller.init(size,this.keepRows,this.rowsPerPage);this.rowCount=size;this._setAutoHeightAttr(this.autoHeight,true);this._skipRowRenormalize=true;this.prerender();this._skipRowRenormalize=false;}else{this.updateRowCount(size);}}if(!size){this.views.render();this._resize();this.showMessage(this.noDataMessage);this.focus.initFocusView();}else{this.showMessage();}},_onFetchComplete:function(_a22,req){if(!this.scroller){return;}if(_a22&&_a22.length>0){_a08.forEach(_a22,function(item,idx){this._addItem(item,req.start+idx,true);},this);this.updateRows(req.start,_a22.length);if(req.isRender){this.setScrollTop(0);this.postrender();}else{if(this._lastScrollTop){this.setScrollTop(this._lastScrollTop);}}if(has("ie")){html.setSelectable(this.domNode,this.selectable);}}delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;}this._pending_requests[req.start]=false;},_onFetchError:function(err,req){console.log(err);delete this._lastScrollTop;if(!this._isLoaded){this._isLoading=false;this._isLoaded=true;this.showMessage(this.errorMessage);}this._pending_requests[req.start]=false;this.onFetchError(err,req);},onFetchError:function(err,req){},_fetch:function(_a23,_a24){_a23=_a23||0;if(this.store&&!this._pending_requests[_a23]){if(!this._isLoaded&&!this._isLoading){this._isLoading=true;this.showMessage(this.loadingMessage);}this._pending_requests[_a23]=true;try{if(this.items){var _a25=this.items;var _a26=this.store;this.rowsPerPage=_a25.length;var req={start:_a23,count:this.rowsPerPage,isRender:_a24};this._onFetchBegin(_a25.length,req);var _a27=0;_a08.forEach(_a25,function(i){if(!_a26.isItemLoaded(i)){_a27++;}});if(_a27===0){this._onFetchComplete(_a25,req);}else{var _a28=function(item){_a27--;if(_a27===0){this._onFetchComplete(_a25,req);}};_a08.forEach(_a25,function(i){if(!_a26.isItemLoaded(i)){_a26.loadItem({item:i,onItem:_a28,scope:this});}},this);}}else{this.store.fetch({start:_a23,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:_a24,onBegin:lang.hitch(this,"_onFetchBegin"),onComplete:lang.hitch(this,"_onFetchComplete"),onError:lang.hitch(this,"_onFetchError")});}}catch(e){this._onFetchError(e,{start:_a23,count:this.rowsPerPage});}}},_clearData:function(){this.updateRowCount(0);this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoaded=false;this._isLoading=false;},getItem:function(idx){var data=this._by_idx[idx];if(!data||(data&&!data.item)){this._preparePage(idx);return null;}return data.item;},getItemIndex:function(item){return this._getItemIndex(item,false);},_getItemIndex:function(item,_a29){if(!_a29&&!this.store.isItem(item)){return -1;}var idty=this._hasIdentity?this.store.getIdentity(item):null;for(var i=0,l=this._by_idx.length;i<l;i++){var d=this._by_idx[i];if(d&&((idty&&d.idty==idty)||(d.item===item))){return i;}}return -1;},filter:function(_a2a,_a2b){this.query=_a2a;if(_a2b){this._clearData();}this._fetch();},_getItemAttr:function(idx,attr){var item=this.getItem(idx);return (!item?this.fetchText:this.store.getValue(item,attr));},_render:function(){if(this.domNode.parentNode){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this._fetch(0,true);}},_requestsPending:function(_a2c){return this._pending_requests[_a2c];},_rowToPage:function(_a2d){return (this.rowsPerPage?Math.floor(_a2d/this.rowsPerPage):_a2d);},_pageToRow:function(_a2e){return (this.rowsPerPage?this.rowsPerPage*_a2e:_a2e);},_preparePage:function(_a2f){if((_a2f<this._bop||_a2f>=this._eop)&&!this._addingItem){var _a30=this._rowToPage(_a2f);this._needPage(_a30);this._bop=_a30*this.rowsPerPage;this._eop=this._bop+(this.rowsPerPage||this.get("rowCount"));}},_needPage:function(_a31){if(!this._pages[_a31]){this._pages[_a31]=true;this._requestPage(_a31);}},_requestPage:function(_a32){var row=this._pageToRow(_a32);var _a33=Math.min(this.rowsPerPage,this.get("rowCount")-row);if(_a33>0){this._requests++;if(!this._requestsPending(row)){setTimeout(lang.hitch(this,"_fetch",row,false),1);}}},getCellName:function(_a34){return _a34.field;},_refresh:function(_a35){this._clearData();this._fetch(0,_a35);},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh();},canSort:function(){return (!this._isLoading);},getSortProps:function(){var c=this.getCell(this.getSortIndex());if(!c){if(this.sortFields){return this.sortFields;}return null;}else{var desc=c["sortDesc"];var si=!(this.sortInfo>0);if(typeof desc=="undefined"){desc=si;}else{desc=si?!desc:desc;}return [{attribute:c.field,descending:desc}];}},styleRowState:function(_a36){if(this.store&&this.store.getState){var _a37=this.store.getState(_a36.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_a37[s]){c=" dojoxGridRow-"+s;break;}}_a36.customClasses+=c;}},onStyleRow:function(_a38){this.styleRowState(_a38);this.inherited(arguments);},canEdit:function(_a39,_a3a){return this._canEdit;},_copyAttr:function(idx,attr){var row={};var _a3b={};var src=this.getItem(idx);return this.store.getValue(src,attr);},doStartEdit:function(_a3c,_a3d){if(!this._cache[_a3d]){this._cache[_a3d]=this._copyAttr(_a3d,_a3c.field);}this.onStartEdit(_a3c,_a3d);},doApplyCellEdit:function(_a3e,_a3f,_a40){this.store.fetchItemByIdentity({identity:this._by_idx[_a3f].idty,onItem:lang.hitch(this,function(item){var _a41=this.store.getValue(item,_a40);if(typeof _a41=="number"){_a3e=isNaN(_a3e)?_a3e:parseFloat(_a3e);}else{if(typeof _a41=="boolean"){_a3e=_a3e=="true"?true:_a3e=="false"?false:_a3e;}else{if(_a41 instanceof Date){var _a42=new Date(_a3e);_a3e=isNaN(_a42.getTime())?_a3e:_a42;}}}this.store.setValue(item,_a40,_a3e);this.onApplyCellEdit(_a3e,_a3f,_a40);})});},doCancelEdit:function(_a43){var _a44=this._cache[_a43];if(_a44){this.updateRow(_a43);delete this._cache[_a43];}this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_a45,_a46){var _a47=this._cache[_a45];this.onApplyEdit(_a45);},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();var fx=lang.hitch(this,function(_a48){if(_a48.length){_a08.forEach(_a48,this.store.deleteItem,this.store);this.selection.clear();}});if(this.allItemsSelected){this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:fx});}else{fx(this.selection.getSelected());}}}});_a0c.cell_markupFactory=function(_a49,node,_a4a){var _a4b=lang.trim(html.attr(node,"field")||"");if(_a4b){_a4a.field=_a4b;}_a4a.field=_a4a.field||_a4a.name;var _a4c=lang.trim(html.attr(node,"fields")||"");if(_a4c){_a4a.fields=_a4c.split(",");}if(_a49){_a49(node,_a4a);}};_a0c.markupFactory=function(_a4d,node,ctor,_a4e){return _a0a.markupFactory(_a4d,node,ctor,lang.partial(_a0c.cell_markupFactory,_a4e));};return _a0c;});},"esri/dijit/editing/SelectionHelper":function(){define("esri/dijit/editing/SelectionHelper",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dojo/DeferredList","esri/geometry/Extent","esri/geometry/Point","esri/geometry/ScreenPoint","esri/layers/FeatureLayer","esri/tasks/query","esri/kernel"],function(_a4f,lang,_a50,_a51,has,_a52,_a53,_a54,_a55,_a56,_a57,_a58){var SH=_a4f(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(_a59){this._settings=_a59||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers);},destroy:function(){var _a5a;for(_a5a in this._sConnects){if(this._sConnects.hasOwnProperty(_a5a)){_a5a.disconnect(this._sConnects[_a5a]);}}},selectFeatures:function(_a5b,_a5c,_a5d,_a5e){if(_a5d===_a56.SELECTION_NEW){this._resetMapServiceInfos();this.getSelection(_a5b);}var _a5f=[];_a51.forEach(_a5b,function(_a60){if(_a60.visible===true&&_a60._isMapAtVisibleScale()===true){var _a61=_a5d;if(_a60._isSelOnly&&_a61===_a56.SELECTION_NEW){_a61=_a56.SELECTION_ADD;}_a5f.push(_a60.selectFeatures(_a5c,_a61));}});var _a62=new _a52(_a5f);_a62.addCallback(lang.hitch(this,function(_a63){var _a64=[];_a51.forEach(_a63,function(set,idx){_a51.forEach(set[1],function(_a65){var _a66=_a65.attributes[_a5b[idx].objectIdField];_a65=_a5b[idx]._mode._getFeature(_a66)||null;if(_a65){_a64.push(_a65);}},this);},this);if(!this._mapServiceCount){_a5e(_a64);return;}var _a67=_a5d===_a56.SELECTION_SUBTRACT;if(_a67){this._resetMapServiceInfos();this._createLayerDefs(this._getLayerInfosFromSelection(_a5b));}else{this._createLayerDefs(this._getLayerInfosFromFeatures(_a64));}this._updateLayerDefs(this._mapServiceInfos,false,!((_a64&&_a64.length)||_a67),lang.hitch(this,_a5e,_a64));}));},selectFeaturesByGeometry:function(_a68,_a69,_a6a,_a6b){var _a6c=_a69;if(_a69.declaredClass.indexOf("Extent")!==-1){if(_a69.xmax===_a69.xmin&&_a69.ymax===_a69.ymin){_a6c=new _a54(_a69.xmax,_a69.ymax,_a69.spatialReference);}}_a6c=(_a6c.declaredClass.indexOf("Point")!==-1)?this._extentFromPoint(_a6c):_a6c;var _a6d=new _a57();_a6d.geometry=_a6c;this.selectFeatures(_a68,_a6d,_a6a,_a6b);},clearSelection:function(_a6e){var _a6f=this._nonSelOnlyLayers;_a51.forEach(_a6f,function(item){if(item.clearSelection){item.clearSelection();}});if(!this._mapServiceCount){return;}this._resetMapServiceInfos();var _a70=this._getLayerInfosFromSelection(this._settings.layers);var _a71=_a51.some(_a70,function(item){return item.oids&&item.oids.length;});if(_a71){this._createLayerDefs(_a70);this._updateLayerDefs(this._mapServiceInfos,true,_a6e||false);}},findMapService:function(_a72){var map=this._map,_a73=map.layerIds,_a74=(_a72&&_a72._url)?_a72._url.path.toLowerCase():"",_a75,_a76,_a77;for(_a76 in _a73){if(_a73.hasOwnProperty(_a76)){_a75=map.getLayer(_a73[_a76]);_a77=_a75._url?_a75._url.path.toLowerCase().replace("mapserver","featureserver"):"";if(_a74.substr(0,_a77.length)===_a77&&_a75.declaredClass==="esri.layers.ArcGISDynamicMapServiceLayer"){return _a75;}}}},getSelection:function(_a78){var _a79=[];_a51.forEach(_a78,function(_a7a){if(_a7a._isSelOnly){_a79.push(this._createLayerInfo(_a7a));}},this);_a51.forEach(_a79,function(_a7b){var _a7c=this._createMapServiceInfo(this.findMapService(_a7b.layer));if(_a7c){_a7c.layerInfos[_a7b.layer.layerId]=_a7b;}},this);},_initMapServiceInfos:function(_a7d){this._nonSelOnlyLayers=[];this._mapServiceInfos=[];_a51.forEach(_a7d,function(_a7e){var _a7f=this.findMapService(_a7e);if(_a7f){this._mapServiceCount++;this._createMapServiceInfo(_a7f);if(_a7f){_a7f.setDisableClientCaching(true);}}else{this._nonSelOnlyLayers.push(_a7e);}},this);},_createMapServiceInfo:function(_a80){if(!_a80){return null;}var _a81=this._mapServiceInfos;var _a82=_a81[_a80.id];if(!_a82){_a82=_a81[_a80.id]={mapService:_a80,layerInfos:[],layerDefs:lang.mixin([],_a80.layerDefinitions||[]),origLayerDefs:lang.mixin([],_a80.layerDefinitions||[])};}return _a82;},_resetMapServiceInfo:function(_a83){_a51.forEach(_a83.layerInfos,this._resetLayerInfo);_a83.layerDefs=lang.mixin([],_a83.origLayerDefs||[]);},_resetMapServiceInfos:function(){var _a84=this._mapServiceInfos,_a85;for(_a85 in _a84){if(_a84.hasOwnProperty(_a85)){this._resetMapServiceInfo(_a84[_a85]);}}},_createLayerInfo:function(_a86,_a87){var _a88=_a86.objectIdField;var _a89=_a87?[]:_a86.getSelectedFeatures();return {layer:_a86,selectedFeatures:_a89||[],oids:_a51.map(_a89,function(_a8a){return _a8a.attributes[_a88];})};},_resetLayerInfo:function(_a8b){if(!_a8b){return;}_a8b.selectedFeatures=[];_a8b.oids=[];},_updateLayerDefs:function(_a8c,_a8d,_a8e,_a8f){var _a90;for(_a90 in _a8c){if(_a8c.hasOwnProperty(_a90)){var _a91=_a8c[_a90];var _a92=_a91.mapService;var _a93=_a91.layerDefs=(_a8d?lang.mixin([],_a91.origLayerDefs||[]):_a91.layerDefs);if(_a93){if(!_a8e){this._sConnects[_a92.id]=(_a50.connect(_a92,"onUpdateEnd",lang.hitch(this,"_onMapServiceUpdate",_a91,_a8d,_a8f)));}else{if(_a8f){_a8f();}}_a92.setLayerDefinitions(_a93,_a8e||false);}else{if(_a8f){_a8f();}}}}},_onMapServiceUpdate:function(_a94,_a95,_a96){_a50.disconnect(this._sConnects[_a94.mapService.id]);_a51.forEach(_a94.layerInfos,function(_a97){if(_a95){if(_a97){_a97.layer.clearSelection();}}else{var _a98=new _a57();_a98.objectIds=_a97?_a97.oids:[];if(_a98.objectIds.length){_a97.layer.selectFeatures(_a98,_a56.SELECTION_SUBTRACT);}}},this);if(_a95){this._resetMapServiceInfo(_a94);}if(_a96){_a96();}},_createLayerDefs:function(_a99){_a51.forEach(_a99,function(_a9a){var _a9b=_a9a.layer;var _a9c=this._createMapServiceInfo(this.findMapService(_a9a.layer));if(!_a9c){return;}var _a9d=_a9c.mapService;var _a9e=_a9c.layerDefs;var _a9f=_a9b.objectIdField;var _aa0=_a9b.layerId;var _aa1="(\""+_a9f+"\" NOT IN (";var oids=_a9a.oids;if(oids&&oids.length){_a51.forEach(_a9a.oids,function(oid,idx){oids=true;if(idx){_aa1+=",";}_aa1+="'"+oid+"'";});_aa1+="))";if(_a9e.length&&(_a9e[_aa0]&&_a9e[_aa0].length)){_a9e[_aa0]+=" AND"+_aa1;}else{_a9e[_aa0]=_aa1;}}},this);},_getLayerInfosFromFeatures:function(_aa2){var _aa3=[];_a51.forEach(_aa2,function(_aa4){var _aa5=_aa4.getLayer();if(_aa5&&_aa5._isSelOnly){if(!_aa3[_aa5.id]){_aa3[_aa5.id]=this._createLayerInfo(_aa5,true);}_aa3[_aa5.id].selectedFeatures.push(_aa4);_aa3[_aa5.id].oids.push(_aa4.attributes[_aa5.objectIdField]);}},this);var _aa6=[],_aa7;for(_aa7 in _aa3){if(_aa3.hasOwnProperty(_aa7)){_aa6.push(_aa3[_aa7]);}}return _aa6;},_getLayerInfosFromSelection:function(_aa8){var _aa9=[];_a51.forEach(_aa8,function(_aaa){if(_aaa._isSelOnly){_aa9.push(this._createLayerInfo(_aaa,false));}},this);return _aa9;},_extentFromPoint:function(_aab){var _aac=this._tolerance;var map=this._map;var _aad=map.toScreen(_aab);var pnt1=new _a55(_aad.x-_aac,_aad.y+_aac);var pnt2=new _a55(_aad.x+_aac,_aad.y-_aac);var _aae=map.toMap(pnt1);var _aaf=map.toMap(pnt2);return new _a53(_aae.x,_aae.y,_aaf.x,_aaf.y,map.spatialReference);}});if(has("extend-esri")){lang.setObject("dijit.editing.SelectionHelper",SH,_a58);}return SH;});},"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n","dijit/_editor/plugins/LinkDialog":function(){define("dijit/_editor/plugins/LinkDialog",["require","dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/query","dojo/string","../../_Widget","../_Plugin","../../form/DropDownButton","../range"],function(_ab0,_ab1,_ab2,keys,lang,has,_ab3,_ab4,_ab5,_ab6,_ab7,_ab8){var _ab9=_ab1("dijit._editor.plugins.LinkDialog",_ab6,{buttonClass:_ab7,useDefaultCommand:false,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",emailRegExp:"<?(mailto\\:)([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+"+"@"+"((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*>?",htmlTemplate:"<a href=\"${urlInput}\" _djrealurl=\"${urlInput}\""+" target=\"${targetSelect}\""+">${textInput}</a>",tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' "+"id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_targetSelect'>${target}</label>","</td><td>","<select id='${id}_targetSelect' name='targetSelect' data-dojo-type='dijit.form.Select'>","<option selected='selected' value='_self'>${currentWindow}</option>","<option value='_blank'>${newWindow}</option>","<option value='_top'>${topWindow}</option>","<option value='_parent'>${parentWindow}</option>","</select>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),_initButton:function(){this.inherited(arguments);this.button.loadDropDown=lang.hitch(this,"_loadDropDown");this._connectTagEvents();},_loadDropDown:function(_aba){_ab0(["dojo/i18n","../../TooltipDialog","../../registry","../../form/Button","../../form/Select","../../form/ValidationTextBox","dojo/i18n!../../nls/common","dojo/i18n!../nls/LinkDialog"],lang.hitch(this,function(i18n,_abb,_abc){var _abd=this;this.tag=this.command=="insertImage"?"img":"a";var _abe=lang.delegate(i18n.getLocalization("dijit","common",this.lang),i18n.getLocalization("dijit._editor","LinkDialog",this.lang));var _abf=(this.dropDown=this.button.dropDown=new _abb({title:_abe[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:lang.hitch(this,"setValue"),onOpen:function(){_abd._onOpenDialog();_abb.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(lang.hitch(_abd,"_onCloseDialog"),0);}}));_abe.urlRegExp=this.urlRegExp;_abe.id=_abc.getUniqueId(this.editor.id);this._uniqueId=_abe.id;this._setContent(_abf.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_ab4.substitute(this.linkDialogTemplate,_abe));_abf.startup();this._urlInput=_abc.byId(this._uniqueId+"_urlInput");this._textInput=_abc.byId(this._uniqueId+"_textInput");this._setButton=_abc.byId(this._uniqueId+"_setButton");this.connect(_abc.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel();});if(this._urlInput){this.connect(this._urlInput,"onChange","_checkAndFixInput");}if(this._textInput){this.connect(this._textInput,"onChange","_checkAndFixInput");}this._urlRegExp=new RegExp("^"+this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=lang.hitch(this,function(){var _ac0=this._urlInput.get("value");return this._urlRegExp.test(_ac0)||this._emailRegExp.test(_ac0);});this.connect(_abf.domNode,"onkeypress",function(e){if(e&&e.charOrCode==keys.ENTER&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){if(!this._setButton.get("disabled")){_abf.onExecute();_abf.execute(_abf.get("value"));}}});_aba();}));},_checkAndFixInput:function(){var self=this;var url=this._urlInput.get("value");var _ac1=function(url){var _ac2=false;var _ac3=false;if(url&&url.length>1){url=lang.trim(url);if(url.indexOf("mailto:")!==0){if(url.indexOf("/")>0){if(url.indexOf("://")===-1){if(url.charAt(0)!=="/"&&url.indexOf("./")&&url.indexOf("../")!==0){if(self._hostRxp.test(url)){_ac2=true;}}}}else{if(self._userAtRxp.test(url)){_ac3=true;}}}}if(_ac2){self._urlInput.set("value","http://"+url);}if(_ac3){self._urlInput.set("value","mailto:"+url);}self._setButton.set("disabled",!self._isValid());};if(this._delayedCheck){clearTimeout(this._delayedCheck);this._delayedCheck=null;}this._delayedCheck=setTimeout(function(){_ac1(url);},250);},_connectTagEvents:function(){this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);}));},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid();},_setContent:function(_ac4){this.dropDown.set({parserScope:"dojo",content:_ac4});},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}return args;},setValue:function(args){this._onCloseDialog();if(has("ie")<9){var sel=_ab8.getSelection(this.editor.window);var _ac5=sel.getRangeAt(0);var a=_ac5.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(a&&(a.nodeName&&a.nodeName.toLowerCase()===this.tag)){if(this.editor.queryCommandEnabled("unlink")){this.editor._sCall("selectElementChildren",[a]);this.editor.execCommand("unlink");}}}args=this._checkValues(args);this.editor.execCommand("inserthtml",_ab4.substitute(this.htmlTemplate,args));_ab3("a",this.editor.document).forEach(function(a){if(!a.innerHTML&&!_ab2.has(a,"name")){a.parentNode.removeChild(a);}},this);},_onCloseDialog:function(){this.editor.focus();},_getCurrentValues:function(a){var url,text,_ac6;if(a&&a.tagName.toLowerCase()===this.tag){url=a.getAttribute("_djrealurl")||a.getAttribute("href");_ac6=a.getAttribute("target")||"_self";text=a.textContent||a.innerText;this.editor._sCall("selectElement",[a,true]);}else{text=this.editor._sCall("getSelectedText");}return {urlInput:url||"",textInput:text||"",targetSelect:_ac6||""};},_onOpenDialog:function(){var a,b,fc;if(has("ie")){var sel=_ab8.getSelection(this.editor.window);if(sel.rangeCount){var _ac7=sel.getRangeAt(0);a=_ac7.endContainer;if(a.nodeType===3){a=a.parentNode;}if(a&&(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){a=this.editor._sCall("getSelectedElement",[this.tag]);}if(!a||(a.nodeName&&a.nodeName.toLowerCase()!==this.tag)){b=this.editor._sCall("getAncestorElement",[this.tag]);if(b&&(b.nodeName&&b.nodeName.toLowerCase()==this.tag)){a=b;this.editor._sCall("selectElement",[a]);}else{if(_ac7.startContainer===_ac7.endContainer){fc=_ac7.startContainer.firstChild;if(fc&&(fc.nodeName&&fc.nodeName.toLowerCase()==this.tag)){a=fc;this.editor._sCall("selectElement",[a]);}}}}}}else{a=this.editor._sCall("getAncestorElement",[this.tag]);}this.dropDown.reset();this._setButton.set("disabled",true);this.dropDown.set("value",this._getCurrentValues(a));},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_ab2.get(t,"href")){var _ac8=this.editor;this.editor._sCall("selectElement",[t]);_ac8.onDisplayChanged();if(_ac8._updateTimer){_ac8._updateTimer.remove();delete _ac8._updateTimer;}_ac8.onNormalizedDisplayChanged();var _ac9=this.button;setTimeout(function(){_ac9.set("disabled",false);_ac9.loadAndOpenDropDown().then(function(){if(_ac9.dropDown.focus){_ac9.dropDown.focus();}});},10);}}}});var _aca=_ab1("dijit._editor.plugins.ImgLinkDialog",[_ab9],{linkDialogTemplate:["<table role='presentation'><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' "+"required='true' id='${id}_urlInput' name='urlInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input data-dojo-type='dijit.form.ValidationTextBox' required='false' id='${id}_textInput' "+"name='textInput' data-dojo-props='intermediateChanges:true'/>","</td></tr><tr><td>","</td><td>","</td></tr><tr><td colspan='2'>","<button data-dojo-type='dijit.form.Button' type='submit' id='${id}_setButton'>${set}</button>","<button data-dojo-type='dijit.form.Button' type='button' id='${id}_cancelButton'>${buttonCancel}</button>","</td></tr></table>"].join(""),htmlTemplate:"<img src=\"${urlInput}\" _djrealurl=\"${urlInput}\" alt=\"${textInput}\" />",tag:"img",_getCurrentValues:function(img){var url,text;if(img&&img.tagName.toLowerCase()===this.tag){url=img.getAttribute("_djrealurl")||img.getAttribute("src");text=img.getAttribute("alt");this.editor._sCall("selectElement",[img,true]);}else{text=this.editor._sCall("getSelectedText",[]);}return {urlInput:url||"",textInput:text||""};},_isValid:function(){return this._urlInput.isValid();},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(lang.hitch(this,function(){this.connect(this.editor.editNode,"onmousedown",this._selectTag);}));},_selectTag:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag){this.editor._sCall("selectElement",[t]);}}},_checkValues:function(args){if(args&&args.urlInput){args.urlInput=args.urlInput.replace(/"/g,"&quot;");}if(args&&args.textInput){args.textInput=args.textInput.replace(/"/g,"&quot;");}return args;},_onDblClick:function(e){if(e&&e.target){var t=e.target;var tg=t.tagName?t.tagName.toLowerCase():"";if(tg===this.tag&&_ab2.get(t,"src")){var _acb=this.editor;this.editor._sCall("selectElement",[t]);_acb.onDisplayChanged();if(_acb._updateTimer){_acb._updateTimer.remove();delete _acb._updateTimer;}_acb.onNormalizedDisplayChanged();var _acc=this.button;setTimeout(function(){_acc.set("disabled",false);_acc.loadAndOpenDropDown().then(function(){if(_acc.dropDown.focus){_acc.dropDown.focus();}});},10);}}}});_ab6.registry["createLink"]=function(){return new _ab9({command:"createLink"});};_ab6.registry["insertImage"]=function(){return new _aca({command:"insertImage"});};_ab9.ImgLinkDialog=_aca;return _ab9;});},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(_acd,_ace,_acf){var base=null;return _acd("dojo.store.Memory",base,{constructor:function(_ad0){for(var i in _ad0){this[i]=_ad0[i];}this.setData(this.data||[]);},data:null,idProperty:"id",index:null,queryEngine:_acf,get:function(id){return this.data[this.index[id]];},getIdentity:function(_ad1){return _ad1[this.idProperty];},put:function(_ad2,_ad3){var data=this.data,_ad4=this.index,_ad5=this.idProperty;var id=_ad2[_ad5]=(_ad3&&"id" in _ad3)?_ad3.id:_ad5 in _ad2?_ad2[_ad5]:Math.random();if(id in _ad4){if(_ad3&&_ad3.overwrite===false){throw new Error("Object already exists");}data[_ad4[id]]=_ad2;}else{_ad4[id]=data.push(_ad2)-1;}return id;},add:function(_ad6,_ad7){(_ad7=_ad7||{}).overwrite=false;return this.put(_ad6,_ad7);},remove:function(id){var _ad8=this.index;var data=this.data;if(id in _ad8){data.splice(_ad8[id],1);this.setData(data);return true;}},query:function(_ad9,_ada){return _ace(this.queryEngine(_ad9,_ada)(this.data));},setData:function(data){if(data.items){this.idProperty=data.identifier;data=this.data=data.items;}else{this.data=data;}this.index={};for(var i=0,l=data.length;i<l;i++){this.index[data[i][this.idProperty]]=i;}}});});},"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n","dijit/form/MappedTextBox":function(){define("dijit/form/MappedTextBox",["dojo/_base/declare","dojo/dom-construct","./ValidationTextBox"],function(_adb,_adc,_add){return _adb("dijit.form.MappedTextBox",_add,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting="";},_setNameAttr:null,serialize:function(val){return val.toString?val.toString():"";},toString:function(){var val=this.filter(this.get("value"));return val!=null?(typeof val=="string"?val:this.serialize(val,this.constraints)):"";},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);this.valueNode=_adc.place("<input type='hidden'"+(this.name?" name=\""+this.name.replace(/"/g,"&quot;")+"\"":"")+"/>",this.textbox,"after");},reset:function(){this.valueNode.value="";this.inherited(arguments);}});});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_ade,dom,lang,_adf,_ae0,_ae1){function _ae2(_ae3){return {id:_ae3.value,value:_ae3.value,name:lang.trim(_ae3.innerText||_ae3.textContent||"")};};return _ade("dijit.form.DataList",_ae0,{constructor:function(_ae4,_ae5){this.domNode=dom.byId(_ae5);lang.mixin(this,_ae4);if(this.id){_ae1.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:_adf("option",this.domNode).map(_ae2)}]);},destroy:function(){_ae1.remove(this.id);},fetchSelectedItem:function(){var _ae6=_adf("> option[selected]",this.domNode)[0]||_adf("> option",this.domNode)[0];return _ae6&&_ae2(_ae6);}});});},"dojox/grid/_FocusManager":function(){define("dojox/grid/_FocusManager",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/connect","dojo/_base/event","dojo/_base/sniff","dojo/query","./util","dojo/_base/html"],function(_ae7,lang,_ae8,_ae9,_aea,has,_aeb,util,html){return _ae8("dojox.grid._FocusManager",null,{constructor:function(_aec){this.grid=_aec;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(_ae9.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(_ae9.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(_ae9.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(_ae9.connect(this.grid.domNode,"mouseup",this,"_mouseUp"));this._connects.push(_ae9.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(_ae9.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(_ae9.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(_ae9.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(_ae9.connect(this.grid,"postrender",this,"_delayedHeaderFocus"));},destroy:function(){_ae7.forEach(this._connects,_ae9.disconnect);_ae7.forEach(this._headerConnects,_ae9.disconnect);delete this.grid;delete this.cell;},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:false,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders();},isFocusCell:function(_aed,_aee){return (this.cell==_aed)&&(this.rowIndex==_aee);},isLastFocusCell:function(){if(this.cell){return (this.rowIndex==this.grid.rowCount-1)&&(this.cell.index==this.grid.layout.cellCount-1);}return false;},isFirstFocusCell:function(){if(this.cell){return (this.rowIndex===0)&&(this.cell.index===0);}return false;},isNoFocusCell:function(){return (this.rowIndex<0)||!this.cell;},isNavHeader:function(){return (!!this._colHeadNode);},getHeaderIndex:function(){if(this._colHeadNode){return _ae7.indexOf(this._findHeaderCells(),this._colHeadNode);}else{return -1;}},_focusifyCellNode:function(_aef){var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){html.toggleClass(n,this.focusClass,_aef);if(_aef){var sl=this.scrollIntoView();try{if(has("webkit")||!this.grid.edit.isEditing()){util.fire(n,"focus");if(sl){this.cell.view.scrollboxNode.scrollLeft=sl;}}}catch(e){}}}},_delayedCellFocus:function(){if(this.isNavHeader()||!this.grid.focused){return;}var n=this.cell&&this.cell.getNode(this.rowIndex);if(n){try{if(!this.grid.edit.isEditing()){html.toggleClass(n,this.focusClass,true);if(this._colHeadNode){this.blurHeader();}util.fire(n,"focus");}}catch(e){}}},_delayedHeaderFocus:function(){if(this.isNavHeader()){this.focusHeader();}},_initColumnHeaders:function(){_ae7.forEach(this._headerConnects,_ae9.disconnect);this._headerConnects=[];var _af0=this._findHeaderCells();for(var i=0;i<_af0.length;i++){this._headerConnects.push(_ae9.connect(_af0[i],"onfocus",this,"doColHeaderFocus"));this._headerConnects.push(_ae9.connect(_af0[i],"onblur",this,"doColHeaderBlur"));}},_findHeaderCells:function(){var _af1=_aeb("th",this.grid.viewsHeaderNode);var _af2=[];for(var i=0;i<_af1.length;i++){var _af3=_af1[i];var _af4=html.hasAttr(_af3,"tabIndex");var _af5=html.attr(_af3,"tabIndex");if(_af4&&_af5<0){_af2.push(_af3);}}return _af2;},_setActiveColHeader:function(_af6,_af7,_af8){this.grid.domNode.setAttribute("aria-activedescendant",_af6.id);if(_af8!=null&&_af8>=0&&_af8!=_af7){html.toggleClass(this._findHeaderCells()[_af8],this.focusClass,false);}html.toggleClass(_af6,this.focusClass,true);this._colHeadNode=_af6;this._colHeadFocusIdx=_af7;this._scrollHeader(this._colHeadFocusIdx);},scrollIntoView:function(){var info=(this.cell?this._scrollInfo(this.cell):null);if(!info||!info.s){return null;}var rt=this.grid.scroller.findScrollTop(this.rowIndex);if(info.n&&info.sr){if(info.n.offsetLeft+info.n.offsetWidth>info.sr.l+info.sr.w){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}}}if(info.r&&info.sr){if(rt+info.r.offsetHeight>info.sr.t+info.sr.h){this.grid.setScrollTop(rt+info.r.offsetHeight-info.sr.h);}else{if(rt<info.sr.t){this.grid.setScrollTop(rt);}}}return info.s.scrollLeft;},_scrollInfo:function(cell,_af9){if(cell){var cl=cell,sbn=cl.view.scrollboxNode,sbnr={w:sbn.clientWidth,l:sbn.scrollLeft,t:sbn.scrollTop,h:sbn.clientHeight},rn=cl.view.getRowNode(this.rowIndex);return {c:cl,s:sbn,sr:sbnr,n:(_af9?_af9:cell.getNode(this.rowIndex)),r:rn};}return null;},_scrollHeader:function(_afa){var info=null;if(this._colHeadNode){var cell=this.grid.getCell(_afa);if(!cell){return;}info=this._scrollInfo(cell,cell.getNode(0));}if(info&&info.s&&info.sr&&info.n){var _afb=info.sr.l+info.sr.w;if(info.n.offsetLeft+info.n.offsetWidth>_afb){info.s.scrollLeft=info.n.offsetLeft+info.n.offsetWidth-info.sr.w;}else{if(info.n.offsetLeft<info.sr.l){info.s.scrollLeft=info.n.offsetLeft;}else{if(has("ie")<=7&&cell&&cell.view.headerNode){cell.view.headerNode.scrollLeft=info.s.scrollLeft;}}}}},_isHeaderHidden:function(){var _afc=this.focusView;if(!_afc){for(var i=0,_afd;(_afd=this.grid.views.views[i]);i++){if(_afd.headerNode){_afc=_afd;break;}}}return (_afc&&html.getComputedStyle(_afc.headerNode).display=="none");},colSizeAdjust:function(e,_afe,_aff){var _b00=this._findHeaderCells();var view=this.focusView;if(!view||!view.header.tableMap.map){for(var i=0,_b01;(_b01=this.grid.views.views[i]);i++){if(_b01.header.tableMap.map){view=_b01;break;}}}var _b02=_b00[_afe];if(!view||(_afe==_b00.length-1&&_afe===0)){return;}view.content.baseDecorateEvent(e);e.cellNode=_b02;e.cellIndex=view.content.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);if(view.header.canResize(e)){var _b03={l:_aff};var drag=view.header.colResizeSetup(e,false);view.header.doResizeColumn(drag,null,_b03);view.update();}},styleRow:function(_b04){return;},setFocusIndex:function(_b05,_b06){this.setFocusCell(this.grid.getCell(_b06),_b05);},setFocusCell:function(_b07,_b08){if(_b07&&!this.isFocusCell(_b07,_b08)){this.tabbingOut=false;if(this._colHeadNode){this.blurHeader();}this._colHeadNode=this._colHeadFocusIdx=null;this.focusGridView();this._focusifyCellNode(false);this.cell=_b07;this.rowIndex=_b08;this._focusifyCellNode(true);}if(has("opera")){setTimeout(lang.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);}else{this.grid.onCellFocus(this.cell,this.rowIndex);}},next:function(){if(this.cell){var row=this.rowIndex,col=this.cell.index+1,cc=this.grid.layout.cellCount-1,rc=this.grid.rowCount-1;if(col>cc){col=0;row++;}if(row>rc){col=cc;row=rc;}if(this.grid.edit.isEditing()){var _b09=this.grid.getCell(col);if(!this.isLastFocusCell()&&(!_b09.editable||this.grid.canEdit&&!this.grid.canEdit(_b09,row))){this.cell=_b09;this.rowIndex=row;this.next();return;}}this.setFocusIndex(row,col);}},previous:function(){if(this.cell){var row=(this.rowIndex||0),col=(this.cell.index||0)-1;if(col<0){col=this.grid.layout.cellCount-1;row--;}if(row<0){row=0;col=0;}if(this.grid.edit.isEditing()){var _b0a=this.grid.getCell(col);if(!this.isFirstFocusCell()&&!_b0a.editable){this.cell=_b0a;this.rowIndex=row;this.previous();return;}}this.setFocusIndex(row,col);}},move:function(_b0b,_b0c){var _b0d=_b0c<0?-1:1;if(this.isNavHeader()){var _b0e=this._findHeaderCells();var _b0f=currentIdx=_ae7.indexOf(_b0e,this._colHeadNode);currentIdx+=_b0c;while(currentIdx>=0&&currentIdx<_b0e.length&&_b0e[currentIdx].style.display=="none"){currentIdx+=_b0d;}if((currentIdx>=0)&&(currentIdx<_b0e.length)){this._setActiveColHeader(_b0e[currentIdx],currentIdx,_b0f);}}else{if(this.cell){var sc=this.grid.scroller,r=this.rowIndex,rc=this.grid.rowCount-1,row=Math.min(rc,Math.max(0,r+_b0b));if(_b0b){if(_b0b>0){if(row>sc.getLastPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop+sc.findScrollTop(row)-sc.findScrollTop(r));}}else{if(_b0b<0){if(row<=sc.getPageRow(sc.page)){this.grid.setScrollTop(this.grid.scrollTop-sc.findScrollTop(r)-sc.findScrollTop(row));}}}}var cc=this.grid.layout.cellCount-1,i=this.cell.index,col=Math.min(cc,Math.max(0,i+_b0c));var cell=this.grid.getCell(col);while(col>=0&&col<cc&&cell&&cell.hidden===true){col+=_b0d;cell=this.grid.getCell(col);}if(!cell||cell.hidden===true){col=i;}var n=cell.getNode(row);if(!n&&_b0b){if((row+_b0b)>=0&&(row+_b0b)<=rc){this.move(_b0b>0?++_b0b:--_b0b,_b0c);}return;}else{if((!n||html.style(n,"display")==="none")&&_b0c){if((col+_b0c)>=0&&(col+_b0c)<=cc){this.move(_b0b,_b0c>0?++_b0c:--_b0c);}return;}}this.setFocusIndex(row,col);if(_b0b){this.grid.updateRow(r);}}}},previousKey:function(e){if(this.grid.edit.isEditing()){_aea.stop(e);this.previous();}else{if(!this.isNavHeader()&&!this._isHeaderHidden()){this.grid.domNode.focus();_aea.stop(e);}else{this.tabOut(this.grid.domNode);if(this._colHeadFocusIdx!=null){html.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,false);this._colHeadFocusIdx=null;}this._focusifyCellNode(false);}}},nextKey:function(e){var _b10=(this.grid.rowCount===0);if(e.target===this.grid.domNode&&this._colHeadFocusIdx==null){this.focusHeader();_aea.stop(e);}else{if(this.isNavHeader()){this.blurHeader();if(!this.findAndFocusGridCell()){this.tabOut(this.grid.lastFocusNode);}this._colHeadNode=this._colHeadFocusIdx=null;}else{if(this.grid.edit.isEditing()){_aea.stop(e);this.next();}else{this.tabOut(this.grid.lastFocusNode);}}}},tabOut:function(_b11){this.tabbingOut=true;_b11.focus();},focusGridView:function(){util.fire(this.focusView,"focus");},focusGrid:function(_b12){this.focusGridView();this._focusifyCellNode(true);},findAndFocusGridCell:function(){var _b13=true;var _b14=(this.grid.rowCount===0);if(this.isNoFocusCell()&&!_b14){var _b15=0;var cell=this.grid.getCell(_b15);if(cell.hidden){_b15=this.isNavHeader()?this._colHeadFocusIdx:0;}this.setFocusIndex(0,_b15);}else{if(this.cell&&!_b14){if(this.focusView&&!this.focusView.rowNodes[this.rowIndex]){this.grid.scrollToRow(this.rowIndex);}this.focusGrid();}else{_b13=false;}}this._colHeadNode=this._colHeadFocusIdx=null;return _b13;},focusHeader:function(){var _b16=this._findHeaderCells();var _b17=this._colHeadFocusIdx;if(this._isHeaderHidden()){this.findAndFocusGridCell();}else{if(!this._colHeadFocusIdx){if(this.isNoFocusCell()){this._colHeadFocusIdx=0;}else{this._colHeadFocusIdx=this.cell.index;}}}this._colHeadNode=_b16[this._colHeadFocusIdx];while(this._colHeadNode&&this._colHeadFocusIdx>=0&&this._colHeadFocusIdx<_b16.length&&this._colHeadNode.style.display=="none"){this._colHeadFocusIdx++;this._colHeadNode=_b16[this._colHeadFocusIdx];}if(this._colHeadNode&&this._colHeadNode.style.display!="none"){if(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode){this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode);this.headerMenu.bindDomNode(this.grid.domNode);this._contextMenuBindNode=this.grid.domNode;}this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,_b17);this._scrollHeader(this._colHeadFocusIdx);this._focusifyCellNode(false);}else{this.findAndFocusGridCell();}},blurHeader:function(){html.removeClass(this._colHeadNode,this.focusClass);html.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var _b18=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(_b18);this._contextMenuBindNode=_b18;}},doFocus:function(e){if(e&&e.target!=e.currentTarget){_aea.stop(e);return;}if(this._clickFocus){return;}if(!this.tabbingOut){this.focusHeader();}this.tabbingOut=false;_aea.stop(e);},doBlur:function(e){_aea.stop(e);},doContextMenu:function(e){if(!this.headerMenu){_aea.stop(e);}},doLastNodeFocus:function(e){if(this.tabbingOut){this._focusifyCellNode(false);}else{if(this.grid.rowCount>0){if(this.isNoFocusCell()){this.setFocusIndex(0,0);}this._focusifyCellNode(true);}else{this.focusHeader();}}this.tabbingOut=false;_aea.stop(e);},doLastNodeBlur:function(e){_aea.stop(e);},doColHeaderFocus:function(e){this._setActiveColHeader(e.target,html.attr(e.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());_aea.stop(e);},doColHeaderBlur:function(e){html.toggleClass(e.target,this.focusClass,false);},_mouseDown:function(e){this._clickFocus=dojo.some(this.grid.views.views,function(v){return v.scrollboxNode===e.target;});},_mouseUp:function(e){this._clickFocus=false;}});});},"url:dojox/grid/resources/View.html":"<div class=\"dojoxGridView\" role=\"presentation\">\n\t<div class=\"dojoxGridHeader\" dojoAttachPoint=\"headerNode\" role=\"presentation\">\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\" role=\"presentation\">\n\t\t\t<div dojoAttachPoint=\"headerContentNode\" role=\"row\"></div>\n\t\t</div>\n\t</div>\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" dojoAttachPoint=\"hiddenFocusNode\" role=\"presentation\" />\n\t<input type=\"checkbox\" class=\"dojoxGridHiddenFocus\" role=\"presentation\" />\n\t<div class=\"dojoxGridScrollbox\" dojoAttachPoint=\"scrollboxNode\" role=\"presentation\">\n\t\t<div class=\"dojoxGridContent\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\" role=\"presentation\"></div>\n\t</div>\n</div>\n","esri/layers/SnapshotMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/SpatialReference","esri/tasks/query","esri/layers/RenderMode"],function(_b19,lang,has,_b1a,_b1b,_b1c,_b1d){var _b1e=_b19([_b1d],{declaredClass:"esri.layers._SnapshotMode",constructor:function(_b1f){this.featureLayer=_b1f;this._featureMap={};this._drawFeatures=lang.hitch(this,this._drawFeatures);this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},startup:function(){if(this.featureLayer._collection){this._applyTimeFilter();}else{this._fetchAll();}},propertyChangeHandler:function(type){if(this._init){if(type){if(this.featureLayer._collection){console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id = "+this.featureLayer.id);}else{this._fetchAll();}}else{this._applyTimeFilter();}}},drawFeature:function(_b20){var _b21=this.featureLayer,_b22=_b21.objectIdField,oid=_b20.attributes[_b22];this._addFeatureIIf(oid,_b20);this._incRefCount(oid);},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _b23=this.featureLayer;if(_b23._collection){_b23._fireUpdateStart();_b23._refresh(true);_b23._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_b24){var id="_"+_b24.name+_b24.layerId+_b24._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _b25=this.featureLayer;if(_b25._collection){return;}_b25._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_b26=this.featureLayer,_b27=_b26.getDefinitionExpression();var _b28=new _b1c();_b28.outFields=_b26.getOutFields();_b28.where=_b27||"1=1";_b28.returnGeometry=true;_b28.outSpatialReference=new _b1b(map.spatialReference.toJson());_b28.timeExtent=_b26.getTimeDefinition();_b28.maxAllowableOffset=_b26._maxOffset;if(_b26._ts){_b28._ts=(new Date()).getTime();}var _b29;if(_b26._usePatch){_b29=this._getRequestId(_b26);this._cancelPendingRequest(null,_b29);}_b26._task.execute(_b28,this._drawFeatures,this._queryErrorHandler,_b29);},_drawFeatures:function(_b2a){this._purgeRequests();var _b2b=_b2a.features,_b2c=this.featureLayer,_b2d=_b2c.objectIdField,i,len=_b2b.length,_b2e,oid;for(i=0;i<len;i++){_b2e=_b2b[i];oid=_b2e.attributes[_b2d];this._addFeatureIIf(oid,_b2e);this._incRefCount(oid);}this._applyTimeFilter(true);_b2c._fireUpdateEnd(null,_b2a.exceededTransferLimit?{queryLimitExceeded:true}:null);if(_b2a.exceededTransferLimit){_b2c.onQueryLimitExceeded();}},_queryErrorHandler:function(err){this._purgeRequests();var _b2f=this.featureLayer;_b2f._errorHandler(err);_b2f._fireUpdateEnd(err);}});if(has("extend-esri")){lang.setObject("layers._SnapshotMode",_b1e,_b1a);}return _b1e;});},"dijit/form/_Spinner":function(){require({cache:{"url:dijit/form/templates/Spinner.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\"\n\tid=\"widget_${id}\" role=\"presentation\"\n\t><div class=\"dijitReset dijitButtonNode dijitSpinnerButtonContainer\"\n\t\t><input class=\"dijitReset dijitInputField dijitSpinnerButtonInner\" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t/><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton\"\n\t\t\tdata-dojo-attach-point=\"upArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9650; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t\t><div class=\"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\tdata-dojo-attach-point=\"downArrowNode\"\n\t\t\t><div class=\"dijitArrowButtonInner\"\n\t\t\t\t><input class=\"dijitReset dijitInputField\" value=\"&#9660; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/></div\n\t\t></div\n\t></div\n\t><div class='dijitReset dijitValidationContainer'\n\t\t><input class=\"dijitReset dijitInputField dijitValidationIcon dijitValidationInner\" value=\"&#935; \" type=\"text\" tabIndex=\"-1\" readonly=\"readonly\" role=\"presentation\"\n\t/></div\n\t><div class=\"dijitReset dijitInputField dijitInputContainer\"\n\t\t><input class='dijitReset dijitInputInner' data-dojo-attach-point=\"textbox,focusNode\" type=\"${type}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\"\n\t\t\trole=\"spinbutton\" autocomplete=\"off\" ${!nameAttrSetting}\n\t/></div\n></div>\n"}});define("dijit/form/_Spinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/mouse","../typematic","./RangeBoundTextBox","dojo/text!./templates/Spinner.html","./_TextBoxMixin"],function(_b30,_b31,keys,lang,has,_b32,_b33,_b34,_b35,_b36){return _b30("dijit.form._Spinner",_b34,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:_b35,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{"upArrowNode":"dijitUpArrowButton","downArrowNode":"dijitDownArrowButton"},adjust:function(val){return val;},_arrowPressed:function(_b37,_b38,_b39){if(this.disabled||this.readOnly){return;}this._setValueAttr(this.adjust(this.get("value"),_b38*_b39),false);_b36.selectInputText(this.textbox,this.textbox.value.length);},_arrowReleased:function(){this._wheelTimer=null;},_typematicCallback:function(_b3a,node,evt){var inc=this.smallDelta;if(node==this.textbox){var key=evt.charOrCode;inc=(key==keys.PAGE_UP||key==keys.PAGE_DOWN)?this.largeDelta:this.smallDelta;node=(key==keys.UP_ARROW||key==keys.PAGE_UP)?this.upArrowNode:this.downArrowNode;}if(_b3a==-1){this._arrowReleased(node);}else{this._arrowPressed(node,(node==this.upArrowNode)?1:-1,inc);}},_wheelTimer:null,_mouseWheeled:function(evt){_b31.stop(evt);var _b3b=evt.wheelDelta/120;if(Math.floor(_b3b)!=_b3b){_b3b=evt.wheelDelta>0?1:-1;}var _b3c=evt.detail?(evt.detail*-1):_b3b;if(_b3c!==0){var node=this[(_b3c>0?"upArrowNode":"downArrowNode")];this._arrowPressed(node,_b3c,this.smallDelta);if(this._wheelTimer){this._wheelTimer.remove();}this._wheelTimer=this.defer(function(){this._arrowReleased(node);},50);}},_setConstraintsAttr:function(_b3d){this.inherited(arguments);if(this.focusNode){if(this.constraints.min!==undefined){this.focusNode.setAttribute("aria-valuemin",this.constraints.min);}else{this.focusNode.removeAttribute("aria-valuemin");}if(this.constraints.max!==undefined){this.focusNode.setAttribute("aria-valuemax",this.constraints.max);}else{this.focusNode.removeAttribute("aria-valuemax");}}},_setValueAttr:function(_b3e,_b3f){this.focusNode.setAttribute("aria-valuenow",_b3e);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_b32.wheel,"_mouseWheeled");this.own(_b33.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.UP_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b33.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.DOWN_ARROW,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b33.addListener(this.upArrowNode,this.textbox,{charOrCode:keys.PAGE_UP,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),_b33.addListener(this.downArrowNode,this.textbox,{charOrCode:keys.PAGE_DOWN,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout));}});});},"dijit/MenuItem":function(){require({cache:{"url:dijit/templates/MenuItem.html":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitem\" tabIndex=\"-1\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitIcon dijitMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">\n\t\t<div data-dojo-attach-point=\"arrowWrapper\" style=\"visibility: hidden\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuExpand\"/>\n\t\t\t<span class=\"dijitMenuExpandA11y\">+</span>\n\t\t</div>\n\t</td>\n</tr>\n"}});define("dijit/MenuItem",["dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/kernel","dojo/sniff","./_Widget","./_TemplatedMixin","./_Contained","./_CssStateMixin","dojo/text!./templates/MenuItem.html"],function(_b40,dom,_b41,_b42,_b43,has,_b44,_b45,_b46,_b47,_b48){return _b40("dijit.MenuItem",[_b44,_b45,_b46,_b47],{templateString:_b48,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(val){this.containerNode.innerHTML=val;this._set("label",val);if(this.textDir==="auto"){this.applyTextDir(this.focusNode,this.label);}},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:false,_fillContent:function(_b49){if(_b49&&!("label" in this.params)){this.set("label",_b49.innerHTML);}},buildRendering:function(){this.inherited(arguments);var _b4a=this.id+"_text";_b41.set(this.containerNode,"id",_b4a);if(this.accelKeyNode){_b41.set(this.accelKeyNode,"id",this.id+"_accel");_b4a+=" "+this.id+"_accel";}this.domNode.setAttribute("aria-labelledby",_b4a);dom.setSelectable(this.domNode,false);},onClick:function(){},focus:function(){try{if(has("ie")==8){this.containerNode.focus();}this.focusNode.focus();}catch(e){}},_onFocus:function(){this._setSelected(true);this.getParent()._onItemFocus(this);this.inherited(arguments);},_setSelected:function(_b4b){_b42.toggle(this.domNode,"dijitMenuItemSelected",_b4b);},setLabel:function(_b4c){_b43.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",_b4c);},setDisabled:function(_b4d){_b43.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",_b4d);},_setDisabledAttr:function(_b4e){this.focusNode.setAttribute("aria-disabled",_b4e?"true":"false");this._set("disabled",_b4e);},_setAccelKeyAttr:function(_b4f){this.accelKeyNode.style.display=_b4f?"":"none";this.accelKeyNode.innerHTML=_b4f;_b41.set(this.containerNode,"colSpan",_b4f?"1":"2");this._set("accelKey",_b4f);},_setTextDirAttr:function(_b50){if(!this._created||this.textDir!=_b50){this._set("textDir",_b50);this.applyTextDir(this.focusNode,this.label);}}});});},"url:dijit/templates/Menu.html":"<table class=\"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable\" role=\"menu\" tabIndex=\"${tabIndex}\"\n\t   data-dojo-attach-event=\"onkeypress:_onKeyPress\" cellspacing=\"0\">\n\t<tbody class=\"dijitReset\" data-dojo-attach-point=\"containerNode\"></tbody>\n</table>\n","dijit/form/NumberSpinner":function(){define("dijit/form/NumberSpinner",["dojo/_base/declare","dojo/_base/event","dojo/keys","./_Spinner","./NumberTextBox"],function(_b51,_b52,keys,_b53,_b54){return _b51("dijit.form.NumberSpinner",[_b53,_b54.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(val,_b55){var tc=this.constraints,v=isNaN(val),_b56=!isNaN(tc.max),_b57=!isNaN(tc.min);if(v&&_b55!=0){val=(_b55>0)?_b57?tc.min:_b56?tc.max:0:_b56?this.constraints.max:_b57?tc.min:0;}var _b58=val+_b55;if(v||isNaN(_b58)){return val;}if(_b56&&(_b58>tc.max)){_b58=tc.max;}if(_b57&&(_b58<tc.min)){_b58=tc.min;}return _b58;},_onKeyPress:function(e){if((e.charOrCode==keys.HOME||e.charOrCode==keys.END)&&!(e.ctrlKey||e.altKey||e.metaKey)&&typeof this.get("value")!="undefined"){var _b59=this.constraints[(e.charOrCode==keys.HOME?"min":"max")];if(typeof _b59=="number"){this._setValueAttr(_b59,false);}_b52.stop(e);}}});});},"dijit/form/FilteringSelect":function(){define("dijit/form/FilteringSelect",["dojo/data/util/filter","dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(_b5a,_b5b,lang,when,_b5c,_b5d){return _b5b("dijit.form.FilteringSelect",[_b5c,_b5d],{required:true,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened;},isValid:function(){return !!this.item||(!this.required&&this.get("displayedValue")=="");},_refreshState:function(){if(!this.searchTimer){this.inherited(arguments);}},_callbackSetLabel:function(_b5e,_b5f,_b60,_b61){if((_b5f&&_b5f[this.searchAttr]!==this._lastQuery)||(!_b5f&&_b5e.length&&this.store.getIdentity(_b5e[0])!=this._lastQuery)){return;}if(!_b5e.length){this.set("value","",_b61||(_b61===undefined&&!this.focused),this.textbox.value,null);}else{this.set("item",_b5e[0],_b61);}},_openResultList:function(_b62,_b63,_b64){if(_b63[this.searchAttr]!==this._lastQuery){return;}this.inherited(arguments);if(this.item===undefined){this.validate(true);}},_getValueAttr:function(){return this.valueNode.value;},_getValueField:function(){return "value";},_setValueAttr:function(_b65,_b66,_b67,item){if(!this._onChangeActive){_b66=null;}if(item===undefined){if(_b65===null||_b65===""){_b65="";if(!lang.isString(_b67)){this._setDisplayedValueAttr(_b67||"",_b66);return;}}var self=this;this._lastQuery=_b65;when(this.store.get(_b65),function(item){self._callbackSetLabel(item?[item]:[],undefined,undefined,_b66);});}else{this.valueNode.value=_b65;this.inherited(arguments);}},_setItemAttr:function(item,_b68,_b69){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value;},_getDisplayQueryString:function(text){return text.replace(/([\\\*\?])/g,"\\$1");},_setDisplayedValueAttr:function(_b6a,_b6b){if(_b6a==null){_b6a="";}if(!this._created){if(!("displayedValue" in this.params)){return;}_b6b=false;}if(this.store){this.closeDropDown();var _b6c=lang.clone(this.query);var qs=this._getDisplayQueryString(_b6a),q;if(this.store._oldAPI){q=qs;}else{q=_b5a.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_b6c[this.searchAttr]=q;this.textbox.value=_b6a;this._lastDisplayedValue=_b6a;this._set("displayedValue",_b6a);var _b6d=this;var _b6e={ignoreCase:this.ignoreCase,deep:true};lang.mixin(_b6e,this.fetchProperties);this._fetchHandle=this.store.query(_b6c,_b6e);when(this._fetchHandle,function(_b6f){_b6d._fetchHandle=null;_b6d._callbackSetLabel(_b6f||[],_b6c,_b6e,_b6b);},function(err){_b6d._fetchHandle=null;if(!_b6d._cancelingQuery){console.error("dijit.form.FilteringSelect: "+err.toString());}});}},undo:function(){this.set("displayedValue",this._lastDisplayedValue);}});});},"dijit/form/SimpleTextarea":function(){define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_b70,_b71,has,_b72){return _b70("dijit.form.SimpleTextarea",_b72,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){if(!this.value&&this.srcNodeRef){this.value=this.srcNodeRef.value;}this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);if(has("ie")&&this.cols){_b71.add(this.textbox,"dijitTextAreaCols");}},filter:function(_b73){if(_b73){_b73=_b73.replace(/\r/g,"");}return this.inherited(arguments);},_onInput:function(e){if(this.maxLength){var _b74=parseInt(this.maxLength);var _b75=this.textbox.value.replace(/\r/g,"");var _b76=_b75.length-_b74;if(_b76>0){var _b77=this.textbox;if(_b77.selectionStart){var pos=_b77.selectionStart;var cr=0;if(has("opera")){cr=(this.textbox.value.substring(0,pos).match(/\r/g)||[]).length;}this.textbox.value=_b75.substring(0,pos-_b76-cr)+_b75.substring(pos-cr);_b77.setSelectionRange(pos-_b76,pos-_b76);}else{if(this.ownerDocument.selection){_b77.focus();var _b78=this.ownerDocument.selection.createRange();_b78.moveStart("character",-_b76);_b78.text="";_b78.select();}}}}this.inherited(arguments);}});});},"esri/dijit/editing/tools/Selection":function(){define("esri/dijit/editing/tools/Selection",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Color","dojo/has","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/dijit/editing/tools/Edit","esri/dijit/editing/tools/SelectionTools","esri/dijit/editing/tools/DropDownToolBase","esri/kernel"],function(_b79,lang,_b7a,_b7b,_b7c,has,_b7d,_b7e,_b7f,Edit,_b80,_b81,_b82){var _b83=_b79([_b81],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:true,activate:function(){this.inherited(arguments);this._sConnect=_b7b.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");},deactivate:function(){this.inherited(arguments);_b7b.disconnect(this._sConnect);delete this._sConnect;},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"];},_onDrawEnd:function(_b84){this.inherited(arguments);this._settings.editor._hideAttributeInspector();var _b85=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(_b85,_b84,this._selectMethod,lang.hitch(this,"onFinished"));},_createSymbols:function(){this._pointSelectionSymbol=new _b7d(_b7d.STYLE_CIRCLE,10,new _b7e(_b7e.STYLE_SOLID,new _b7c([0,0,0]),1),new _b7c([255,0,0,0.5]));this._polylineSelectionSymbol=new _b7e(_b7e.STYLE_SOLID,new _b7c([0,200,255]),2);this._polygonSelectionSymbol=new _b7f(_b7f.STYLE_SOLID,new _b7e(_b7e.STYLE_SOLID,new _b7c([0,0,0]),1),new _b7c([0,200,255,0.5]));},_initializeLayers:function(){var _b86=this._settings.layers;_b7a.forEach(_b86,this._setSelectionSymbol,this);},_setSelectionSymbol:function(_b87){var _b88=null;switch(_b87.geometryType){case "esriGeometryPoint":_b88=this._pointSelectionSymbol;break;case "esriGeometryPolyline":_b88=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":_b88=this._polygonSelectionSymbol;break;}_b87.setSelectionSymbol(_b87._selectionSymbol||_b88);},_createTools:function(){_b7a.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments);},_createTool:function(_b89){var _b8a=lang.mixin(_b80[_b89],{settings:this._settings,onClick:lang.hitch(this,"onItemClicked",_b80[_b89].id)});this._tools[_b89.toUpperCase()]=new Edit(_b8a);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.Selection",_b83,_b82);}return _b83;});},"dijit/_editor/plugins/TextColor":function(){define("dijit/_editor/plugins/TextColor",["require","dojo/colors","dojo/_base/declare","dojo/_base/lang","../_Plugin","../../form/DropDownButton"],function(_b8b,_b8c,_b8d,lang,_b8e,_b8f){var _b90=_b8d("dijit._editor.plugins.TextColor",_b8e,{buttonClass:_b8f,useDefaultCommand:false,_initButton:function(){this.inherited(arguments);var self=this;this.button.loadDropDown=function(_b91){_b8b(["../../ColorPalette"],lang.hitch(this,function(_b92){this.dropDown=new _b92({dir:self.editor.dir,ownerDocument:self.editor.ownerDocument,value:self.value,onChange:function(_b93){self.editor.execCommand(self.command,_b93);}});_b91();}));};},updateState:function(){var _b94=this.editor;var _b95=this.command;if(!_b94||!_b94.isLoaded||!_b95.length){return;}if(this.button){var _b96=this.get("disabled");this.button.set("disabled",_b96);if(_b96){return;}var _b97;try{_b97=_b94.queryCommandValue(_b95)||"";}catch(e){_b97="";}}if(_b97==""){_b97="#000000";}if(_b97=="transparent"){_b97="#ffffff";}if(typeof _b97=="string"){if(_b97.indexOf("rgb")>-1){_b97=_b8c.fromRgb(_b97).toHex();}}else{_b97=((_b97&255)<<16)|(_b97&65280)|((_b97&16711680)>>>16);_b97=_b97.toString(16);_b97="#000000".slice(0,7-_b97.length)+_b97;}this.value=_b97;var _b98=this.button.dropDown;if(_b98&&_b97!==_b98.get("value")){_b98.set("value",_b97,false);}}});_b8e.registry["foreColor"]=function(){return new _b90({command:"foreColor"});};_b8e.registry["hiliteColor"]=function(){return new _b90({command:"hiliteColor"});};return _b90;});},"esri/dijit/editing/Delete":function(){define("esri/dijit/editing/Delete",["dojo/_base/declare","dojo/_base/lang","dojo/has","esri/kernel","esri/OperationBase","esri/dijit/editing/Add"],function(_b99,lang,has,_b9a,_b9b,Add){var _b9c=_b99(_b9b,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(_b9d){_b9d=_b9d||{};this._add=new Add({featureLayer:_b9d.featureLayer,addedGraphics:_b9d.deletedGraphics});},performUndo:function(){this._add.performRedo();},performRedo:function(){this._add.performUndo();}});if(has("extend-esri")){lang.setObject("dijit.editing.Delete",_b9c,_b9a);}return _b9c;});},"dijit/_MenuBase":function(){define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./a11yclick","./popup","./registry","./_Widget","./_KeyNavContainer","./_TemplatedMixin"],function(_b9e,_b9f,dom,_ba0,_ba1,lang,_ba2,on,_ba3,_ba4,pm,_ba5,_ba6,_ba7,_ba8){return _b9f("dijit._MenuBase",[_ba6,_ba8,_ba7],{parentMenu:null,popupDelay:500,autoFocus:false,childSelector:function(node){var _ba9=_ba5.byNode(node);return node.parentNode==this.containerNode&&_ba9&&_ba9.focus;},postCreate:function(){var self=this,_baa=typeof this.childSelector=="string"?this.childSelector:lang.hitch(this,"childSelector");this.own(on(this.containerNode,on.selector(_baa,_ba2.enter),function(){self.onItemHover(_ba5.byNode(this));}),on(this.containerNode,on.selector(_baa,_ba2.leave),function(){self.onItemUnhover(_ba5.byNode(this));}),on(this.containerNode,on.selector(_baa,_ba4),function(evt){self.onItemClick(_ba5.byNode(this),evt);evt.stopPropagation();evt.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _bab=this._getTopMenu();if(_bab&&_bab._isMenuBar){_bab.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _bac=this.currentPopup.parentMenu;if(_bac.focusedChild){_bac.focusedChild._setSelected(false);}_bac.focusedChild=this.currentPopup.from_item;_bac.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(item){if(this.isActive){this.focusChild(item);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=this.defer("_openPopup",this.popupDelay);}}if(this.focusedChild){this.focusChild(item);}this._hoveredChild=item;item._set("hovering",true);},_onChildBlur:function(item){this._stopPopupTimer();item._setSelected(false);var _bad=item.popup;if(_bad){this._stopPendingCloseTimer(_bad);_bad._pendingClose_timer=this.defer(function(){_bad._pendingClose_timer=null;if(_bad.parentMenu){_bad.parentMenu.currentPopup=null;}pm.close(_bad);},this.popupDelay);}},onItemUnhover:function(item){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==item){this._hoveredChild=null;}item._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){this.hover_timer=this.hover_timer.remove();}},_stopPendingCloseTimer:function(_bae){if(_bae._pendingClose_timer){_bae._pendingClose_timer=_bae._pendingClose_timer.remove();}},_stopFocusTimer:function(){if(this._focus_timer){this._focus_timer=this._focus_timer.remove();}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(item,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(item);if(item.disabled){return false;}if(item.popup){this._openPopup(evt.type=="keypress");}else{this.onExecute();item._onClick?item._onClick(evt):item.onClick(evt);}},_openPopup:function(_baf){this._stopPopupTimer();var _bb0=this.focusedChild;if(!_bb0){return;}var _bb1=_bb0.popup;if(!_bb1.isShowingNow){if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_bb1.parentMenu=this;_bb1.from_item=_bb0;var self=this;pm.open({parent:this,popup:_bb1,around:_bb0.domNode,orient:this._orient||["after","before"],onCancel:function(){self.focusChild(_bb0);self._cleanUp();_bb0._setSelected(true);self.focusedChild=_bb0;},onExecute:lang.hitch(this,"_cleanUp")});this.currentPopup=_bb1;_bb1.connect(_bb1.domNode,"onmouseenter",lang.hitch(self,"_onPopupHover"));}if(_baf&&_bb1.focus){_bb1._focus_timer=this.defer(lang.hitch(_bb1,function(){this._focus_timer=null;this.focus();}));}},_markActive:function(){this.isActive=true;_ba1.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_ba1.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_b9e.indexOf(this._focusManager.activeStack,this.id)>=0){_ba0.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(item){if(this._hoveredChild&&this._hoveredChild!=item){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});},"dijit/_editor/selection":function(){define("dijit/_editor/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window","../main"],function(dom,lang,has,win,_bb2){var _bb3={getType:function(){if(win.doc.getSelection){var _bb4="text";var oSel;try{oSel=win.global.getSelection();}catch(e){}if(oSel&&oSel.rangeCount==1){var _bb5=oSel.getRangeAt(0);if((_bb5.startContainer==_bb5.endContainer)&&((_bb5.endOffset-_bb5.startOffset)==1)&&(_bb5.startContainer.nodeType!=3)){_bb4="control";}}return _bb4;}else{return win.doc.selection.type.toLowerCase();}},getSelectedText:function(){if(win.doc.getSelection){var _bb6=win.global.getSelection();return _bb6?_bb6.toString():"";}else{if(_bb2._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().text;}},getSelectedHtml:function(){if(win.doc.getSelection){var _bb7=win.global.getSelection();if(_bb7&&_bb7.rangeCount){var i;var html="";for(i=0;i<_bb7.rangeCount;i++){var frag=_bb7.getRangeAt(i).cloneContents();var div=win.doc.createElement("div");div.appendChild(frag);html+=div.innerHTML;}return html;}return null;}else{if(_bb2._editor.selection.getType()=="control"){return null;}return win.doc.selection.createRange().htmlText;}},getSelectedElement:function(){if(_bb2._editor.selection.getType()=="control"){if(win.doc.getSelection){var _bb8=win.global.getSelection();return _bb8.anchorNode.childNodes[_bb8.anchorOffset];}else{var _bb9=win.doc.selection.createRange();if(_bb9&&_bb9.item){return win.doc.selection.createRange().item(0);}}}return null;},getParentElement:function(){if(_bb2._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(win.doc.getSelection){var _bba=win.global.getSelection();if(_bba){var node=_bba.anchorNode;while(node&&(node.nodeType!=1)){node=node.parentNode;}return node;}}else{var r=win.doc.selection.createRange();r.collapse(true);return r.parentElement();}}return null;},hasAncestorElement:function(_bbb){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_bbc){var node=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(node,arguments);},isTag:function(node,tags){if(node&&node.tagName){var _bbd=node.tagName.toLowerCase();for(var i=0;i<tags.length;i++){var _bbe=String(tags[i]).toLowerCase();if(_bbd==_bbe){return _bbe;}}}return "";},getParentOfType:function(node,tags){while(node){if(this.isTag(node,tags).length){return node;}node=node.parentNode;}return null;},collapse:function(_bbf){if(win.doc.getSelection){var _bc0=win.global.getSelection();if(_bc0.removeAllRanges){if(_bbf){_bc0.collapseToStart();}else{_bc0.collapseToEnd();}}else{_bc0.collapse(_bbf);}}else{var _bc1=win.doc.selection.createRange();_bc1.collapse(_bbf);_bc1.select();}},remove:function(){var sel=win.doc.selection;if(win.doc.getSelection){sel=win.global.getSelection();sel.deleteFromDocument();return sel;}else{if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}},selectElementChildren:function(_bc2,_bc3){var doc=win.doc;var _bc4;_bc2=dom.byId(_bc2);if(win.doc.getSelection){var _bc5=win.global.getSelection();if(has("opera")){if(_bc5.rangeCount){_bc4=_bc5.getRangeAt(0);}else{_bc4=doc.createRange();}_bc4.setStart(_bc2,0);_bc4.setEnd(_bc2,(_bc2.nodeType==3)?_bc2.length:_bc2.childNodes.length);_bc5.addRange(_bc4);}else{_bc5.selectAllChildren(_bc2);}}else{_bc4=_bc2.ownerDocument.body.createTextRange();_bc4.moveToElementText(_bc2);if(!_bc3){try{_bc4.select();}catch(e){}}}},selectElement:function(_bc6,_bc7){var _bc8;_bc6=dom.byId(_bc6);var doc=_bc6.ownerDocument;var _bc9=win.global;if(doc.getSelection){var _bca=_bc9.getSelection();_bc8=doc.createRange();if(_bca.removeAllRanges){if(has("opera")){if(_bca.getRangeAt(0)){_bc8=_bca.getRangeAt(0);}}_bc8.selectNode(_bc6);_bca.removeAllRanges();_bca.addRange(_bc8);}}else{try{var tg=_bc6.tagName?_bc6.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){_bc8=win.body(doc).createControlRange();}else{_bc8=win.body(doc).createRange();}_bc8.addElement(_bc6);if(!_bc7){_bc8.select();}}catch(e){this.selectElementChildren(_bc6,_bc7);}}},inSelection:function(node){if(node){var _bcb;var doc=win.doc;var _bcc;if(win.doc.getSelection){var sel=win.global.getSelection();if(sel&&sel.rangeCount>0){_bcc=sel.getRangeAt(0);}if(_bcc&&_bcc.compareBoundaryPoints&&doc.createRange){try{_bcb=doc.createRange();_bcb.setStart(node,0);if(_bcc.compareBoundaryPoints(_bcc.START_TO_END,_bcb)===1){return true;}}catch(e){}}}else{_bcc=doc.selection.createRange();try{_bcb=node.ownerDocument.body.createControlRange();if(_bcb){_bcb.addElement(node);}}catch(e1){try{_bcb=node.ownerDocument.body.createTextRange();_bcb.moveToElementText(node);}catch(e2){}}if(_bcc&&_bcb){if(_bcc.compareEndPoints("EndToStart",_bcb)===1){return true;}}}}return false;}};lang.setObject("dijit._editor.selection",_bb3);return _bb3;});},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","esri/layers/FeatureLayer","esri/toolbars/draw","esri/kernel"],function(lang,has,_bcd,Draw,_bce){var _bcf={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bcd.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bcd.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:Draw.EXTENT,_selectMethod:_bcd.SELECTION_SUBTRACT,_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:false,_label:"NLS_selectionClearLbl"}};if(has("extend-esri")){lang.setObject("dijit.editing.tools.SelectionTools",_bcf,_bce);}return _bcf;});},"esri/dijit/editing/tools/ButtonToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","dijit/form/Button","esri/dijit/editing/tools/ToolBase","esri/kernel"],function(_bd0,lang,has,_bd1,_bd2,_bd3){var BTB=_bd0([_bd1,_bd2],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);if(this._setShowLabelAttr){this._setShowLabelAttr(false);}},destroy:function(){_bd1.prototype.destroy.apply(this,arguments);_bd2.prototype.destroy.apply(this,arguments);}});if(has("extend-esri")){lang.setObject("dijit.editing.tools.ButtonToolBase",BTB,_bd3);}return BTB;});},"esri/dijit/editing/TemplatePicker":function(){define(["require","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/html","dojo/_base/array","dojo/_base/json","dojo/_base/kernel","dojo/has","dojo/query","dojo/sniff","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_Widget","dijit/_Templated","dojo/data/ItemFileReadStore","dojox/grid/DataGrid","dojox/gfx","esri/layers/FeatureLayer","esri/symbols/PictureMarkerSymbol","esri/dijit/editing/TemplatePickerItem","esri/kernel","esri/lang","esri/request","dojo/i18n!esri/nls/jsapi","dojo/text!esri/dijit/editing/templates/TemplatePicker.html"],function(_bd4,_bd5,lang,_bd6,html,_bd7,_bd8,_bd9,has,_bda,_bdb,_bdc,_bdd,_bde,_bdf,_be0,_be1,_be2,_be3,gfx,_be4,_be5,_be6,_be7,_be8,_be9,_bea,_beb){var TP=_bd5([_be0,_be1],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:true,templateString:_beb,basePath:_bd4.toUrl("esri/dijit/editing")+"/",featureLayers:null,items:null,grouping:true,showTooltip:false,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:true,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(_bec,_bed){_bec=_bec||{};if(!_bec.items&&!_bec.featureLayers){console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");}this._dojo14x=(_bd9.version.minor>=4);this._itemWidgets={};if(_bec.featureLayers&&_bec.featureLayers.length){this._flChanged=1;}this._nls=_bea.widgets.templatePicker;this.emptyMessage=_bec.emptyMessage||(this._nls&&this._nls.creationDisabled)||"";},postMixInProperties:function(){this.inherited(arguments);this._preprocess();},startup:function(){this.inherited(arguments);if(this.rows==="auto"&&this.columns==="auto"){var box=_bde.getContentBox(this.domNode);if(!box.w){this.domNode.style.width=this._initialAutoWidth+"px";}if(!box.h){this.domNode.style.height=this._initialAutoHeight+"px";}box=_bde.getContentBox(this.domNode);this._columns=Math.floor(box.w/this._assumedCellWidth)||1;}this._applyGridPatches();this._setGridLayout();_bd6.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();if(has("ie")<9){this._repaintItems=lang.hitch(this,this._repaintItems);setTimeout(this._repaintItems,this._ieTimer);}},destroy:function(){this.showTooltip=false;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments);},getSelected:function(){return this._selectedCell?this._selectedItem:null;},clearSelection:function(){var _bee=this._selectedCell,info=this._selectedInfo;if(_bee){this._rowClicked({cellNode:_bee,rowIndex:info.selRow,cellIndex:info.selCol});}},update:function(_bef){var _bf0=(this.rows==="auto"&&this.columns==="auto"&&_bef)?true:false,grid=this.grid,box;if(_bf0){var _bf1=this.domNode,id=_bf1.id,_bf2,item=_bd9.query("#"+id+".templatePicker div.item")[0];box=_bde.getContentBox(_bf1);item=item&&item.parentNode;if(item){_bf2=html.coords(item).w;}else{_bf2=this._assumedCellWidth;}this._columns=Math.floor((box.w-grid.views.views[0].getScrollbarWidth())/_bf2);this._columns=this._columns||1;}var _bf3=this._rows;this._preprocess();var _bf4=this._rows;this._setGridLayout();this._setGridData();if(_bf4!==_bf3){grid.set("autoHeight",this._rows,false);}if(_bf0){grid._resize({w:box.w,h:box.h});grid.viewsHeaderNode.style.display="none";}else{grid.update();}this._toggleTooltip();var self=this,_bf5=this.getSelected();if(_bf5){grid.store.fetch({onComplete:function(its){var _bf6=self._locate(_bf5,self._selectedInfo,its);var _bf7=_bf6&&grid.views.views[0].getCellNode(_bf6[0],_bf6[1]);if(_bf7){self._rowClicked({cellNode:_bf7,rowIndex:_bf6[0],cellIndex:_bf6[1]},true);}}});}if(has("ie")<9){setTimeout(this._repaintItems,this._ieTimer);}var _bf8=this.featureLayers,_bf9=this.items;if((!_bf8||!_bf8.length)&&(!_bf9||!_bf9.length)&&grid&&this.emptyMessage){grid.showMessage(this.emptyMessage);}},onSelectionChange:function(){},_setUseLegendAttr:function(use){var _bfa=this.useLegend;if(!this._started||_bfa!==use){if(use){this._flChanged=1;}else{this._clearLegendInfo();}}this.useLegend=use;},_setFeatureLayersAttr:function(_bfb){var _bfc=this.featureLayers;if(!this._started||_bfc!==_bfb){this._flChanged=1;}this.featureLayers=_bfb;},_adjustRowsCols:function(_bfd){if(this.rows==="auto"&&this.columns==="auto"){if(!this._started){this._rows=false;this._columns=null;this._autoWidth=false;}return;}var len=0;this._rows=this.rows;this._columns=this.columns;if(this.rows==="auto"){if(this.featureLayers){if(this.grouping){len=_bfd.length;_bd7.forEach(_bfd,function(_bfe){len+=Math.ceil(_bfe.length/this.columns);},this);}else{_bd7.forEach(_bfd,function(_bff){len+=_bff.length;},this);len=Math.ceil(len/this.columns);}}else{len=Math.ceil(_bfd.length/this.columns);}this._rows=len;}else{if(this.columns==="auto"){if(this.featureLayers){if(this.grouping){len=3;}else{_bd7.forEach(_bfd,function(_c00){len+=_c00.length;},this);len=Math.ceil(len/this.rows);}}else{len=Math.ceil(_bfd.length/this.rows);}this._columns=len;}}},_preprocess:function(){if(this.items){this.grouping=false;}this._autoWidth=false;if(this.rows==="auto"||this.columns==="auto"){this._autoWidth=true;}var _c01;if(this.featureLayers){if(this.useLegend&&this._flChanged){this._legendIndices=[];this._loadingIndices=[];this._legendSymbols={};this._ignoreLegends();this._loadingLegends=[];clearTimeout(this._legendTimer);this._legendTimer=null;this._processSelectionLayers();this._flChanged=0;}if(_bd7.every(this.featureLayers,function(_c02){return _c02.loaded;})){_c01=this._flItems=this._getItemsFromLayers(this.featureLayers);this._adjustRowsCols(_c01);}else{var _c03=this.featureLayers.length;var _c04=[];_bd7.forEach(this.featureLayers,function(_c05){if(_c05.loaded){_c03--;_c04.push(_c05);}else{var _c06=_bd6.connect(_c05,"onLoad",this,function(_c07){_bd6.disconnect(_c06);_c06=null;_c03--;_c04.push(_c07);if(!_c03){_c01=this._flItems=this._getItemsFromLayers(_c04);this._adjustRowsCols(_c01);this.update();}});}},this);}}else{_c01=this._itItems=this._getItemsFromItems(this.items);this._adjustRowsCols(_c01);}},_processSelectionLayers:function(){var map,_c08,info,_c09,key,_c0a,_c0b,_c0c={};_bd7.forEach(this.featureLayers,function(_c0d,idx){if(_c0d.mode===_be4.MODE_SELECTION&&_c0d._map&&_c0d.url&&_c0d._params.drawMode&&!_c0d.source){_c08=lang.trim(_c0d._url.path).replace(/\/(MapServer|FeatureServer).*/ig,"/MapServer").replace(/^https?:\/\//ig,"").toLowerCase();info=(_c0c[_c08]=_c0c[_c08]||{});_c09=(info.featureLayers=info.featureLayers||{});_c0a=(info.indices=info.indices||[]);_c09[idx]=_c0d;_c0a.push(idx);map=_c0d._map;}});if(map){_bd7.forEach(map.layerIds,function(_c0e){_c0e=map.getLayer(_c0e);if(_c0e&&_c0e.url&&(_c0e.getImageUrl||_c0e.getTileUrl)&&_c0e.loaded&&_c0e.version>=10.1){_c08=lang.trim(_c0e._url.path).replace(/(\/MapServer).*/ig,"$1");key=_c08.replace(/^https?:\/\//ig,"").toLowerCase();if(_c0c[key]&&(!_c0c[key].mapServiceUrl)){info=_c0c[key];info.mapServiceUrl=_c08;info.mapServiceLayer=_c0e;this._legendIndices=this._legendIndices.concat(info.indices);_c0b=this._fetchLegend({pickerInstance:this,info:info},key);if(_c0b.then){this._loadingIndices=this._loadingIndices.concat(info.indices);this._loadingLegends.push(_c0b);}else{this._processLegendResponse(_c0b,info);}}}},this);}},_fetchLegend:function(_c0f,key){var _c10=TP.prototype,_c11=_c10.legendCache[key];if(!_c11){_c11=(_c10.legendCache[key]=_be9({url:_c0f.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}));_c11._contexts=[_c0f];_c11.addBoth(function(_c12){if(_c11.canceled){return;}_c10.legendCache[key]=_c12;var _c13=_c11._contexts;_c11._contexts=null;_bd7.forEach(_c13,function(ctxt){var _c14=ctxt.pickerInstance,info=ctxt.info,_c15;if(_c14._destroyed){return;}_bd7.forEach(info.indices,function(idx){_c15=_bd7.indexOf(_c14._loadingIndices,idx);if(_c15>-1){_c14._loadingIndices.splice(_c15,1);}});_c15=_bd7.indexOf(_c14._loadingLegends,_c11);if(_c15>-1){_c14._loadingLegends.splice(_c15,1);}_c14._processLegendResponse(_c12,info);});});}else{if(_c11.then){_c11._contexts.push(_c0f);}}return _c11;},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null;},_ignoreLegends:function(){if(this._loadingLegends){_bd7.forEach(this._loadingLegends,function(_c16){var _c17=-1;_bd7.some(_c16._contexts,function(ctxt,idx){if(ctxt.pickerInstance===this){_c17=idx;}return (_c17>-1);},this);if(_c17>-1){_c16._contexts.splice(_c17,1);}},this);}},_processLegendResponse:function(_c18,info){if(_c18&&!(_c18 instanceof Error)){_bd7.forEach(info.indices,function(idx){var _c19=info.featureLayers[idx].layerId,i,_c1a=info.mapServiceUrl+"/"+_c19+"/images/",_c1b=info.mapServiceLayer._getToken(),_c1c,obj,_c1d,url;if(this._legendSymbols[idx]){return;}_c1c=null;_bd7.some(_c18.layers,function(_c1e){if(_c1e.layerId==_c19){_c1c=_c1e;}return !!_c1c;});if(_c1c){obj=(this._legendSymbols[idx]={});_bd7.forEach(_c1c.legend,function(_c1f){_c1d=_c1f.values;if(_c1d&&_c1d.length){for(i=0;i<_c1d.length;i++){obj[_c1d[i]]=_c1f;}}else{obj.defaultSymbol=_c1f;}url=_c1f.url;if(url&&!_c1f._fixed){_c1f._fixed=1;if((url.search(/https?\:/)===-1)){_c1f.url=_c1a+url;}if(_c1b&&_c1f.url.search(/https?\:/)!==-1){_c1f.url+=(((_c1f.url.indexOf("?")>-1)?"&":"?")+"token="+_c1b);}}});}},this);}else{var _c20;_bd7.forEach(info.indices,function(idx){_c20=_bd7.indexOf(this._legendIndices,idx);if(_c20>-1){this._legendIndices.splice(_c20,1);}},this);}var self=this;if(self._started&&!self._legendTimer){self._legendTimer=setTimeout(function(){clearTimeout(self._legendTimer);self._legendTimer=null;if(!self._destroyed){self.update();}},0);}},_applyGridPatches:function(){var grid=this.grid;var _c21=grid.adaptWidth,_c22,i,view;grid.adaptWidth=function(){_c22=this.views.views;for(i=0;view=_c22[i];i++){_bdf.set(view.headerNode,"display","block");}_c21.apply(this,arguments);for(i=0;view=_c22[i];i++){_bdf.set(view.headerNode,"display","none");}};if(this._dojo14x){if(this.rows!=="auto"&&this.columns!=="auto"){var _c23=_bd6.connect(grid,"_onFetchComplete",this,function(){_bd6.disconnect(_c23);this.grid.set("autoHeight",this._rows);});}_bd6.connect(grid,"_onDelete",this,this._destroyItems);_bd6.connect(grid,"_clearData",this,this._destroyItems);_bd6.connect(grid,"destroy",this,this._destroyItems);var _c24=grid.focus;if(_c24&&_c24.findAndFocusGridCell){_c24.findAndFocusGridCell=function(){return false;};}}},_setGridLayout:function(){var _c25=function(_c26){return function(_c27,_c28){return this._cellGet(_c26,_c27,_c28);};};var _c29=lang.hitch(this,this._cellFormatter),_c2a=[],cols=this._columns,i;for(i=0;i<cols;i++){_c2a.push({field:"cell"+i,get:lang.hitch(this,_c25(i)),formatter:_c29});}var _c2b={cells:[_c2a]};if(this.grouping){var _c2c={field:"groupName",colSpan:cols,get:lang.hitch(this,this._cellGetGroup),formatter:lang.hitch(this,this._cellGroupFormatter)};_c2b.cells.push([_c2c]);}var grid=this.grid,_c2d=_be3.prototype.rowsPerPage;grid.set("rowsPerPage",(this._rows>_c2d)?this._rows:_c2d);grid.set("structure",_c2b);},_setGridData:function(){var _c2e=[];if(this.grouping){this._groupRowIndices=[];var _c2f,_c30,cols=this._columns;_bd7.forEach(this._flItems,function(_c31,idx){_c2e.push({});var _c32=(idx===0)?0:(_c2f+_c30+1);this._groupRowIndices.push(_c32);_c2f=_c32;_c30=Math.ceil(_c31.length/cols);_c2e=_c2e.concat(this._getStoreItems(_c31));},this);}else{if(this.featureLayers){_bd7.forEach(this._flItems,function(_c33){_c2e=_c2e.concat(_c33);});_c2e=this._getStoreItems(_c2e);}else{_c2e=this._getStoreItems(this._itItems);}}var _c34=new _be2({data:{items:_c2e}});this.grid.setStore(_c34);},_toggleTooltip:function(){if(this.showTooltip){if(this.tooltip){return;}this.tooltip=_bdd.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var grid=this.grid;this._mouseOverConnect=_bd6.connect(grid,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=_bd6.connect(grid,"onCellMouseOut",this,this._cellMouseOut);}else{if(this.tooltip){_bd6.disconnect(this._mouseOverConnect);_bd6.disconnect(this._mouseOutConnect);_bdd.destroy(this.tooltip);this.tooltip=null;}}},_rowClicked:function(evt,_c35){var _c36=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_c36,row,col);if(!cell){return;}var _c37=this.grid.store;if(_c37.getValue(cell,"loadingCell")){return;}if(this._selectedCell){_bdc.remove(this._selectedCell,"selectedItem");}if(_c36!==this._selectedCell){_bdc.add(_c36,"selectedItem");this._selectedCell=_c36;this._selectedItem={featureLayer:_c37.getValue(cell,"layer"),type:_c37.getValue(cell,"type"),template:_c37.getValue(cell,"template"),symbolInfo:_c37.getValue(cell,"symbolInfo"),item:this._getItem(cell)};this._selectedInfo={selRow:row,selCol:col,index1:_c37.getValue(cell,"index1"),index2:_c37.getValue(cell,"index2"),index:_c37.getValue(cell,"index")};}else{this._selectedCell=this._selectedInfo=this._selectedItem=null;}if(!_c35){this.onSelectionChange();}},_locate:function(_c38,info,_c39){var _c3a=this.grid.store,cols=new Array(this._columns);var _c3b,_c3c=info.index1,_c3d=info.index2,_c3e=info.index,item=_c38.item;_bd7.some(_c39,function(_c3f,_c40){return _bd7.some(cols,function(_c41,_c42){var cell=_c3a.getValue(_c3f,"cell"+_c42);if(cell&&(item?(_c3e===_c3a.getValue(cell,"index")):(_c3c===_c3a.getValue(cell,"index1")&&_c3d===_c3a.getValue(cell,"index2")))){_c3b=[_c40,_c42];return true;}else{return false;}});});return _c3b;},_getCellInfo:function(_c43,row,col){if(!_c43){return;}var grid=this.grid;var item=grid.getItem(row);var cell=grid.store.getValue(item,"cell"+col);return cell;},_getItem:function(cell){var _c44=this.items;if(_c44){return _c44[this.grid.store.getValue(cell,"index")];}},_cellMouseOver:function(evt){var _c45=this.tooltip;var _c46=evt.cellNode,row=evt.rowIndex,col=evt.cellIndex;var cell=this._getCellInfo(_c46,row,col);if(_c45&&cell){var _c47=this.grid.store;var _c48=_c47.getValue(cell,"template");var type=_c47.getValue(cell,"type");var _c49=_c47.getValue(cell,"symbolInfo");var _c4a=_c47.getValue(cell,"layer");var item=this._getItem(cell);var _c4b=(item&&(item.label+(item.description?(": "+item.description):"")))||(_c48&&(_c48.name+(_c48.description?(": "+_c48.description):"")))||(type&&type.name)||(_c49&&(_c49.label+(_c49.description?(": "+_c49.description):"")))||((_c4a&&_c4a.name+": ")+"Default");_c45.style.display="none";_c45.innerHTML=_c4b;var _c4c=html.coords(_c46.firstChild);_bdf.set(_c45,{left:(_c4c.x)+"px",top:(_c4c.y+_c4c.h+5)+"px"});_c45.style.display="";}},_cellMouseOut:function(){var _c4d=this.tooltip;if(_c4d){_c4d.style.display="none";}},_destroyItems:function(){var _c4e=this._itemWidgets,w;for(w in _c4e){if(!_c4e[w]){continue;}_c4e[w].destroy();delete _c4e[w];}},_repaintItems:function(){var _c4f=this._itemWidgets,w;for(w in _c4f){var _c50=_c4f[w];if(_c50){_c50._repaint(_c50._surface);}}},_getStoreItems:function(_c51){var uid=this._uniqueId;_c51=_bd7.map(_c51,function(item){return lang.mixin({"surfaceId":"tpick-surface-"+(uid.id++)},item);});var len=_c51.length,_c52=0,obj={},k=0,prop,_c53=[],flag=true,cols=this._columns;while(_c52<len){flag=true;prop="cell"+k;obj[prop]=_c51[_c52];_c52++;k++;if(k%cols===0){flag=false;_c53.push(obj);obj={};k=0;}}if(flag&&len){_c53.push(obj);}return _c53;},_getItemsFromLayers:function(_c54){var _c55=[];_bd7.forEach(_c54,function(_c56,_c57){_c55.push(this._getItemsFromLayer(_c56,_c57));},this);return _c55;},_getItemsFromLayer:function(_c58,_c59){var _c5a=[];if(this.useLegend&&_bd7.indexOf(this._loadingIndices,_c59)>-1){return [{label:(this._nls&&this._nls.loading)||"",symbol:null,layer:_c58,type:null,template:null,index1:_c59,index2:0,loadingCell:1}];}var _c5b=[];_c5b=_c5b.concat(_c58.templates);_bd7.forEach(_c58.types,function(_c5c){var _c5d=_c5c.templates;_bd7.forEach(_c5d,function(_c5e){_c5e._type_=_c5c;});_c5b=_c5b.concat(_c5d);});_c5b=_bd7.filter(_c5b,_be8.isDefined);var _c5f=_c58.renderer;if(_c5f){var _c60=_c5f.declaredClass.replace("esri.renderer.","");if(_c5b.length>0){_bd7.forEach(_c5b,function(_c61){var _c62=_c61.prototype;if(_c62){var _c63=_c5f.getSymbol(_c62);if(_c63){var _c64=null,pms,_c65;if(this.useLegend&&_bd7.indexOf(this._legendIndices,_c59)>-1){_c65=this._legendSymbols&&this._legendSymbols[_c59];if(_c65){switch(_c60){case "SimpleRenderer":_c64=_c65.defaultSymbol;break;case "UniqueValueRenderer":_bd7.some(_c5f.infos,function(info){if(info.symbol===_c63){_c64=_c65[info.value];}return !!_c64;});break;case "ClassBreaksRenderer":_bd7.some(_c5f.infos,function(info){if(info.symbol===_c63){_c64=_c65[info.maxValue];}return !!_c64;});break;}}if(_c64){pms=_bd8.fromJson(_bd8.toJson(_be5.defaultProps));pms.url=_c64.url;pms.imageData=_c64.imageData;pms.contentType=_c64.contentType;pms.width=_c64.width;pms.height=_c64.height;if(!_be8.isDefined(pms.width)||!_be8.isDefined(pms.height)){pms.width=15;pms.height=15;}_c64=new _be5(pms);}}_c5a.push({label:this._trimLabel(_c61.name),symbol:_c64||_c63,legendOverride:!!_c64,layer:_c58,type:_c61._type_,template:_c61,index1:_c59,index2:_c5a.length});}}delete _c61._type_;},this);}else{var _c66=[];if(_c60==="TemporalRenderer"){_c5f=_c5f.observationRenderer;if(_c5f){_c60=_c5f.declaredClass.replace("esri.renderer.","");}}switch(_c60){case "SimpleRenderer":_c66=[{symbol:_c5f.symbol,label:_c5f.label,description:_c5f.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":_c66=_c5f.infos;break;}_c5a=_bd7.map(_c66,function(info,idx){return {label:this._trimLabel(info.label),description:info.description,symbolInfo:lang.mixin({constructor:function(){}},info),symbol:info.symbol,layer:_c58,index1:_c59,index2:idx};},this);}}return _c5a;},_getItemsFromItems:function(_c67){return _bd7.map(_c67,function(item,idx){item=lang.mixin({index:idx},item);item.label=this._trimLabel(item.label);return item;},this);},_trimLabel:function(_c68){var max=this.maxLabelLength;if(max&&_c68){if(_c68.length>max){_c68=_c68.substr(0,max)+"...";}}return _c68||"";},_cellGet:function(_c69,_c6a,_c6b){if(!_c6b){return "";}return this.grid.store.getValue(_c6b,"cell"+_c69);},_cellFormatter:function(_c6c){if(_c6c){var _c6d=this._itemWidgets,_c6e=this.grid.store;var sid=_c6e.getValue(_c6c,"surfaceId");var w=_c6d[sid];if(!w){w=(_c6d[sid]=new _be6({id:sid,label:_c6e.getValue(_c6c,"label"),symbol:_c6e.getValue(_c6c,"symbol"),legendOverride:_c6e.getValue(_c6c,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:_c6e.getValue(_c6c,"template")}));}return w||"";}else{return "";}},_cellGetGroup:function(_c6f,_c70){if(!this._groupRowIndices){return "";}var _c71=_bd7.indexOf(this._groupRowIndices,_c6f);if(!_c70||_c71===-1){return "";}return (this.featureLayers[_c71]&&this.featureLayers[_c71].name)||"";},_cellGroupFormatter:function(_c72){if(_c72){return "<div class='groupLabel'>"+_c72+"</div>";}else{return "";}}});if(has("extend-esri")){lang.setObject("dijit.editing.TemplatePicker",TP,_be7);}return TP;});},"dojo/data/ItemFileReadStore":function(){define(["../_base/kernel","../_base/lang","../_base/declare","../_base/array","../_base/xhr","../Evented","./util/filter","./util/simpleFetch","../date/stamp"],function(_c73,lang,_c74,_c75,xhr,_c76,_c77,_c78,_c79){var _c7a=_c74("dojo.data.ItemFileReadStore",[_c76],{constructor:function(_c7b){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._jsonFileUrl=_c7b.url;this._ccUrl=_c7b.url;this.url=_c7b.url;this._jsonData=_c7b.data;this.data=null;this._datatypeMap=_c7b.typeMap||{};if(!this._datatypeMap["Date"]){this._datatypeMap["Date"]={type:Date,deserialize:function(_c7c){return _c79.fromISOString(_c7c);}};}this._features={"dojo.data.api.Read":true,"dojo.data.api.Identity":true};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=false;this._queuedFetches=[];if(_c7b.urlPreventCache!==undefined){this.urlPreventCache=_c7b.urlPreventCache?true:false;}if(_c7b.hierarchical!==undefined){this.hierarchical=_c7b.hierarchical?true:false;}if(_c7b.clearOnClose){this.clearOnClose=true;}if("failOk" in _c7b){this.failOk=_c7b.failOk?true:false;}},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:false,urlPreventCache:false,failOk:false,hierarchical:true,_assertIsItem:function(item){if(!this.isItem(item)){throw new Error(this.declaredClass+": Invalid item argument.");}},_assertIsAttribute:function(_c7d){if(typeof _c7d!=="string"){throw new Error(this.declaredClass+": Invalid attribute argument.");}},getValue:function(item,_c7e,_c7f){var _c80=this.getValues(item,_c7e);return (_c80.length>0)?_c80[0]:_c7f;},getValues:function(item,_c81){this._assertIsItem(item);this._assertIsAttribute(_c81);return (item[_c81]||[]).slice(0);},getAttributes:function(item){this._assertIsItem(item);var _c82=[];for(var key in item){if((key!==this._storeRefPropName)&&(key!==this._itemNumPropName)&&(key!==this._rootItemPropName)&&(key!==this._reverseRefMap)){_c82.push(key);}}return _c82;},hasAttribute:function(item,_c83){this._assertIsItem(item);this._assertIsAttribute(_c83);return (_c83 in item);},containsValue:function(item,_c84,_c85){var _c86=undefined;if(typeof _c85==="string"){_c86=_c77.patternToRegExp(_c85,false);}return this._containsValue(item,_c84,_c85,_c86);},_containsValue:function(item,_c87,_c88,_c89){return _c75.some(this.getValues(item,_c87),function(_c8a){if(_c8a!==null&&!lang.isObject(_c8a)&&_c89){if(_c8a.toString().match(_c89)){return true;}}else{if(_c88===_c8a){return true;}}});},isItem:function(_c8b){if(_c8b&&_c8b[this._storeRefPropName]===this){if(this._arrayOfAllItems[_c8b[this._itemNumPropName]]===_c8b){return true;}}return false;},isItemLoaded:function(_c8c){return this.isItem(_c8c);},loadItem:function(_c8d){this._assertIsItem(_c8d.item);},getFeatures:function(){return this._features;},getLabel:function(item){if(this._labelAttr&&this.isItem(item)){return this.getValue(item,this._labelAttr);}return undefined;},getLabelAttributes:function(item){if(this._labelAttr){return [this._labelAttr];}return null;},filter:function(_c8e,_c8f,_c90){var _c91=[],i,key;if(_c8e.query){var _c92,_c93=_c8e.queryOptions?_c8e.queryOptions.ignoreCase:false;var _c94={};for(key in _c8e.query){_c92=_c8e.query[key];if(typeof _c92==="string"){_c94[key]=_c77.patternToRegExp(_c92,_c93);}else{if(_c92 instanceof RegExp){_c94[key]=_c92;}}}for(i=0;i<_c8f.length;++i){var _c95=true;var _c96=_c8f[i];if(_c96===null){_c95=false;}else{for(key in _c8e.query){_c92=_c8e.query[key];if(!this._containsValue(_c96,key,_c92,_c94[key])){_c95=false;}}}if(_c95){_c91.push(_c96);}}_c90(_c91,_c8e);}else{for(i=0;i<_c8f.length;++i){var item=_c8f[i];if(item!==null){_c91.push(item);}}_c90(_c91,_c8e);}},_fetchItems:function(_c97,_c98,_c99){var self=this;if(this._loadFinished){this.filter(_c97,this._getItemsArray(_c97.queryOptions),_c98);}else{if(this._jsonFileUrl!==this._ccUrl){_c73.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_c97,filter:lang.hitch(self,"filter"),findCallback:lang.hitch(self,_c98)});}else{this._loadInProgress=true;var _c9a={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _c9b=xhr.get(_c9a);_c9b.addCallback(function(data){try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;self.filter(_c97,self._getItemsArray(_c97.queryOptions),_c98);self._handleQueuedFetches();}catch(e){self._loadFinished=true;self._loadInProgress=false;_c99(e,_c97);}});_c9b.addErrback(function(_c9c){self._loadInProgress=false;_c99(_c9c,_c97);});var _c9d=null;if(_c97.abort){_c9d=_c97.abort;}_c97.abort=function(){var df=_c9b;if(df&&df.fired===-1){df.cancel();df=null;}if(_c9d){_c9d.call(_c97);}};}}else{if(this._jsonData){try{this._loadFinished=true;this._getItemsFromLoadedData(this._jsonData);this._jsonData=null;self.filter(_c97,this._getItemsArray(_c97.queryOptions),_c98);}catch(e){_c99(e,_c97);}}else{_c99(new Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),_c97);}}}},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var i=0;i<this._queuedFetches.length;i++){var _c9e=this._queuedFetches[i],_c9f=_c9e.args,_ca0=_c9e.filter,_ca1=_c9e.findCallback;if(_ca0){_ca0(_c9f,this._getItemsArray(_c9f.queryOptions),_ca1);}else{this.fetchItemByIdentity(_c9f);}}this._queuedFetches=[];}},_getItemsArray:function(_ca2){if(_ca2&&_ca2.deep){return this._arrayOfAllItems;}return this._arrayOfTopLevelItems;},close:function(_ca3){if(this.clearOnClose&&this._loadFinished&&!this._loadInProgress){if(((this._jsonFileUrl==""||this._jsonFileUrl==null)&&(this.url==""||this.url==null))&&this.data==null){console.debug(this.declaredClass+": WARNING!  Data reload "+" information has not been provided."+"  Please set 'url' or 'data' to the appropriate value before"+" the next fetch");}this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=false;this._itemsByIdentity=null;this._loadInProgress=false;this._queuedFetches=[];}},_getItemsFromLoadedData:function(_ca4){var _ca5=false,self=this;function _ca6(_ca7){return (_ca7!==null)&&(typeof _ca7==="object")&&(!lang.isArray(_ca7)||_ca5)&&(!lang.isFunction(_ca7))&&(_ca7.constructor==Object||lang.isArray(_ca7))&&(typeof _ca7._reference==="undefined")&&(typeof _ca7._type==="undefined")&&(typeof _ca7._value==="undefined")&&self.hierarchical;};function _ca8(_ca9){self._arrayOfAllItems.push(_ca9);for(var _caa in _ca9){var _cab=_ca9[_caa];if(_cab){if(lang.isArray(_cab)){var _cac=_cab;for(var k=0;k<_cac.length;++k){var _cad=_cac[k];if(_ca6(_cad)){_ca8(_cad);}}}else{if(_ca6(_cab)){_ca8(_cab);}}}}};this._labelAttr=_ca4.label;var i,item;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=_ca4.items;for(i=0;i<this._arrayOfTopLevelItems.length;++i){item=this._arrayOfTopLevelItems[i];if(lang.isArray(item)){_ca5=true;}_ca8(item);item[this._rootItemPropName]=true;}var _cae={},key;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){if(key!==this._rootItemPropName){var _caf=item[key];if(_caf!==null){if(!lang.isArray(_caf)){item[key]=[_caf];}}else{item[key]=[null];}}_cae[key]=key;}}while(_cae[this._storeRefPropName]){this._storeRefPropName+="_";}while(_cae[this._itemNumPropName]){this._itemNumPropName+="_";}while(_cae[this._reverseRefMap]){this._reverseRefMap+="_";}var _cb0;var _cb1=_ca4.identifier;if(_cb1){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=_cb1;for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];_cb0=item[_cb1];var _cb2=_cb0[0];if(!Object.hasOwnProperty.call(this._itemsByIdentity,_cb2)){this._itemsByIdentity[_cb2]=item;}else{if(this._jsonFileUrl){throw new Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+_cb1+"].  Value collided: ["+_cb2+"]");}else{if(this._jsonData){throw new Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+_cb1+"].  Value collided: ["+_cb2+"]");}}}}}else{this._features["dojo.data.api.Identity"]=Number;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];item[this._storeRefPropName]=this;item[this._itemNumPropName]=i;}for(i=0;i<this._arrayOfAllItems.length;++i){item=this._arrayOfAllItems[i];for(key in item){_cb0=item[key];for(var j=0;j<_cb0.length;++j){_caf=_cb0[j];if(_caf!==null&&typeof _caf=="object"){if(("_type" in _caf)&&("_value" in _caf)){var type=_caf._type;var _cb3=this._datatypeMap[type];if(!_cb3){throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+type+"'");}else{if(lang.isFunction(_cb3)){_cb0[j]=new _cb3(_caf._value);}else{if(lang.isFunction(_cb3.deserialize)){_cb0[j]=_cb3.deserialize(_caf._value);}else{throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");}}}}if(_caf._reference){var _cb4=_caf._reference;if(!lang.isObject(_cb4)){_cb0[j]=this._getItemByIdentity(_cb4);}else{for(var k=0;k<this._arrayOfAllItems.length;++k){var _cb5=this._arrayOfAllItems[k],_cb6=true;for(var _cb7 in _cb4){if(_cb5[_cb7]!=_cb4[_cb7]){_cb6=false;}}if(_cb6){_cb0[j]=_cb5;}}}if(this.referenceIntegrity){var _cb8=_cb0[j];if(this.isItem(_cb8)){this._addReferenceToMap(_cb8,item,key);}}}else{if(this.isItem(_caf)){if(this.referenceIntegrity){this._addReferenceToMap(_caf,item,key);}}}}}}}},_addReferenceToMap:function(_cb9,_cba,_cbb){},getIdentity:function(item){var _cbc=this._features["dojo.data.api.Identity"];if(_cbc===Number){return item[this._itemNumPropName];}else{var _cbd=item[_cbc];if(_cbd){return _cbd[0];}}return null;},fetchItemByIdentity:function(_cbe){var item,_cbf;if(!this._loadFinished){var self=this;if(this._jsonFileUrl!==this._ccUrl){_c73.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null&&this._jsonData==null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){if(this._loadInProgress){this._queuedFetches.push({args:_cbe});}else{this._loadInProgress=true;var _cc0={url:self._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk};var _cc1=xhr.get(_cc0);_cc1.addCallback(function(data){var _cc2=_cbe.scope?_cbe.scope:_c73.global;try{self._getItemsFromLoadedData(data);self._loadFinished=true;self._loadInProgress=false;item=self._getItemByIdentity(_cbe.identity);if(_cbe.onItem){_cbe.onItem.call(_cc2,item);}self._handleQueuedFetches();}catch(error){self._loadInProgress=false;if(_cbe.onError){_cbe.onError.call(_cc2,error);}}});_cc1.addErrback(function(_cc3){self._loadInProgress=false;if(_cbe.onError){var _cc4=_cbe.scope?_cbe.scope:_c73.global;_cbe.onError.call(_cc4,_cc3);}});}}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;item=self._getItemByIdentity(_cbe.identity);if(_cbe.onItem){_cbf=_cbe.scope?_cbe.scope:_c73.global;_cbe.onItem.call(_cbf,item);}}}}else{item=this._getItemByIdentity(_cbe.identity);if(_cbe.onItem){_cbf=_cbe.scope?_cbe.scope:_c73.global;_cbe.onItem.call(_cbf,item);}}},_getItemByIdentity:function(_cc5){var item=null;if(this._itemsByIdentity){if(Object.hasOwnProperty.call(this._itemsByIdentity,_cc5)){item=this._itemsByIdentity[_cc5];}}else{if(Object.hasOwnProperty.call(this._arrayOfAllItems,_cc5)){item=this._arrayOfAllItems[_cc5];}}if(item===undefined){item=null;}return item;},getIdentityAttributes:function(item){var _cc6=this._features["dojo.data.api.Identity"];if(_cc6===Number){return null;}else{return [_cc6];}},_forceLoad:function(){var self=this;if(this._jsonFileUrl!==this._ccUrl){_c73.deprecated(this.declaredClass+": ","To change the url, set the url property of the store,"+" not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0");this._ccUrl=this._jsonFileUrl;this.url=this._jsonFileUrl;}else{if(this.url!==this._ccUrl){this._jsonFileUrl=this.url;this._ccUrl=this.url;}}if(this.data!=null){this._jsonData=this.data;this.data=null;}if(this._jsonFileUrl){var _cc7={url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:true};var _cc8=xhr.get(_cc7);_cc8.addCallback(function(data){try{if(self._loadInProgress!==true&&!self._loadFinished){self._getItemsFromLoadedData(data);self._loadFinished=true;}else{if(self._loadInProgress){throw new Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}}}catch(e){console.log(e);throw e;}});_cc8.addErrback(function(_cc9){throw _cc9;});}else{if(this._jsonData){self._getItemsFromLoadedData(self._jsonData);self._jsonData=null;self._loadFinished=true;}}}});lang.extend(_c7a,_c78);return _c7a;});},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dijit/_editor/plugins/EnterKeyHandling",["dojo/_base/declare","dojo/dom-construct","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/_base/window","dojo/window","../_Plugin","../RichText","../range","../../_base/focus"],function(_cca,_ccb,_ccc,keys,lang,has,win,_ccd,_cce,_ccf,_cd0,_cd1){return _cca("dijit._editor.plugins.EnterKeyHandling",_cce,{blockNodeForEnter:"BR",constructor:function(args){if(args){if("blockNodeForEnter" in args){args.blockNodeForEnter=args.blockNodeForEnter.toUpperCase();}lang.mixin(this,args);}},setEditor:function(_cd2){if(this.editor===_cd2){return;}this.editor=_cd2;if(this.blockNodeForEnter=="BR"){this.editor.customUndo=true;_cd2.onLoadDeferred.then(lang.hitch(this,function(d){this.connect(_cd2.document,"onkeypress",function(e){if(e.charOrCode==keys.ENTER){var ne=lang.mixin({},e);ne.shiftKey=true;if(!this.handleEnterKey(ne)){_ccc.stop(e);}}});if(has("ie")>=9){this.connect(_cd2.document,"onpaste",function(e){setTimeout(dojo.hitch(this,function(){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();r.move("character",1);r.select();}),0);});}return d;}));}else{if(this.blockNodeForEnter){var h=lang.hitch(this,this.handleEnterKey);_cd2.addKeyHandler(13,0,0,h);_cd2.addKeyHandler(13,0,1,h);this.connect(this.editor,"onKeyPressed","onKeyPressed");}}},onKeyPressed:function(){if(this._checkListLater){if(win.withGlobal(this.editor.window,"isCollapsed",_cd1)){var _cd3=this.editor._sCall("getAncestorElement",["LI"]);if(!_cd3){_ccf.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);var _cd4=this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]);if(_cd4){_cd4.innerHTML=this.bogusHtmlContent;if(has("ie")<=9){var r=this.editor.document.selection.createRange();r.move("character",-1);r.select();}}else{console.error("onKeyPressed: Cannot find the new block node");}}else{if(has("mozilla")){if(_cd3.parentNode.parentNode.nodeName=="LI"){_cd3=_cd3.parentNode.parentNode;}}var fc=_cd3.firstChild;if(fc&&fc.nodeType==1&&(fc.nodeName=="UL"||fc.nodeName=="OL")){_cd3.insertBefore(fc.ownerDocument.createTextNode(" "),fc);var _cd5=_cd0.create(this.editor.window);_cd5.setStart(_cd3.firstChild,0);var _cd6=_cd0.getSelection(this.editor.window,true);_cd6.removeAllRanges();_cd6.addRange(_cd5);}}}this._checkListLater=false;}if(this._pressedEnterInBlock){if(this._pressedEnterInBlock.previousSibling){this.removeTrailingBr(this._pressedEnterInBlock.previousSibling);}delete this._pressedEnterInBlock;}},bogusHtmlContent:"&#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(e){var _cd7,_cd8,_cd9,_cda,_cdb,_cdc,doc=this.editor.document,br,rs,txt;if(e.shiftKey){var _cdd=this.editor._sCall("getParentElement",[]);var _cde=_cd0.getAncestor(_cdd,this.blockNodes);if(_cde){if(_cde.tagName=="LI"){return true;}_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);if(!_cd8.collapsed){_cd8.deleteContents();_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);}if(_cd0.atBeginningOfContainer(_cde,_cd8.startContainer,_cd8.startOffset)){br=doc.createElement("br");_cd9=_cd0.create(this.editor.window);_cde.insertBefore(br,_cde.firstChild);_cd9.setStartAfter(br);_cd7.removeAllRanges();_cd7.addRange(_cd9);}else{if(_cd0.atEndOfContainer(_cde,_cd8.startContainer,_cd8.startOffset)){_cd9=_cd0.create(this.editor.window);br=doc.createElement("br");_cde.appendChild(br);_cde.appendChild(doc.createTextNode(" "));_cd9.setStart(_cde.lastChild,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);}else{rs=_cd8.startContainer;if(rs&&rs.nodeType==3){txt=rs.nodeValue;_cda=doc.createTextNode(txt.substring(0,_cd8.startOffset));_cdb=doc.createTextNode(txt.substring(_cd8.startOffset));_cdc=doc.createElement("br");if(_cdb.nodeValue==""&&has("webkit")){_cdb=doc.createTextNode(" ");}_ccb.place(_cda,rs,"after");_ccb.place(_cdc,_cda,"after");_ccb.place(_cdb,_cdc,"after");_ccb.destroy(rs);_cd9=_cd0.create(this.editor.window);_cd9.setStart(_cdb,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);return false;}return true;}}}else{_cd7=_cd0.getSelection(this.editor.window);if(_cd7.rangeCount){_cd8=_cd7.getRangeAt(0);if(_cd8&&_cd8.startContainer){if(!_cd8.collapsed){_cd8.deleteContents();_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);}rs=_cd8.startContainer;if(rs&&rs.nodeType==3){var _cdf=false;var _ce0=_cd8.startOffset;if(rs.length<_ce0){ret=this._adjustNodeAndOffset(rs,_ce0);rs=ret.node;_ce0=ret.offset;}txt=rs.nodeValue;_cda=doc.createTextNode(txt.substring(0,_ce0));_cdb=doc.createTextNode(txt.substring(_ce0));_cdc=doc.createElement("br");if(!_cdb.length){_cdb=doc.createTextNode(" ");_cdf=true;}if(_cda.length){_ccb.place(_cda,rs,"after");}else{_cda=rs;}_ccb.place(_cdc,_cda,"after");_ccb.place(_cdb,_cdc,"after");_ccb.destroy(rs);_cd9=_cd0.create(this.editor.window);_cd9.setStart(_cdb,0);_cd9.setEnd(_cdb,_cdb.length);_cd7.removeAllRanges();_cd7.addRange(_cd9);if(_cdf&&!has("webkit")){this.editor._sCall("remove",[]);}else{this.editor._sCall("collapse",[true]);}}else{var _ce1;if(_cd8.startOffset>=0){_ce1=rs.childNodes[_cd8.startOffset];}var _cdc=doc.createElement("br");var _cdb=doc.createTextNode(" ");if(!_ce1){rs.appendChild(_cdc);rs.appendChild(_cdb);}else{_ccb.place(_cdc,_ce1,"before");_ccb.place(_cdb,_cdc,"after");}_cd9=_cd0.create(this.editor.window);_cd9.setStart(_cdb,0);_cd9.setEnd(_cdb,_cdb.length);_cd7.removeAllRanges();_cd7.addRange(_cd9);this.editor._sCall("collapse",[true]);}}}else{_ccf.prototype.execCommand.call(this.editor,"inserthtml","<br>");}}return false;}var _ce2=true;_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);if(!_cd8.collapsed){_cd8.deleteContents();_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);}var _ce3=_cd0.getBlockAncestor(_cd8.endContainer,null,this.editor.editNode);var _ce4=_ce3.blockNode;if((this._checkListLater=(_ce4&&(_ce4.nodeName=="LI"||_ce4.parentNode.nodeName=="LI")))){if(has("mozilla")){this._pressedEnterInBlock=_ce4;}if(/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(_ce4.innerHTML)){_ce4.innerHTML="";if(has("webkit")){_cd9=_cd0.create(this.editor.window);_cd9.setStart(_ce4,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);}this._checkListLater=false;}return true;}if(!_ce3.blockNode||_ce3.blockNode===this.editor.editNode){try{_ccf.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter);}catch(e2){}_ce3={blockNode:this.editor._sCall("getAncestorElement",[this.blockNodeForEnter]),blockContainer:this.editor.editNode};if(_ce3.blockNode){if(_ce3.blockNode!=this.editor.editNode&&(!(_ce3.blockNode.textContent||_ce3.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)){this.removeTrailingBr(_ce3.blockNode);return false;}}else{_ce3.blockNode=this.editor.editNode;}_cd7=_cd0.getSelection(this.editor.window);_cd8=_cd7.getRangeAt(0);}var _ce5=doc.createElement(this.blockNodeForEnter);_ce5.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(_ce3.blockNode);var _ce6=_cd8.endOffset;var node=_cd8.endContainer;if(node.length<_ce6){var ret=this._adjustNodeAndOffset(node,_ce6);node=ret.node;_ce6=ret.offset;}if(_cd0.atEndOfContainer(_ce3.blockNode,node,_ce6)){if(_ce3.blockNode===_ce3.blockContainer){_ce3.blockNode.appendChild(_ce5);}else{_ccb.place(_ce5,_ce3.blockNode,"after");}_ce2=false;_cd9=_cd0.create(this.editor.window);_cd9.setStart(_ce5,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);if(this.editor.height){_ccd.scrollIntoView(_ce5);}}else{if(_cd0.atBeginningOfContainer(_ce3.blockNode,_cd8.startContainer,_cd8.startOffset)){_ccb.place(_ce5,_ce3.blockNode,_ce3.blockNode===_ce3.blockContainer?"first":"before");if(_ce5.nextSibling&&this.editor.height){_cd9=_cd0.create(this.editor.window);_cd9.setStart(_ce5.nextSibling,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);_ccd.scrollIntoView(_ce5.nextSibling);}_ce2=false;}else{if(_ce3.blockNode===_ce3.blockContainer){_ce3.blockNode.appendChild(_ce5);}else{_ccb.place(_ce5,_ce3.blockNode,"after");}_ce2=false;if(_ce3.blockNode.style){if(_ce5.style){if(_ce3.blockNode.style.cssText){_ce5.style.cssText=_ce3.blockNode.style.cssText;}}}rs=_cd8.startContainer;var _ce7;if(rs&&rs.nodeType==3){var _ce8,_ce9;_ce6=_cd8.endOffset;if(rs.length<_ce6){ret=this._adjustNodeAndOffset(rs,_ce6);rs=ret.node;_ce6=ret.offset;}txt=rs.nodeValue;_cda=doc.createTextNode(txt.substring(0,_ce6));_cdb=doc.createTextNode(txt.substring(_ce6,txt.length));_ccb.place(_cda,rs,"before");_ccb.place(_cdb,rs,"after");_ccb.destroy(rs);var _cea=_cda.parentNode;while(_cea!==_ce3.blockNode){var tg=_cea.tagName;var _ceb=doc.createElement(tg);if(_cea.style){if(_ceb.style){if(_cea.style.cssText){_ceb.style.cssText=_cea.style.cssText;}}}if(_cea.tagName==="FONT"){if(_cea.color){_ceb.color=_cea.color;}if(_cea.face){_ceb.face=_cea.face;}if(_cea.size){_ceb.size=_cea.size;}}_ce8=_cdb;while(_ce8){_ce9=_ce8.nextSibling;_ceb.appendChild(_ce8);_ce8=_ce9;}_ccb.place(_ceb,_cea,"after");_cda=_cea;_cdb=_ceb;_cea=_cea.parentNode;}_ce8=_cdb;if(_ce8.nodeType==1||(_ce8.nodeType==3&&_ce8.nodeValue)){_ce5.innerHTML="";}_ce7=_ce8;while(_ce8){_ce9=_ce8.nextSibling;_ce5.appendChild(_ce8);_ce8=_ce9;}}_cd9=_cd0.create(this.editor.window);var _cec;var _ced=_ce7;if(this.blockNodeForEnter!=="BR"){while(_ced){_cec=_ced;_ce9=_ced.firstChild;_ced=_ce9;}if(_cec&&_cec.parentNode){_ce5=_cec.parentNode;_cd9.setStart(_ce5,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);if(this.editor.height){_ccd.scrollIntoView(_ce5);}if(has("mozilla")){this._pressedEnterInBlock=_ce3.blockNode;}}else{_ce2=true;}}else{_cd9.setStart(_ce5,0);_cd7.removeAllRanges();_cd7.addRange(_cd9);if(this.editor.height){_ccd.scrollIntoView(_ce5);}if(has("mozilla")){this._pressedEnterInBlock=_ce3.blockNode;}}}}return _ce2;},_adjustNodeAndOffset:function(node,_cee){while(node.length<_cee&&node.nextSibling&&node.nextSibling.nodeType==3){_cee=_cee-node.length;node=node.nextSibling;}return {"node":node,"offset":_cee};},removeTrailingBr:function(_cef){var para=/P|DIV|LI/i.test(_cef.tagName)?_cef:this.editor._sCall("getParentOfType",[_cef,["P","DIV","LI"]]);if(!para){return;}if(para.lastChild){if((para.childNodes.length>1&&para.lastChild.nodeType==3&&/^[\s\xAD]*$/.test(para.lastChild.nodeValue))||para.lastChild.tagName=="BR"){_ccb.destroy(para.lastChild);}}if(!para.childNodes.length){para.innerHTML=this.bogusHtmlContent;}}});});},"dojox/grid/_SelectionPreserver":function(){define("dojox/grid/_SelectionPreserver",["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(_cf0,_cf1,lang,_cf2){return _cf0("dojox.grid._SelectionPreserver",null,{constructor:function(_cf3){this.selection=_cf3;var grid=this.grid=_cf3.grid;this.reset();this._connects=[_cf1.connect(grid,"_setStore",this,"reset"),_cf1.connect(grid,"_addItem",this,"_reSelectById"),_cf1.connect(_cf3,"onSelected",lang.hitch(this,"_selectById",true)),_cf1.connect(_cf3,"onDeselected",lang.hitch(this,"_selectById",false)),_cf1.connect(_cf3,"deselectAll",this,"reset")];},destroy:function(){this.reset();_cf2.forEach(this._connects,_cf1.disconnect);delete this._connects;},reset:function(){this._selectedById={};},_reSelectById:function(item,_cf4){if(item&&this.grid._hasIdentity){this.selection.selected[_cf4]=this._selectedById[this.grid.store.getIdentity(item)];}},_selectById:function(_cf5,_cf6){if(this.selection.mode=="none"||!this.grid._hasIdentity){return;}var item=_cf6,g=this.grid;if(typeof _cf6=="number"||typeof _cf6=="string"){var _cf7=g._by_idx[_cf6];item=_cf7&&_cf7.item;}if(item){this._selectedById[g.store.getIdentity(item)]=!!_cf5;}return item;}});});},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(lang,_cf8,_cf9){var _cfa={};lang.setObject("dojo.data.util.simpleFetch",_cfa);_cfa.errorHandler=function(_cfb,_cfc){if(_cfc.onError){var _cfd=_cfc.scope||_cf8.global;_cfc.onError.call(_cfd,_cfb,_cfc);}};_cfa.fetchHandler=function(_cfe,_cff){var _d00=_cff.abort||null,_d01=false,_d02=_cff.start?_cff.start:0,_d03=(_cff.count&&(_cff.count!==Infinity))?(_d02+_cff.count):_cfe.length;_cff.abort=function(){_d01=true;if(_d00){_d00.call(_cff);}};var _d04=_cff.scope||_cf8.global;if(!_cff.store){_cff.store=this;}if(_cff.onBegin){_cff.onBegin.call(_d04,_cfe.length,_cff);}if(_cff.sort){_cfe.sort(_cf9.createSortFunction(_cff.sort,this));}if(_cff.onItem){for(var i=_d02;(i<_cfe.length)&&(i<_d03);++i){var item=_cfe[i];if(!_d01){_cff.onItem.call(_d04,item,_cff);}}}if(_cff.onComplete&&!_d01){var _d05=null;if(!_cff.onItem){_d05=_cfe.slice(_d02,_d03);}_cff.onComplete.call(_d04,_d05,_cff);}};_cfa.fetch=function(_d06){_d06=_d06||{};if(!_d06.store){_d06.store=this;}this._fetchItems(_d06,lang.hitch(this,"fetchHandler"),lang.hitch(this,"errorHandler"));return _d06;};return _cfa;});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/i18n!./nls/ComboBox"],function(_d07,_d08,_d09,i18n){return _d08("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_d0a){this.value=_d0a;this.onChange(_d0a);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_d0b){var _d0c=this._createMenuItem();var _d0d=_d0b(item);if(_d0d.html){_d0c.innerHTML=_d0d.label;}else{_d0c.appendChild(_d0c.ownerDocument.createTextNode(_d0d.label));}if(_d0c.innerHTML==""){_d0c.innerHTML="&#160;";}this.applyTextDir(_d0c,(_d0c.innerText||_d0c.textContent||""));return _d0c;},createOptions:function(_d0e,_d0f,_d10){this.items=_d0e;this.previousButton.style.display=(_d0f.start==0)?"none":"";_d09.set(this.previousButton,"id",this.id+"_prev");_d07.forEach(_d0e,function(item,i){var _d11=this._createOption(item,_d10);_d11.setAttribute("item",i);_d09.set(_d11,"id",this.id+i);this.nextButton.parentNode.insertBefore(_d11,this.nextButton);},this);var _d12=false;if(_d0e.total&&!_d0e.total.then&&_d0e.total!=-1){if((_d0f.start+_d0f.count)<_d0e.total){_d12=true;}else{if((_d0f.start+_d0f.count)>_d0e.total&&_d0f.count==_d0e.length){_d12=true;}}}else{if(_d0f.count==_d0e.length){_d12=true;}}this.nextButton.style.display=_d12?"":"none";_d09.set(this.nextButton,"id",this.id+"_next");},clearResultList:function(){var _d13=this.containerNode;while(_d13.childNodes.length>2){_d13.removeChild(_d13.childNodes[_d13.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this.selected;}});});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_d14,_d15){var _d16={};lang.setObject("dojo.colors",_d16);var _d17=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_d14.fromRgb=function(_d18,obj){var m=_d18.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_d15.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _d14.fromArray(a,obj);}return _d14.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_d17(m1,m2,H+1/3)*256,_d17(m1,m2,H)*256,_d17(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _d14.fromArray(a,obj);}}return null;};var _d19=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_d14.prototype.sanitize=function(){var t=this;t.r=Math.round(_d19(t.r,0,255));t.g=Math.round(_d19(t.g,0,255));t.b=Math.round(_d19(t.b,0,255));t.a=_d19(t.a,0,1);return this;};_d16.makeGrey=_d14.makeGrey=function(g,a){return _d14.fromArray([g,g,g,a]);};lang.mixin(_d14.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _d14;});},"dojox/grid/_Builder":function(){define("dojox/grid/_Builder",["../main","dojo/_base/array","dojo/_base/lang","dojo/_base/window","dojo/_base/event","dojo/_base/sniff","dojo/_base/connect","dojo/dnd/Moveable","dojox/html/metrics","./util","dojo/_base/html"],function(_d1a,_d1b,lang,win,_d1c,has,_d1d,_d1e,_d1f,util,html){var dg=_d1a.grid;var _d20=function(td){return td.cellIndex>=0?td.cellIndex:_d1b.indexOf(td.parentNode.cells,td);};var _d21=function(tr){return tr.rowIndex>=0?tr.rowIndex:_d1b.indexOf(tr.parentNode.childNodes,tr);};var _d22=function(_d23,_d24){return _d23&&((_d23.rows||0)[_d24]||_d23.childNodes[_d24]);};var _d25=function(node){for(var n=node;n&&n.tagName!="TABLE";n=n.parentNode){}return n;};var _d26=function(_d27,_d28){for(var n=_d27;n&&_d28(n);n=n.parentNode){}return n;};var _d29=function(_d2a){var name=_d2a.toUpperCase();return function(node){return node.tagName!=name;};};var _d2b=util.rowIndexTag;var _d2c=util.gridViewTag;var _d2d=dg._Builder=lang.extend(function(view){if(view){this.view=view;this.grid=view.grid;}},{view:null,_table:"<table class=\"dojoxGridRowTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\"",getTableArray:function(){var html=[this._table];if(this.view.viewWidth){html.push([" style=\"width:",this.view.viewWidth,";\""].join(""));}html.push(">");return html;},generateCellMarkup:function(_d2e,_d2f,_d30,_d31){var _d32=[],html;if(_d31){var _d33=_d2e.index!=_d2e.grid.getSortIndex()?"":_d2e.grid.sortInfo>0?"aria-sort=\"ascending\"":"aria-sort=\"descending\"";if(!_d2e.id){_d2e.id=this.grid.id+"Hdr"+_d2e.index;}html=["<th tabIndex=\"-1\" aria-readonly=\"true\" role=\"columnheader\"",_d33,"id=\"",_d2e.id,"\""];}else{var _d34=this.grid.editable&&!_d2e.editable?"aria-readonly=\"true\"":"";html=["<td tabIndex=\"-1\" role=\"gridcell\"",_d34];}if(_d2e.colSpan){html.push(" colspan=\"",_d2e.colSpan,"\"");}if(_d2e.rowSpan){html.push(" rowspan=\"",_d2e.rowSpan,"\"");}html.push(" class=\"dojoxGridCell ");if(_d2e.classes){html.push(_d2e.classes," ");}if(_d30){html.push(_d30," ");}_d32.push(html.join(""));_d32.push("");html=["\" idx=\"",_d2e.index,"\" style=\""];if(_d2f&&_d2f[_d2f.length-1]!=";"){_d2f+=";";}html.push(_d2e.styles,_d2f||"",_d2e.hidden?"display:none;":"");if(_d2e.unitWidth){html.push("width:",_d2e.unitWidth,";");}_d32.push(html.join(""));_d32.push("");html=["\""];if(_d2e.attrs){html.push(" ",_d2e.attrs);}html.push(">");_d32.push(html.join(""));_d32.push("");_d32.push(_d31?"</th>":"</td>");return _d32;},isCellNode:function(_d35){return Boolean(_d35&&_d35!=win.doc&&html.attr(_d35,"idx"));},getCellNodeIndex:function(_d36){return _d36?Number(html.attr(_d36,"idx")):-1;},getCellNode:function(_d37,_d38){for(var i=0,row;((row=_d22(_d37.firstChild,i))&&row.cells);i++){for(var j=0,cell;(cell=row.cells[j]);j++){if(this.getCellNodeIndex(cell)==_d38){return cell;}}}return null;},findCellTarget:function(_d39,_d3a){var n=_d39;while(n&&(!this.isCellNode(n)||(n.offsetParent&&_d2c in n.offsetParent.parentNode&&n.offsetParent.parentNode[_d2c]!=this.view.id))&&(n!=_d3a)){n=n.parentNode;}return n!=_d3a?n:null;},baseDecorateEvent:function(e){e.dispatch="do"+e.type;e.grid=this.grid;e.sourceView=this.view;e.cellNode=this.findCellTarget(e.target,e.rowNode);e.cellIndex=this.getCellNodeIndex(e.cellNode);e.cell=(e.cellIndex>=0?this.grid.getCell(e.cellIndex):null);},findTarget:function(_d3b,_d3c){var n=_d3b;while(n&&(n!=this.domNode)&&(!(_d3c in n)||(_d2c in n&&n[_d2c]!=this.view.id))){n=n.parentNode;}return (n!=this.domNode)?n:null;},findRowTarget:function(_d3d){return this.findTarget(_d3d,_d2b);},isIntraNodeEvent:function(e){try{return (e.cellNode&&e.relatedTarget&&html.isDescendant(e.relatedTarget,e.cellNode));}catch(x){return false;}},isIntraRowEvent:function(e){try{var row=e.relatedTarget&&this.findRowTarget(e.relatedTarget);return !row&&(e.rowIndex==-1)||row&&(e.rowIndex==row.gridRowIndex);}catch(x){return false;}},dispatchEvent:function(e){if(e.dispatch in this){return this[e.dispatch](e);}return false;},domouseover:function(e){if(e.cellNode&&(e.cellNode!=this.lastOverCellNode)){this.lastOverCellNode=e.cellNode;this.grid.onMouseOver(e);}this.grid.onMouseOverRow(e);},domouseout:function(e){if(e.cellNode&&(e.cellNode==this.lastOverCellNode)&&!this.isIntraNodeEvent(e,this.lastOverCellNode)){this.lastOverCellNode=null;this.grid.onMouseOut(e);if(!this.isIntraRowEvent(e)){this.grid.onMouseOutRow(e);}}},domousedown:function(e){if(e.cellNode){this.grid.onMouseDown(e);}this.grid.onMouseDownRow(e);}});var _d3e=dg._ContentBuilder=lang.extend(function(view){_d2d.call(this,view);},_d2d.prototype,{update:function(){this.prepareHtml();},prepareHtml:function(){var _d3f=this.grid.get,_d40=this.view.structure.cells;for(var j=0,row;(row=_d40[j]);j++){for(var i=0,cell;(cell=row[i]);i++){cell.get=cell.get||(cell.value==undefined)&&_d3f;cell.markup=this.generateCellMarkup(cell,cell.cellStyles,cell.cellClasses,false);if(!this.grid.editable&&cell.editable){this.grid.editable=true;}}}},generateHtml:function(_d41,_d42){var html=this.getTableArray(),v=this.view,_d43=v.structure.cells,item=this.grid.getItem(_d42);util.fire(this.view,"onBeforeRow",[_d42,_d43]);for(var j=0,row;(row=_d43[j]);j++){if(row.hidden||row.header){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,m,cc,cs;(cell=row[i]);i++){m=cell.markup;cc=cell.customClasses=[];cs=cell.customStyles=[];m[5]=cell.format(_d42,item);m[1]=cc.join(" ");m[3]=cs.join(";");html.push.apply(html,m);}html.push("</tr>");}html.push("</table>");return html.join("");},decorateEvent:function(e){e.rowNode=this.findRowTarget(e.target);if(!e.rowNode){return false;}e.rowIndex=e.rowNode[_d2b];this.baseDecorateEvent(e);e.cell=this.grid.getCell(e.cellIndex);return true;}});var _d44=dg._HeaderBuilder=lang.extend(function(view){this.moveable=null;_d2d.call(this,view);},_d2d.prototype,{_skipBogusClicks:false,overResizeWidth:4,minColWidth:1,update:function(){if(this.tableMap){this.tableMap.mapRows(this.view.structure.cells);}else{this.tableMap=new dg._TableMap(this.view.structure.cells);}},generateHtml:function(_d45,_d46){var html=this.getTableArray(),_d47=this.view.structure.cells;util.fire(this.view,"onBeforeRow",[-1,_d47]);for(var j=0,row;(row=_d47[j]);j++){if(row.hidden){continue;}html.push(!row.invisible?"<tr>":"<tr class=\"dojoxGridInvisible\">");for(var i=0,cell,_d48;(cell=row[i]);i++){cell.customClasses=[];cell.customStyles=[];if(this.view.simpleStructure){if(cell.draggable){if(cell.headerClasses){if(cell.headerClasses.indexOf("dojoDndItem")==-1){cell.headerClasses+=" dojoDndItem";}}else{cell.headerClasses="dojoDndItem";}}if(cell.attrs){if(cell.attrs.indexOf("dndType='gridColumn_")==-1){cell.attrs+=" dndType='gridColumn_"+this.grid.id+"'";}}else{cell.attrs="dndType='gridColumn_"+this.grid.id+"'";}}_d48=this.generateCellMarkup(cell,cell.headerStyles,cell.headerClasses,true);_d48[5]=(_d46!=undefined?_d46:_d45(cell));_d48[3]=cell.customStyles.join(";");_d48[1]=cell.customClasses.join(" ");html.push(_d48.join(""));}html.push("</tr>");}html.push("</table>");return html.join("");},getCellX:function(e){var n,x=e.layerX;if(has("mozilla")||has("ie")>=9){n=_d26(e.target,_d29("th"));x-=(n&&n.offsetLeft)||0;var t=e.sourceView.getScrollbarWidth();if(!this.grid.isLeftToRight()){table=_d26(n,_d29("table"));x-=(table&&table.offsetLeft)||0;}}n=_d26(e.target,function(){if(!n||n==e.cellNode){return false;}x+=(n.offsetLeft<0?0:n.offsetLeft);return true;});return x;},decorateEvent:function(e){this.baseDecorateEvent(e);e.rowIndex=-1;e.cellX=this.getCellX(e);return true;},prepareResize:function(e,mod){do{var i=e.cellIndex;e.cellNode=(i?e.cellNode.parentNode.cells[i+mod]:null);e.cellIndex=(e.cellNode?this.getCellNodeIndex(e.cellNode):-1);}while(e.cellNode&&e.cellNode.style.display=="none");return Boolean(e.cellNode);},canResize:function(e){if(!e.cellNode||e.cellNode.colSpan>1){return false;}var cell=this.grid.getCell(e.cellIndex);return !cell.noresize&&cell.canResize();},overLeftResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return (e.cellIndex>0)&&(e.cellX>0&&e.cellX<this.overResizeWidth)&&this.prepareResize(e,-1);}var t=e.cellNode&&(e.cellX>0&&e.cellX<this.overResizeWidth);return t;},overRightResizeArea:function(e){if(html.hasClass(win.body(),"dojoDndMove")){return false;}if(has("ie")){var tN=e.target;if(html.hasClass(tN,"dojoxGridArrowButtonNode")||html.hasClass(tN,"dojoxGridArrowButtonChar")||html.hasClass(tN,"dojoxGridColCaption")){return false;}}if(this.grid.isLeftToRight()){return e.cellNode&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth);}return (e.cellIndex>0)&&(e.cellX>=e.cellNode.offsetWidth-this.overResizeWidth)&&this.prepareResize(e,-1);},domousemove:function(e){if(!this.moveable){var c=(this.overRightResizeArea(e)?"dojoxGridColResize":(this.overLeftResizeArea(e)?"dojoxGridColResize":""));if(c&&!this.canResize(e)){c="dojoxGridColNoResize";}html.toggleClass(e.sourceView.headerNode,"dojoxGridColNoResize",(c=="dojoxGridColNoResize"));html.toggleClass(e.sourceView.headerNode,"dojoxGridColResize",(c=="dojoxGridColResize"));if(c){_d1c.stop(e);}}},domousedown:function(e){if(!this.moveable){if((this.overRightResizeArea(e)||this.overLeftResizeArea(e))&&this.canResize(e)){this.beginColumnResize(e);}else{this.grid.onMouseDown(e);this.grid.onMouseOverRow(e);}}},doclick:function(e){if(this._skipBogusClicks){_d1c.stop(e);return true;}return false;},colResizeSetup:function(e,_d49){var _d4a=html.contentBox(e.sourceView.headerNode);if(_d49){this.lineDiv=document.createElement("div");var vw=html.position(e.sourceView.headerNode,true);var _d4b=html.contentBox(e.sourceView.domNode);var l=e.pageX;if(!this.grid.isLeftToRight()&&has("ie")<8){l-=_d1f.getScrollbar().w;}html.style(this.lineDiv,{top:vw.y+"px",left:l+"px",height:(_d4b.h+_d4a.h)+"px"});html.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=l;win.body().appendChild(this.lineDiv);}var _d4c=[],_d4d=this.tableMap.findOverlappingNodes(e.cellNode);for(var i=0,cell;(cell=_d4d[i]);i++){_d4c.push({node:cell,index:this.getCellNodeIndex(cell),width:cell.offsetWidth});}var view=e.sourceView;var adj=this.grid.isLeftToRight()?1:-1;var _d4e=e.grid.views.views;var _d4f=[];for(var j=view.idx+adj,_d50;(_d50=_d4e[j]);j=j+adj){_d4f.push({node:_d50.headerNode,left:window.parseInt(_d50.headerNode.style.left)});}var _d51=view.headerContentNode.firstChild;var drag={scrollLeft:e.sourceView.headerNode.scrollLeft,view:view,node:e.cellNode,index:e.cellIndex,w:html.contentBox(e.cellNode).w,vw:_d4a.w,table:_d51,tw:html.contentBox(_d51).w,spanners:_d4c,followers:_d4f};return drag;},beginColumnResize:function(e){this.moverDiv=document.createElement("div");html.style(this.moverDiv,{position:"absolute",left:0});win.body().appendChild(this.moverDiv);html.addClass(this.grid.domNode,"dojoxGridColumnResizing");var m=(this.moveable=new _d1e(this.moverDiv));var drag=this.colResizeSetup(e,true);m.onMove=lang.hitch(this,"doResizeColumn",drag);_d1d.connect(m,"onMoveStop",lang.hitch(this,function(){this.endResizeColumn(drag);if(drag.node.releaseCapture){drag.node.releaseCapture();}this.moveable.destroy();delete this.moveable;this.moveable=null;html.removeClass(this.grid.domNode,"dojoxGridColumnResizing");}));if(e.cellNode.setCapture){e.cellNode.setCapture();}m.onMouseDown(e);},doResizeColumn:function(_d52,_d53,_d54){var _d55=_d54.l;var data={deltaX:_d55,w:_d52.w+(this.grid.isLeftToRight()?_d55:-_d55),vw:_d52.vw+_d55,tw:_d52.tw+_d55};this.dragRecord={inDrag:_d52,mover:_d53,leftTop:_d54};if(data.w>=this.minColWidth){if(!_d53){this.doResizeNow(_d52,data);}else{html.style(this.lineDiv,"left",(this.lineDiv._origLeft+data.deltaX)+"px");}}},endResizeColumn:function(_d56){if(this.dragRecord){var _d57=this.dragRecord.leftTop;var _d58=this.grid.isLeftToRight()?_d57.l:-_d57.l;_d58+=Math.max(_d56.w+_d58,this.minColWidth)-(_d56.w+_d58);if(has("webkit")&&_d56.spanners.length){_d58+=html._getPadBorderExtents(_d56.spanners[0].node).w;}var data={deltaX:_d58,w:_d56.w+_d58,vw:_d56.vw+_d58,tw:_d56.tw+_d58};this.doResizeNow(_d56,data);delete this.dragRecord;}html.destroy(this.lineDiv);html.destroy(this.moverDiv);html.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=true;_d56.view.update();this._skipBogusClicks=false;this.grid.onResizeColumn(_d56.index);},doResizeNow:function(_d59,data){_d59.view.convertColPctToFixed();if(_d59.view.flexCells&&!_d59.view.testFlexCells()){var t=_d25(_d59.node);if(t){(t.style.width="");}}var i,s,sw,f,fl;for(i=0;(s=_d59.spanners[i]);i++){sw=s.width+data.deltaX;if(sw>0){s.node.style.width=sw+"px";_d59.view.setColWidth(s.index,sw);}}if(this.grid.isLeftToRight()||!has("ie")){for(i=0;(f=_d59.followers[i]);i++){fl=f.left+data.deltaX;f.node.style.left=fl+"px";}}_d59.node.style.width=data.w+"px";_d59.view.setColWidth(_d59.index,data.w);_d59.view.headerNode.style.width=data.vw+"px";_d59.view.setColumnsWidth(data.tw);if(!this.grid.isLeftToRight()){_d59.view.headerNode.scrollLeft=_d59.scrollLeft+data.deltaX;}}});dg._TableMap=lang.extend(function(rows){this.mapRows(rows);},{map:null,mapRows:function(_d5a){var _d5b=_d5a.length;if(!_d5b){return;}this.map=[];var row;for(var k=0;(row=_d5a[k]);k++){this.map[k]=[];}for(var j=0;(row=_d5a[j]);j++){for(var i=0,x=0,cell,_d5c,_d5d;(cell=row[i]);i++){while(this.map[j][x]){x++;}this.map[j][x]={c:i,r:j};_d5d=cell.rowSpan||1;_d5c=cell.colSpan||1;for(var y=0;y<_d5d;y++){for(var s=0;s<_d5c;s++){this.map[j+y][x+s]=this.map[j][x];}}x+=_d5c;}}},dumpMap:function(){for(var j=0,row,h="";(row=this.map[j]);j++,h=""){for(var i=0,cell;(cell=row[i]);i++){h+=cell.r+","+cell.c+"   ";}}},getMapCoords:function(_d5e,_d5f){for(var j=0,row;(row=this.map[j]);j++){for(var i=0,cell;(cell=row[i]);i++){if(cell.c==_d5f&&cell.r==_d5e){return {j:j,i:i};}}}return {j:-1,i:-1};},getNode:function(_d60,_d61,_d62){var row=_d60&&_d60.rows[_d61];return row&&row.cells[_d62];},_findOverlappingNodes:function(_d63,_d64,_d65){var _d66=[];var m=this.getMapCoords(_d64,_d65);for(var j=0,row;(row=this.map[j]);j++){if(j==m.j){continue;}var rw=row[m.i];var n=(rw?this.getNode(_d63,rw.r,rw.c):null);if(n){_d66.push(n);}}return _d66;},findOverlappingNodes:function(_d67){return this._findOverlappingNodes(_d25(_d67),_d21(_d67.parentNode),_d20(_d67));}});return {_Builder:_d2d,_HeaderBuilder:_d44,_ContentBuilder:_d3e};});},"url:esri/dijit/editing/templates/Editor.html":"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>","dijit/_editor/range":function(){define("dijit/_editor/range",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","../main"],function(_d68,_d69,lang,win,_d6a){_d6a.range={};_d6a.range.getIndex=function(node,_d6b){var ret=[],retR=[];var _d6c=node;var _d6d,n;while(node!=_d6b){var i=0;_d6d=node.parentNode;while((n=_d6d.childNodes[i++])){if(n===node){--i;break;}}ret.unshift(i);retR.unshift(i-_d6d.childNodes.length);node=_d6d;}if(ret.length>0&&_d6c.nodeType==3){n=_d6c.previousSibling;while(n&&n.nodeType==3){ret[ret.length-1]--;n=n.previousSibling;}n=_d6c.nextSibling;while(n&&n.nodeType==3){retR[retR.length-1]++;n=n.nextSibling;}}return {o:ret,r:retR};};_d6a.range.getNode=function(_d6e,_d6f){if(!lang.isArray(_d6e)||_d6e.length==0){return _d6f;}var node=_d6f;_d68.every(_d6e,function(i){if(i>=0&&i<node.childNodes.length){node=node.childNodes[i];}else{node=null;return false;}return true;});return node;};_d6a.range.getCommonAncestor=function(n1,n2,root){root=root||n1.ownerDocument.body;var _d70=function(n){var as=[];while(n){as.unshift(n);if(n!==root){n=n.parentNode;}else{break;}}return as;};var n1as=_d70(n1);var n2as=_d70(n2);var m=Math.min(n1as.length,n2as.length);var com=n1as[0];for(var i=1;i<m;i++){if(n1as[i]===n2as[i]){com=n1as[i];}else{break;}}return com;};_d6a.range.getAncestor=function(node,_d71,root){root=root||node.ownerDocument.body;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(_d71.test(name)){return node;}node=node.parentNode;}return null;};_d6a.range.BlockTagNames=/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/;_d6a.range.getBlockAncestor=function(node,_d72,root){root=root||node.ownerDocument.body;_d72=_d72||_d6a.range.BlockTagNames;var _d73=null,_d74;while(node&&node!==root){var name=node.nodeName.toUpperCase();if(!_d73&&_d72.test(name)){_d73=node;}if(!_d74&&(/^(?:BODY|TD|TH|CAPTION)$/).test(name)){_d74=node;}node=node.parentNode;}return {blockNode:_d73,blockContainer:_d74||node.ownerDocument.body};};_d6a.range.atBeginningOfContainer=function(_d75,node,_d76){var _d77=false;var _d78=(_d76==0);if(!_d78&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(0,_d76))){_d78=true;}}if(_d78){var _d79=node;_d77=true;while(_d79&&_d79!==_d75){if(_d79.previousSibling){_d77=false;break;}_d79=_d79.parentNode;}}return _d77;};_d6a.range.atEndOfContainer=function(_d7a,node,_d7b){var _d7c=false;var _d7d=(_d7b==(node.length||node.childNodes.length));if(!_d7d&&node.nodeType==3){if(/^[\s\xA0]+$/.test(node.nodeValue.substr(_d7b))){_d7d=true;}}if(_d7d){var _d7e=node;_d7c=true;while(_d7e&&_d7e!==_d7a){if(_d7e.nextSibling){_d7c=false;break;}_d7e=_d7e.parentNode;}}return _d7c;};_d6a.range.adjacentNoneTextNode=function(_d7f,next){var node=_d7f;var len=(0-_d7f.length)||0;var prop=next?"nextSibling":"previousSibling";while(node){if(node.nodeType!=3){break;}len+=node.length;node=node[prop];}return [node,len];};_d6a.range.create=function(win){win=win||window;if(win.getSelection){return win.document.createRange();}else{return new _d6a.range.W3CRange();}};_d6a.range.getSelection=function(_d80,_d81){if(_d80.getSelection){return _d80.getSelection();}else{var s=new _d6a.range.ie.selection(_d80);if(!_d81){s._getCurrentSelection();}return s;}};if(!window.getSelection){_d6a.range.ie={cachedSelection:{},selection:function(_d82){this._ranges=[];this.addRange=function(r,_d83){this._ranges.push(r);if(!_d83){r._select();}this.rangeCount=this._ranges.length;};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0;};var _d84=function(){var r=_d82.document.selection.createRange();var type=_d82.document.selection.type.toUpperCase();if(type=="CONTROL"){return new _d6a.range.W3CRange(_d6a.range.ie.decomposeControlRange(r));}else{return new _d6a.range.W3CRange(_d6a.range.ie.decomposeTextRange(r));}};this.getRangeAt=function(i){return this._ranges[i];};this._getCurrentSelection=function(){this.removeAllRanges();var r=_d84();if(r){this.addRange(r,true);this.isCollapsed=r.collapsed;}else{this.isCollapsed=true;}};},decomposeControlRange:function(_d85){var _d86=_d85.item(0),_d87=_d85.item(_d85.length-1);var _d88=_d86.parentNode,_d89=_d87.parentNode;var _d8a=_d6a.range.getIndex(_d86,_d88).o[0];var _d8b=_d6a.range.getIndex(_d87,_d89).o[0]+1;return [_d88,_d8a,_d89,_d8b];},getEndPoint:function(_d8c,end){var _d8d=_d8c.duplicate();_d8d.collapse(!end);var _d8e="EndTo"+(end?"End":"Start");var _d8f=_d8d.parentElement();var _d90,_d91,_d92;if(_d8f.childNodes.length>0){_d68.every(_d8f.childNodes,function(node,i){var _d93;if(node.nodeType!=3){_d8d.moveToElementText(node);if(_d8d.compareEndPoints(_d8e,_d8c)>0){if(_d92&&_d92.nodeType==3){_d90=_d92;_d93=true;}else{_d90=_d8f;_d91=i;return false;}}else{if(i==_d8f.childNodes.length-1){_d90=_d8f;_d91=_d8f.childNodes.length;return false;}}}else{if(i==_d8f.childNodes.length-1){_d90=node;_d93=true;}}if(_d93&&_d90){var _d94=_d6a.range.adjacentNoneTextNode(_d90)[0];if(_d94){_d90=_d94.nextSibling;}else{_d90=_d8f.firstChild;}var _d95=_d6a.range.adjacentNoneTextNode(_d90);_d94=_d95[0];var _d96=_d95[1];if(_d94){_d8d.moveToElementText(_d94);_d8d.collapse(false);}else{_d8d.moveToElementText(_d8f);}_d8d.setEndPoint(_d8e,_d8c);_d91=_d8d.text.length-_d96;return false;}_d92=node;return true;});}else{_d90=_d8f;_d91=0;}if(!end&&_d90.nodeType==1&&_d91==_d90.childNodes.length){var _d97=_d90.nextSibling;if(_d97&&_d97.nodeType==3){_d90=_d97;_d91=0;}}return [_d90,_d91];},setEndPoint:function(_d98,_d99,_d9a){var _d9b=_d98.duplicate(),node,len;if(_d99.nodeType!=3){if(_d9a>0){node=_d99.childNodes[_d9a-1];if(node){if(node.nodeType==3){_d99=node;_d9a=node.length;}else{if(node.nextSibling&&node.nextSibling.nodeType==3){_d99=node.nextSibling;_d9a=0;}else{_d9b.moveToElementText(node.nextSibling?node:_d99);var _d9c=node.parentNode;var _d9d=_d9c.insertBefore(node.ownerDocument.createTextNode(" "),node.nextSibling);_d9b.collapse(false);_d9c.removeChild(_d9d);}}}}else{_d9b.moveToElementText(_d99);_d9b.collapse(true);}}if(_d99.nodeType==3){var _d9e=_d6a.range.adjacentNoneTextNode(_d99);var _d9f=_d9e[0];len=_d9e[1];if(_d9f){_d9b.moveToElementText(_d9f);_d9b.collapse(false);if(_d9f.contentEditable!="inherit"){len++;}}else{_d9b.moveToElementText(_d99.parentNode);_d9b.collapse(true);_d9b.move("character",1);_d9b.move("character",-1);}_d9a+=len;if(_d9a>0){if(_d9b.move("character",_d9a)!=_d9a){console.error("Error when moving!");}}}return _d9b;},decomposeTextRange:function(_da0){var _da1=_d6a.range.ie.getEndPoint(_da0);var _da2=_da1[0],_da3=_da1[1];var _da4=_da1[0],_da5=_da1[1];if(_da0.htmlText.length){if(_da0.htmlText==_da0.text){_da5=_da3+_da0.text.length;}else{_da1=_d6a.range.ie.getEndPoint(_da0,true);_da4=_da1[0],_da5=_da1[1];}}return [_da2,_da3,_da4,_da5];},setRange:function(_da6,_da7,_da8,_da9,_daa,_dab){var _dac=_d6a.range.ie.setEndPoint(_da6,_da7,_da8);_da6.setEndPoint("StartToStart",_dac);if(!_dab){var end=_d6a.range.ie.setEndPoint(_da6,_da9,_daa);}_da6.setEndPoint("EndToEnd",end||_dac);return _da6;}};_d69("dijit.range.W3CRange",null,{constructor:function(){if(arguments.length>0){this.setStart(arguments[0][0],arguments[0][1]);this.setEnd(arguments[0][2],arguments[0][3]);}else{this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}},_updateInternal:function(){if(this.startContainer!==this.endContainer){this.commonAncestorContainer=_d6a.range.getCommonAncestor(this.startContainer,this.endContainer);}else{this.commonAncestorContainer=this.startContainer;}this.collapsed=(this.startContainer===this.endContainer)&&(this.startOffset==this.endOffset);},setStart:function(node,_dad){_dad=parseInt(_dad);if(this.startContainer===node&&this.startOffset==_dad){return;}delete this._cachedBookmark;this.startContainer=node;this.startOffset=_dad;if(!this.endContainer){this.setEnd(node,_dad);}else{this._updateInternal();}},setEnd:function(node,_dae){_dae=parseInt(_dae);if(this.endContainer===node&&this.endOffset==_dae){return;}delete this._cachedBookmark;this.endContainer=node;this.endOffset=_dae;if(!this.startContainer){this.setStart(node,_dae);}else{this._updateInternal();}},setStartAfter:function(node,_daf){this._setPoint("setStart",node,_daf,1);},setStartBefore:function(node,_db0){this._setPoint("setStart",node,_db0,0);},setEndAfter:function(node,_db1){this._setPoint("setEnd",node,_db1,1);},setEndBefore:function(node,_db2){this._setPoint("setEnd",node,_db2,0);},_setPoint:function(what,node,_db3,ext){var _db4=_d6a.range.getIndex(node,node.parentNode).o;this[what](node.parentNode,_db4.pop()+ext);},_getIERange:function(){var r=(this._body||this.endContainer.ownerDocument.body).createTextRange();_d6a.range.ie.setRange(r,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return r;},getBookmark:function(){this._getIERange();return this._cachedBookmark;},_select:function(){var r=this._getIERange();r.select();},deleteContents:function(){var s=this.startContainer,r=this._getIERange();if(s.nodeType===3&&!this.startOffset){this.setStartBefore(s);}r.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=true;},cloneRange:function(){var r=new _d6a.range.W3CRange([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);r._body=this._body;return r;},detach:function(){this._body=null;this.commonAncestorContainer=null;this.startContainer=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=true;}});}return _d6a.range;});},"dojo/dnd/Source":function(){define(["../_base/array","../_base/connect","../_base/declare","../_base/kernel","../_base/lang","../dom-class","../dom-geometry","../mouse","../ready","../topic","./common","./Selector","./Manager"],function(_db5,_db6,_db7,_db8,lang,_db9,_dba,_dbb,_dbc,_dbd,dnd,_dbe,_dbf){if(!_db8.isAsync){_dbc(0,function(){var _dc0=["dojo/dnd/AutoSource","dojo/dnd/Target"];require(_dc0);});}var _dc1=_db7("dojo.dnd.Source",_dbe,{isSource:true,horizontal:false,copyOnly:false,selfCopy:false,selfAccept:true,skipForm:false,withHandles:false,autoSync:false,delay:0,accept:["text"],generateText:true,constructor:function(node,_dc2){lang.mixin(this,lang.mixin({},_dc2));var type=this.accept;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.before=true;this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_db9.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_db9.add(this.node,"dojoDndTarget");}if(this.horizontal){_db9.add(this.node,"dojoDndHorizontal");}this.topics=[_dbd.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),_dbd.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),_dbd.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),_dbd.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(_dc3,_dc4){if(this==_dc3){return !this.copyOnly||this.selfAccept;}for(var i=0;i<_dc4.length;++i){var type=_dc3.getItem(_dc4[i].id).type;var flag=false;for(var j=0;j<type.length;++j){if(type[j] in this.accept){flag=true;break;}}if(!flag){return false;}}return true;},copyState:function(_dc5,self){if(_dc5){return true;}if(arguments.length<2){self=this==_dbf.manager().target;}if(self){if(this.copyOnly){return this.selfCopy;}}else{return this.copyOnly;}return false;},destroy:function(){_dc1.superclass.destroy.call(this);_db5.forEach(this.topics,function(t){t.remove();});this.targetAnchor=null;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}_dc1.superclass.onMouseMove.call(this,e);var m=_dbf.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _dc6=this.getSelectedNodes();if(_dc6.length){m.startDrag(this,_dc6,this.copyState(dnd.getCopyKeyState(e),true));}}}if(this.isDragging){var _dc7=false;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_dba.position(this.current,true);}if(this.horizontal){_dc7=(e.pageX-this.targetBox.x<this.targetBox.w/2)==_dba.isBodyLtr(this.current.ownerDocument);}else{_dc7=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}if(this.current!=this.targetAnchor||_dc7!=this.before){this._markTargetAnchor(_dc7);m.canDrop(!this.current||m.source!=this||!(this.current.id in this.selection));}}},onMouseDown:function(e){if(!this.mouseDown&&this._legalMouseDown(e)&&(!this.skipForm||!dnd.isFormElement(e))){this.mouseDown=true;this._lastX=e.pageX;this._lastY=e.pageY;_dc1.superclass.onMouseDown.call(this,e);}},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;_dc1.superclass.onMouseUp.call(this,e);}},onDndSourceOver:function(_dc8){if(this!==_dc8){this.mouseDown=false;if(this.targetAnchor){this._unmarkTargetAnchor();}}else{if(this.isDragging){var m=_dbf.manager();m.canDrop(this.targetState!="Disabled"&&(!this.current||m.source!=this||!(this.current.id in this.selection)));}}},onDndStart:function(_dc9,_dca,copy){if(this.autoSync){this.sync();}if(this.isSource){this._changeState("Source",this==_dc9?(copy?"Copied":"Moved"):"");}var _dcb=this.accept&&this.checkAcceptance(_dc9,_dca);this._changeState("Target",_dcb?"":"Disabled");if(this==_dc9){_dbf.manager().overSource(this);}this.isDragging=true;},onDndDrop:function(_dcc,_dcd,copy,_dce){if(this==_dce){this.onDrop(_dcc,_dcd,copy);}this.onDndCancel();},onDndCancel:function(){if(this.targetAnchor){this._unmarkTargetAnchor();this.targetAnchor=null;}this.before=true;this.isDragging=false;this.mouseDown=false;this._changeState("Source","");this._changeState("Target","");},onDrop:function(_dcf,_dd0,copy){if(this!=_dcf){this.onDropExternal(_dcf,_dd0,copy);}else{this.onDropInternal(_dd0,copy);}},onDropExternal:function(_dd1,_dd2,copy){var _dd3=this._normalizedCreator;if(this.creator){this._normalizedCreator=function(node,hint){return _dd3.call(this,_dd1.getItem(node.id).data,hint);};}else{if(copy){this._normalizedCreator=function(node){var t=_dd1.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}else{this._normalizedCreator=function(node){var t=_dd1.getItem(node.id);_dd1.delItem(node.id);return {node:node,data:t.data,type:t.type};};}}this.selectNone();if(!copy&&!this.creator){_dd1.selectNone();}this.insertNodes(true,_dd2,this.before,this.current);if(!copy&&this.creator){_dd1.deleteSelectedNodes();}this._normalizedCreator=_dd3;},onDropInternal:function(_dd4,copy){var _dd5=this._normalizedCreator;if(this.current&&this.current.id in this.selection){return;}if(copy){if(this.creator){this._normalizedCreator=function(node,hint){return _dd5.call(this,this.getItem(node.id).data,hint);};}else{this._normalizedCreator=function(node){var t=this.getItem(node.id);var n=node.cloneNode(true);n.id=dnd.getUniqueId();return {node:n,data:t.data,type:t.type};};}}else{if(!this.current){return;}this._normalizedCreator=function(node){var t=this.getItem(node.id);return {node:node,data:t.data,type:t.type};};}this._removeSelection();this.insertNodes(true,_dd4,this.before,this.current);this._normalizedCreator=_dd5;},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){_dc1.superclass.onOverEvent.call(this);_dbf.manager().overSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOver();}},onOutEvent:function(){_dc1.superclass.onOutEvent.call(this);_dbf.manager().outSource(this);if(this.isDragging&&this.targetState!="Disabled"){this.onDraggingOut();}},_markTargetAnchor:function(_dd6){if(this.current==this.targetAnchor&&this.before==_dd6){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_dd6;if(this.targetAnchor){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor,this.before?"Before":"After");this.targetAnchor=null;this.targetBox=null;this.before=true;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");},_legalMouseDown:function(e){if(e.type!="touchstart"&&!_dbb.isLeft(e)){return false;}if(!this.withHandles){return true;}for(var node=e.target;node&&node!==this.node;node=node.parentNode){if(_db9.contains(node,"dojoDndHandle")){return true;}if(_db9.contains(node,"dojoDndItem")||_db9.contains(node,"dojoDndIgnore")){break;}}return false;}});return _dc1;});},"dijit/Calendar":function(){define("dijit/Calendar",["dojo/_base/array","dojo/date","dojo/date/locale","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/_base/event","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/sniff","./CalendarLite","./_Widget","./_CssStateMixin","./_TemplatedMixin","./form/DropDownButton"],function(_dd7,date,_dd8,_dd9,_dda,_ddb,_ddc,_ddd,keys,lang,has,_dde,_ddf,_de0,_de1,_de2){var _de3=_dd9("dijit.Calendar",[_dde,_ddf,_de0],{cssStateNodes:{"decrementMonth":"dijitCalendarArrow","incrementMonth":"dijitCalendarArrow","previousYearLabelNode":"dijitCalendarPreviousYear","nextYearLabelNode":"dijitCalendarNextYear"},setValue:function(_de4){_ddd.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",_de4);},_createMonthWidget:function(){return new _de3._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:lang.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onkeydown","_onKeyDown");this.connect(this.dateRowsNode,"onmouseover","_onDayMouseOver");this.connect(this.dateRowsNode,"onmouseout","_onDayMouseOut");this.connect(this.dateRowsNode,"onmousedown","_onDayMouseDown");this.connect(this.dateRowsNode,"onmouseup","_onDayMouseUp");},_onMonthSelect:function(_de5){var date=new this.dateClassObj(this.currentFocus);date.setDate(1);date.setMonth(_de5);var _de6=this.dateModule.getDaysInMonth(date);var _de7=this.currentFocus.getDate();date.setDate(Math.min(_de7,_de6));this._setCurrentFocusAttr(date);},_onDayMouseOver:function(evt){var node=_ddb.contains(evt.target,"dijitCalendarDateLabel")?evt.target.parentNode:evt.target;if(node&&((node.dijitDateValue&&!_ddb.contains(node,"dijitCalendarDisabledDate"))||node==this.previousYearLabelNode||node==this.nextYearLabelNode)){_ddb.add(node,"dijitCalendarHoveredDate");this._currentNode=node;}},_onDayMouseOut:function(evt){if(!this._currentNode){return;}if(evt.relatedTarget&&evt.relatedTarget.parentNode==this._currentNode){return;}var cls="dijitCalendarHoveredDate";if(_ddb.contains(this._currentNode,"dijitCalendarActiveDate")){cls+=" dijitCalendarActiveDate";}_ddb.remove(this._currentNode,cls);this._currentNode=null;},_onDayMouseDown:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue&&!_ddb.contains(node,"dijitCalendarDisabledDate")){_ddb.add(node,"dijitCalendarActiveDate");this._currentNode=node;}},_onDayMouseUp:function(evt){var node=evt.target.parentNode;if(node&&node.dijitDateValue){_ddb.remove(node,"dijitCalendarActiveDate");}},handleKey:function(evt){var _de8=-1,_de9,_dea=this.currentFocus;switch(evt.keyCode){case keys.RIGHT_ARROW:_de8=1;case keys.LEFT_ARROW:_de9="day";if(!this.isLeftToRight()){_de8*=-1;}break;case keys.DOWN_ARROW:_de8=1;case keys.UP_ARROW:_de9="week";break;case keys.PAGE_DOWN:_de8=1;case keys.PAGE_UP:_de9=evt.ctrlKey||evt.altKey?"year":"month";break;case keys.END:_dea=this.dateModule.add(_dea,"month",1);_de9="day";case keys.HOME:_dea=new this.dateClassObj(_dea);_dea.setDate(1);break;case keys.ENTER:case keys.SPACE:this.set("value",this.currentFocus);break;default:return true;}if(_de9){_dea=this.dateModule.add(_dea,_de9,_de8);}this._setCurrentFocusAttr(_dea);return false;},_onKeyDown:function(evt){if(!this.handleKey(evt)){_ddc.stop(evt);}},onValueSelected:function(){},onChange:function(_deb){this.onValueSelected(_deb);},getClassForDate:function(){}});_de3._MonthDropDownButton=_dd9("dijit.Calendar._MonthDropDownButton",_de2,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new _de3._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect});},_setMonthAttr:function(_dec){var _ded=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_dec);this.dropDown.set("months",_ded);this.containerNode.innerHTML=(has("ie")==6?"":"<div class='dijitSpacer'>"+this.dropDown.domNode.innerHTML+"</div>")+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_ded[_dec.getMonth()]+"</div>";}});_de3._MonthDropDown=_dd9("dijit.Calendar._MonthDropDown",[_ddf,_de1],{months:[],templateString:"<div class='dijitCalendarMonthMenu dijitMenu' "+"data-dojo-attach-event='onclick:_onClick,onmouseover:_onMenuHover,onmouseout:_onMenuHover'></div>",_setMonthsAttr:function(_dee){this.domNode.innerHTML=_dd7.map(_dee,function(_def,idx){return _def?"<div class='dijitCalendarMonthLabel' month='"+idx+"'>"+_def+"</div>":"";}).join("");},_onClick:function(evt){this.onChange(_dda.get(evt.target,"month"));},onChange:function(){},_onMenuHover:function(evt){_ddb.toggle(evt.target,"dijitCalendarMonthLabelHover",evt.type=="mouseover");}});return _de3;});},"esri/layers/OnDemandMode":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojo/has","esri/kernel","esri/geometry/Point","esri/tasks/query","esri/layers/RenderMode","esri/layers/GridLayout"],function(_df0,_df1,lang,_df2,has,_df3,_df4,_df5,_df6,_df7){var _df8=_df0([_df6],{declaredClass:"esri.layers._OnDemandMode",constructor:function(_df9){this.featureLayer=_df9;this._featureMap={};this._queryErrorHandler=lang.hitch(this,this._queryErrorHandler);},initialize:function(map){this.inherited(arguments);var _dfa=this.featureLayer,_dfb=_dfa._srInfo;this._gridLayer=new _df7(new _df4(_dfb?_dfb.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_dfa._tileWidth,height:_dfa._tileHeight},{width:map.width,height:map.height},_dfb);this._cellMap={};this._gridLayer.setResolution(map.extent);},startup:function(){this._ioQueue=[];if(!this.featureLayer.suspended){this._zoomHandler();this._enableConnectors();}},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}else{console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id = "+this.featureLayer.id+", Layer URL = "+this.featureLayer.url);}}},destroy:function(){this._disableConnectors();this.inherited(arguments);},drawFeature:function(_dfc){var _dfd=this._gridLayer,geom=_dfc.geometry,_dfe=[];if(!geom){return;}_dfe=_dfd.getCellsInExtent((geom.type==="point")?{xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}:geom.getExtent(),false).cells;var _dff=this._cellMap,i,cell,oid=_dfc.attributes[this.featureLayer.objectIdField],_e00,row,col;for(i=0;i<_dfe.length;i++){cell=_dfe[i];_e00=cell.latticeID;row=cell.row;col=cell.col;if(_e00){cell=(_dff[_e00]=(_dff[_e00]||cell));}else{_dff[row]=_dff[row]||{};cell=(_dff[row][col]=(_dff[row][col]||cell));}cell.features=cell.features||[];cell.features.push(_dfc);this._addFeatureIIf(oid,_dfc);this._incRefCount(oid);}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_enableConnectors:function(){var map=this.map;this._zoomConnect=_df1.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_df1.connect(map,"onPanEnd",this,this._panHandler);this._resizeConnect=_df1.connect(map,"onResize",this,this._panHandler);},_disableConnectors:function(){_df1.disconnect(this._zoomConnect);_df1.disconnect(this._panConnect);_df1.disconnect(this._resizeConnect);},_zoomHandler:function(){this._processIOQueue(true);var _e01=this.featureLayer,map=this.map;if(_e01.suspended){return;}_e01._fireUpdateStart();this._clearIIf();var _e02=_e01._trackManager;if(_e02){_e02.clearTracks();}this._cellMap={};this._gridLayer.setResolution(map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest(this.featureLayer._resized&&arguments[0]);},_getRequestId:function(_e03,cell){var id="_"+_e03.name+_e03.layerId+_e03._ulid+"_"+cell.resolution+"_"+(cell.latticeID||(cell.row+"_"+cell.col));return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(_e04){this._exceeds=false;var _e05=this.featureLayer,map=this.map,_e06=_e04||map.extent,_e07=this._gridLayer.getCellsInExtent(_e06,_e05.latticeTiling),_e08=_e07.cells;if(!_e05.isEditable()){var _e09=this._cellMap;_e08=_df2.filter(_e08,function(cell){if(cell.lattice){if(_e09[cell.latticeID]){return false;}}else{if(_e09[cell.row]&&_e09[cell.row][cell.col]){return false;}}return true;});}var _e0a=_e05.getOutFields(),_e0b=_e05.getDefinitionExpression(),time=_e05._getOffsettedTE(_e05._mapTimeExtent),_e0c=_e05._usePatch,_e0d=this._ioQueue,i,self=this,func=this._drawFeatures,cell,_e0e,_e0f;this._pending=this._pending||0;for(i=0;i<_e08.length;i++){cell=_e08[i];_e0e=new _df5();_e0e.geometry=cell.extent||cell.lattice;_e0e.outFields=_e0a;_e0e.where=_e0b;if(_e05.latticeTiling&&cell.extent){_e0e.spatialRelationship=_df5.SPATIAL_REL_CONTAINS;}_e0e.returnGeometry=true;_e0e.timeExtent=time;_e0e.maxAllowableOffset=_e05._maxOffset;if(_e05._ts){_e0e._ts=(new Date()).getTime();}_e0f=null;if(_e0c){_e0f=this._getRequestId(_e05,cell);if(this._isPending(_e0f)){continue;}}this._pending++;_e0d.push(_e05._task.execute(_e0e,function(){var _e10=cell;return function(_e11){func.apply(self,[_e11,_e10]);};}.call(this),this._queryErrorHandler,_e0f));}this._removeOldCells(_e06);this._endCheck();},_drawFeatures:function(_e12,cell){this._exceeds=this._exceeds||_e12.exceededTransferLimit;this._finalizeIO();var _e13=this.featureLayer,map=this.map,_e14=map.extent,_e15=cell.extent,row=cell.row,col=cell.col,_e16=_e13.objectIdField,_e17=_e12.features,_e18=this._gridLayer,_e19=this._cellMap,i,len,_e1a=cell.latticeID,_e1b=_e1a?_e19[_e1a]:(_e19[row]&&_e19[row][col]);if((cell.resolution!=_e18._resolution)||(_e1a?(_e1a!==_e18.getLatticeID(_e14)):(!_e18.intersects(_e15,_e14)))){if(_e1b){this._removeCell(row,col,_e1a);}}else{if(_e1b){this._updateCell(_e1b,_e17);}else{cell.features=_e17;if(_e1a){_e19[_e1a]=cell;}else{_e19[row]=_e19[row]||{};_e19[row][col]=cell;}len=_e17.length;for(i=0;i<len;i++){var _e1c=_e17[i];var oid=_e1c.attributes[_e16];this._addFeatureIIf(oid,_e1c);this._incRefCount(oid);}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_e1d){if(this._pending===0){this._processIOQueue();var _e1e=this.featureLayer,_e1f=_e1e._trackManager;if(_e1f){_e1f.clearTracks();_e1f.addFeatures(_e1e.graphics);if(_e1e._ager){_df2.forEach(_e1e.graphics,function(_e20){if(_e20._shape){_e1e._repaint(_e20);}});}_e1f.moveLatestToFront();_e1f.drawTracks();}this.featureLayer._fireUpdateEnd(_e1d&&new Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:true}:null);if(this._exceeds){_e1e.onQueryLimitExceeded();}}},_processIOQueue:function(_e21){this._ioQueue=_df2.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_e21){_df2.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_e22){var _e23=this._cellMap,_e24=this._gridLayer,_e25,_e26;for(_e25 in _e23){if(_e23[_e25]){var row=_e23[_e25],_e27=row.latticeID,_e28=0,_e29=0;if(_e27){_e28++;if(_e27!==_e24.getLatticeID(_e22)){this._removeCell(null,null,_e27);_e29++;}}else{for(_e26 in row){if(row[_e26]){_e28++;var _e2a=row[_e26].extent;if(!_e24.intersects(_e2a,_e22)){this._removeCell(_e25,_e26);_e29++;}}}}if(_e29===_e28){delete _e23[_e25];}}}},_updateCell:function(cell,_e2b){var _e2c=this.featureLayer,_e2d=_e2c.objectIdField,_e2e=_e2c._selectedFeatures,i,len=_e2b.length;cell.features=cell.features||[];for(i=0;i<len;i++){var _e2f=_e2b[i];var oid=_e2f.attributes[_e2d];var _e30=this._addFeatureIIf(oid,_e2f);if(_e30===_e2f){this._incRefCount(oid);cell.features.push(_e30);}else{if(!(oid in _e2e)){_e30.setGeometry(_e2f.geometry);_e30.setAttributes(_e2f.attributes);}}}},_removeCell:function(row,col,_e31){var _e32=this._cellMap,_e33=this.featureLayer,_e34=_e33.objectIdField;var cell=_e31?_e32[_e31]:(_e32[row]&&_e32[row][col]);if(cell){if(_e31){delete _e32[_e31];}else{delete _e32[row][col];}var _e35=cell.features,i;for(i=0;i<_e35.length;i++){var _e36=_e35[i];var oid=_e36.attributes[_e34];this._decRefCount(oid);if(oid in _e33._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});if(has("extend-esri")){lang.setObject("layers._OnDemandMode",_df8,_df3);}return _df8;});},"dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_e37,_e38,_e39,keys,_e3a,_e3b,_e3c,_e3d){return _e37("dijit.form._ComboBoxMenu",[_e3a,_e3b,_e3d,_e3c],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;' role='listbox'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_e38.add(this.previousButton,"dijitMenuItemRtl");_e38.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){var item=this.ownerDocument.createElement("div");item.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");item.setAttribute("role","option");return item;},onHover:function(node){_e38.add(node,"dijitMenuItemHover");},onUnhover:function(node){_e38.remove(node,"dijitMenuItemHover");},onSelect:function(node){_e38.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_e38.remove(node,"dijitMenuItemSelected");},_page:function(up){var _e3e=0;var _e3f=this.domNode.scrollTop;var _e40=_e39.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_e3e<_e40){var _e41=this.getHighlightedOption();if(up){if(!_e41.previousSibling||_e41.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_e41.nextSibling||_e41.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _e42=this.domNode.scrollTop;_e3e+=(_e42-_e3f)*(up?-1:1);_e3f=_e42;}},handleKey:function(evt){switch(evt.keyCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"dojox/grid/cells/_base":function(){define("dojox/grid/cells/_base",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/_base/array","dojo/_base/sniff","dojo/dom","dojo/dom-attr","dojo/dom-construct","dijit/_Widget","../util"],function(dojo,_e43,lang,_e44,_e45,_e46,has,dom,_e47,_e48,_e49,util){var _e4a=_e43("dojox.grid._DeferredTextWidget",_e49,{deferred:null,_destroyOnRemove:true,postCreate:function(){if(this.deferred){this.deferred.addBoth(lang.hitch(this,function(text){if(this.domNode){this.domNode.innerHTML=text;}}));}}});var _e4b=function(_e4c){try{util.fire(_e4c,"focus");util.fire(_e4c,"select");}catch(e){}};var _e4d=function(){setTimeout(lang.hitch.apply(dojo,arguments),0);};var _e4e=_e43("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:false,alwaysEditing:false,formatter:null,defaultValue:"...",value:null,hidden:false,noresize:false,draggable:true,_valueProp:"value",_formatPending:false,constructor:function(_e4f){this._props=_e4f||{};lang.mixin(this,_e4f);if(this.draggable===undefined){this.draggable=true;}},_defaultFormat:function(_e50,_e51){var s=this.grid.formatterScope||this;var f=this.formatter;if(f&&s&&typeof f=="string"){f=this.formatter=s[f];}var v=(_e50!=this.defaultValue&&f)?f.apply(s,_e51):_e50;if(typeof v=="undefined"){return this.defaultValue;}if(v&&v.addBoth){v=new _e4a({deferred:v},_e48.create("span",{innerHTML:this.defaultValue}));}if(v&&v.declaredClass&&v.startup){return "<div class='dojoxGridStubNode' linkWidget='"+v.id+"' cellIdx='"+this.index+"'>"+this.defaultValue+"</div>";}return v;},format:function(_e52,_e53){var f,i=this.grid.edit.info,d=this.get?this.get(_e52,_e53):(this.value||this.defaultValue);d=(d&&d.replace&&this.grid.escapeHTMLInData)?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"&amp;").replace(/</g,"&lt;"):d;if(this.editable&&(this.alwaysEditing||(i.rowIndex==_e52&&i.cell==this))){return this.formatEditing(d,_e52);}else{return this._defaultFormat(d,[d,_e52,this]);}},formatEditing:function(_e54,_e55){},getNode:function(_e56){return this.view.getCellNode(_e56,this.index);},getHeaderNode:function(){return this.view.getHeaderCellNode(this.index);},getEditNode:function(_e57){return (this.getNode(_e57)||0).firstChild||0;},canResize:function(){var uw=this.unitWidth;return uw&&(uw!=="auto");},isFlex:function(){var uw=this.unitWidth;return uw&&lang.isString(uw)&&(uw=="auto"||uw.slice(-1)=="%");},applyEdit:function(_e58,_e59){if(this.getNode(_e59)){this.grid.edit.applyCellEdit(_e58,this,_e59);}},cancelEdit:function(_e5a){this.grid.doCancelEdit(_e5a);},_onEditBlur:function(_e5b){if(this.grid.edit.isEditCell(_e5b,this.index)){this.grid.edit.apply();}},registerOnBlur:function(_e5c,_e5d){if(this.commitOnBlur){_e45.connect(_e5c,"onblur",function(e){setTimeout(lang.hitch(this,"_onEditBlur",_e5d),250);});}},needFormatNode:function(_e5e,_e5f){this._formatPending=true;_e4d(this,"_formatNode",_e5e,_e5f);},cancelFormatNode:function(){this._formatPending=false;},_formatNode:function(_e60,_e61){if(this._formatPending){this._formatPending=false;if(!has("ie")){dom.setSelectable(this.grid.domNode,true);}this.formatNode(this.getEditNode(_e61),_e60,_e61);}},formatNode:function(_e62,_e63,_e64){if(has("ie")){_e4d(this,"focus",_e64,_e62);}else{this.focus(_e64,_e62);}},dispatchEvent:function(m,e){if(m in this){return this[m](e);}},getValue:function(_e65){return this.getEditNode(_e65)[this._valueProp];},setValue:function(_e66,_e67){var n=this.getEditNode(_e66);if(n){n[this._valueProp]=_e67;}},focus:function(_e68,_e69){_e4b(_e69||this.getEditNode(_e68));},save:function(_e6a){this.value=this.value||this.getValue(_e6a);},restore:function(_e6b){this.setValue(_e6b,this.value);},_finish:function(_e6c){dom.setSelectable(this.grid.domNode,false);this.cancelFormatNode();},apply:function(_e6d){this.applyEdit(this.getValue(_e6d),_e6d);this._finish(_e6d);},cancel:function(_e6e){this.cancelEdit(_e6e);this._finish(_e6e);}});_e4e.markupFactory=function(node,_e6f){var _e70=lang.trim(_e47.get(node,"formatter")||"");if(_e70){_e6f.formatter=lang.getObject(_e70)||_e70;}var get=lang.trim(_e47.get(node,"get")||"");if(get){_e6f.get=lang.getObject(get);}var _e71=function(attr,cell,_e72){var _e73=lang.trim(_e47.get(node,attr)||"");if(_e73){cell[_e72||attr]=!(_e73.toLowerCase()=="false");}};_e71("sortDesc",_e6f);_e71("editable",_e6f);_e71("alwaysEditing",_e6f);_e71("noresize",_e6f);_e71("draggable",_e6f);var _e74=lang.trim(_e47.get(node,"loadingText")||_e47.get(node,"defaultValue")||"");if(_e74){_e6f.defaultValue=_e74;}var _e75=function(attr,cell,_e76){var _e77=lang.trim(_e47.get(node,attr)||"")||undefined;if(_e77){cell[_e76||attr]=_e77;}};_e75("styles",_e6f);_e75("headerStyles",_e6f);_e75("cellStyles",_e6f);_e75("classes",_e6f);_e75("headerClasses",_e6f);_e75("cellClasses",_e6f);};var Cell=_e43("dojox.grid.cells.Cell",_e4e,{constructor:function(){this.keyFilter=this.keyFilter;},keyFilter:null,formatEditing:function(_e78,_e79){this.needFormatNode(_e78,_e79);return "<input class=\"dojoxGridInput\" type=\"text\" value=\""+_e78+"\">";},formatNode:function(_e7a,_e7b,_e7c){this.inherited(arguments);this.registerOnBlur(_e7a,_e7c);},doKey:function(e){if(this.keyFilter){var key=String.fromCharCode(e.charCode);if(key.search(this.keyFilter)==-1){_e44.stop(e);}}},_finish:function(_e7d){this.inherited(arguments);var n=this.getEditNode(_e7d);try{util.fire(n,"blur");}catch(e){}}});Cell.markupFactory=function(node,_e7e){_e4e.markupFactory(node,_e7e);var _e7f=lang.trim(_e47.get(node,"keyFilter")||"");if(_e7f){_e7e.keyFilter=new RegExp(_e7f);}};var _e80=_e43("dojox.grid.cells.RowIndex",Cell,{name:"Row",postscript:function(){this.editable=false;},get:function(_e81){return _e81+1;}});_e80.markupFactory=function(node,_e82){Cell.markupFactory(node,_e82);};var _e83=_e43("dojox.grid.cells.Select",Cell,{options:null,values:null,returnIndex:-1,constructor:function(_e84){this.values=this.values||this.options;},formatEditing:function(_e85,_e86){this.needFormatNode(_e85,_e86);var h=["<select class=\"dojoxGridSelect\">"];for(var i=0,o,v;((o=this.options[i])!==undefined)&&((v=this.values[i])!==undefined);i++){v=v.replace?v.replace(/&/g,"&amp;").replace(/</g,"&lt;"):v;o=o.replace?o.replace(/&/g,"&amp;").replace(/</g,"&lt;"):o;h.push("<option",(_e85==v?" selected":"")," value=\""+v+"\"",">",o,"</option>");}h.push("</select>");return h.join("");},_defaultFormat:function(_e87,_e88){var v=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var i=_e46.indexOf(this.values,v);if(i>=0){v=this.options[i];}}return v;},getValue:function(_e89){var n=this.getEditNode(_e89);if(n){var i=n.selectedIndex,o=n.options[i];return this.returnIndex>-1?i:o.value||o.innerHTML;}}});_e83.markupFactory=function(node,cell){Cell.markupFactory(node,cell);var _e8a=lang.trim(_e47.get(node,"options")||"");if(_e8a){var o=_e8a.split(",");if(o[0]!=_e8a){cell.options=o;}}var _e8b=lang.trim(_e47.get(node,"values")||"");if(_e8b){var v=_e8b.split(",");if(v[0]!=_e8b){cell.values=v;}}};var _e8c=_e43("dojox.grid.cells.AlwaysEdit",Cell,{alwaysEditing:true,_formatNode:function(_e8d,_e8e){this.formatNode(this.getEditNode(_e8e),_e8d,_e8e);},applyStaticValue:function(_e8f){var e=this.grid.edit;e.applyCellEdit(this.getValue(_e8f),this,_e8f);e.start(this,_e8f,true);}});_e8c.markupFactory=function(node,cell){Cell.markupFactory(node,cell);};var Bool=_e43("dojox.grid.cells.Bool",_e8c,{_valueProp:"checked",formatEditing:function(_e90,_e91){return "<input class=\"dojoxGridInput\" type=\"checkbox\""+(_e90?" checked=\"checked\"":"")+" style=\"width: auto\" />";},doclick:function(e){if(e.target.tagName=="INPUT"){this.applyStaticValue(e.rowIndex);}}});Bool.markupFactory=function(node,cell){_e8c.markupFactory(node,cell);};return _e4e;});},"esri/toolbars/edit":function(){define("esri/toolbars/edit",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/_base/Color","dojo/has","esri/kernel","esri/lang","esri/sniff","esri/toolbars/_toolbar","esri/toolbars/_Box","esri/toolbars/_GraphicMover","esri/toolbars/_VertexEditor","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"],function(_e92,lang,_e93,_e94,_e95,has,_e96,_e97,_e98,_e99,Box,_e9a,_e9b,_e9c,_e9d){var EDT=_e92(_e99,{declaredClass:"esri.toolbars.Edit",constructor:function(map,_e9e){this._map=map;this._tool=0;this._scratchGL=map.graphics;var _e9f=has("esri-touch")||has("esri-pointer");this._defaultOptions=lang.mixin({vertexSymbol:new _e9c(_e9c.STYLE_CIRCLE,_e9f?20:12,new _e9d(_e9d.STYLE_SOLID,new _e95([0,0,0,0.5]),1),new _e95([128,128,128])),ghostVertexSymbol:new _e9c(_e9c.STYLE_CIRCLE,_e9f?18:10,new _e9d(_e9d.STYLE_SOLID,new _e95([0,0,0,0.5]),1),new _e95([255,255,255,0.75])),ghostLineSymbol:new _e9d(_e9d.STYLE_DOT,new _e95([128,128,128]),2),allowDeleteVertices:true,allowAddVertices:true,rotateHandleOffset:_e9f?24:16,boxLineSymbol:new _e9d(_e9d.STYLE_DASH,new _e95([64,64,64]),1),boxHandleSymbol:new _e9c(_e9c.STYLE_SQUARE,_e9f?16:9,new _e9d(_e9d.STYLE_SOLID,new _e95([0,0,0,0.5]),1),new _e95([255,255,255,0.75]))},_e9e||{});},activate:function(tool,_ea0,_ea1){this.deactivate();this._graphic=_ea0;this._options=lang.mixin(lang.mixin({},this._defaultOptions),_ea1||{});var MOVE=EDT.MOVE,EDIT=EDT.EDIT_VERTICES,_ea2=EDT.SCALE,_ea3=EDT.ROTATE,move=false,edit=false,box=false,map=this._map,_ea4=map.spatialReference,_ea5=_ea0.geometry.spatialReference;this._geo=!!(_ea4&&_ea5&&!_ea4.equals(_ea5)&&_ea4.isWebMercator()&&_ea5.wkid===4326);if((tool&MOVE)===MOVE){move=this._enableMove(_ea0);}var _ea6=((tool&_ea2)===_ea2),_ea7=((tool&_ea3)===_ea3);if(_ea6||_ea7){box=this._enableBoxEditing(_ea0,_ea6,_ea7);}if((tool&EDIT)===EDIT){edit=this._enableVertexEditing(_ea0);}if(!(move||edit||box)){throw new Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");}this._tool=tool;if(this._tool){this._mapPanEndHandle=_e93.connect(map,"onPanEnd",this,this._mapPanEndHandler);this._mapExtChgHandle=_e93.connect(map,"onExtentChange",this,this._mapExtentChangeHandler);this.onActivate(this._tool,_ea0);}if(map.snappingManager&&(move||edit)){map.snappingManager._startSelectionLayerQuery();}},deactivate:function(){var tool=this._tool,_ea8=this._graphic;if(!tool){return;}var _ea9=!!this._modified;this._clear();_e93.disconnect(this._mapPanEndHandle);_e93.disconnect(this._mapExtChgHandle);this._mapPanEndHandle=this._mapExtChgHandle=null;this._graphic=this._geo=null;this.onDeactivate(tool,_ea8,{isModified:_ea9});if(this._map.snappingManager){this._map.snappingManager._stopSelectionLayerQuery();}},refresh:function(){this._refreshMoveables(true);},getCurrentState:function(){return {tool:this._tool,graphic:this._graphic,isModified:!!this._modified};},onActivate:function(tool,_eaa){},onDeactivate:function(tool,_eab,info){},onGraphicMoveStart:function(_eac){},onGraphicFirstMove:function(_ead){this._modified=true;},onGraphicMove:function(_eae,_eaf){},onGraphicMoveStop:function(_eb0,_eb1){},onGraphicClick:function(_eb2,info){},onVertexMoveStart:function(_eb3,_eb4){},onVertexFirstMove:function(_eb5,_eb6){this._modified=true;},onVertexMove:function(_eb7,_eb8,_eb9){},onVertexMoveStop:function(_eba,_ebb,_ebc){},onVertexAdd:function(_ebd,_ebe){this._modified=true;},onVertexClick:function(_ebf,_ec0){},onVertexMouseOver:function(_ec1,_ec2){},onVertexMouseOut:function(_ec3,_ec4){},onVertexDelete:function(_ec5,_ec6){this._modified=true;},onScaleStart:function(_ec7){},onScaleFirstMove:function(_ec8){this._modified=true;},onScale:function(_ec9,info){},onScaleStop:function(_eca,info){},onRotateStart:function(_ecb){},onRotateFirstMove:function(_ecc){this._modified=true;},onRotate:function(_ecd,info){},onRotateStop:function(_ece,info){},_enableMove:function(_ecf){var map=this._map,type=_ecf.geometry.type;switch(type){case "point":case "polyline":case "polygon":this._graphicMover=new _e9a(_ecf,map,this);return true;case "multipoint":break;}return false;},_enableVertexEditing:function(_ed0){var map=this._map,type=_ed0.geometry.type;switch(type){case "point":break;case "multipoint":case "polyline":case "polygon":this._vertexEditor=_e9b.create(_ed0,map,this);return true;}return false;},_enableBoxEditing:function(_ed1,_ed2,_ed3){var map=this._map,type=_ed1.geometry.type;switch(type){case "point":case "multipoint":break;case "polyline":case "polygon":this._boxEditor=new Box(_ed1,map,this,_ed2,_ed3,this._options.uniformScaling);return true;}return false;},_disableMove:function(){var _ed4=this._graphicMover;if(_ed4){_ed4.destroy();this._graphicMover=null;}},_disableVertexEditing:function(){var _ed5=this._vertexEditor;if(_ed5){_ed5.destroy();this._vertexEditor=null;}},_disableBoxEditing:function(){var box=this._boxEditor;if(box){box.destroy();this._boxEditor=null;}},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._tool=0;this._modified=false;},_mapPanEndHandler:function(){this._refreshMoveables();},_mapExtentChangeHandler:function(e,d,_ed6){if(_ed6){this._refreshMoveables();}},_refreshMoveables:function(_ed7){var _ed8=_e94.filter([this._graphicMover,this._vertexEditor,this._boxEditor],_e97.isDefined);_e94.forEach(_ed8,function(mov){mov.refresh(_ed7);});},_beginOperation:function(_ed9){_e94.forEach(this._getAffectedTools(_ed9),function(tool){tool.suspend();});},_endOperation:function(_eda){_e94.forEach(this._getAffectedTools(_eda),function(tool){tool.resume();});},_getAffectedTools:function(_edb){var _edc=[];switch(_edb){case "MOVE":_edc=[this._vertexEditor,this._boxEditor];break;case "VERTICES":_edc=[this._boxEditor];break;case "BOX":_edc=[this._vertexEditor];break;}_edc=_e94.filter(_edc,_e97.isDefined);return _edc;}});lang.mixin(EDT,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8});if(has("extend-esri")){lang.setObject("toolbars.Edit",EDT,_e96);}return EDT;});},"esri/toolbars/_VertexMover":function(){define("esri/toolbars/_VertexMover",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/has","dojo/sniff","dojo/dom-style","dojox/gfx/Moveable","esri/kernel","esri/geometry/Point","esri/graphic","esri/geometry/webMercatorUtils"],function(_edd,lang,_ede,has,_edf,_ee0,_ee1,_ee2,_ee3,_ee4,_ee5){var VM=_edd(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(_ee6,_ee7,_ee8,_ee9,_eea,_eeb,_eec,_eed){this.point=_ee6;this.symbol=_ee7;this.relatedGraphic=_ee8;this.segIndex=_ee9;this.ptIndex=_eea;this.segLength=_eeb;this.editor=_eec;this.map=_eec.map;this._scratchGL=_eec.toolbar._scratchGL;this._placeholder=_eed||false;this._type=_ee8.geometry.type;this._init();this._enable();},refresh:function(_eee){if(_eee||this._needRefresh()){this._disable();this._enable();}},destroy:function(){this._disable();if(this.graphic){this._scratchGL.remove(this.graphic);}this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null;},_init:function(){var _eef=new _ee3(this.point.toJson());var _ef0=new _ee4(_eef,this.symbol);switch(this._type){case "multipoint":_ef0._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(_ef0);break;}this.graphic=_ef0;},_enable:function(){var _ef1=this.graphic.getDojoShape();if(_ef1){_ef1._hasMover=true;this._moveable=this._getMoveable(_ef1);var node=_ef1.getEventSource();if(node){_ee0.set(node,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]);}}},_disable:function(){var _ef2=this._moveable;if(_ef2){_ede.disconnect(this._startHandle);_ede.disconnect(this._firstHandle);_ede.disconnect(this._movingHandle);_ede.disconnect(this._stopHandle);var _ef3=_ef2.shape;if(_ef3){var node=_ef3.getEventSource();if(node){_ee0.set(node,"cursor",null);}}_ef2.destroy();this._moveable=null;}},_needRefresh:function(){var _ef4=this.graphic.getDojoShape(),need=false;if(_ef4){switch(this._type){case "multipoint":var _ef5=this.relatedGraphic.getDojoShape();if(_ef5){var _ef6=_ef5.children[this.ptIndex];if(_ef4!==_ef6){_ef4=_ef6;this.graphic._shape=_ef4;need=true;}}break;case "polyline":case "polygon":need=!_ef4._hasMover;break;}}return need;},_getMoveable:function(_ef7){var _ef8=new _ee1(_ef7,_edf("mac")&&_edf("ff")&&!has("esri-touch")&&{leftButtonOnly:true});this._startHandle=_ede.connect(_ef8,"onMoveStart",this,this._moveStartHandler);this._firstHandle=_ede.connect(_ef8,"onFirstMove",this,this._firstMoveHandler);this._movingHandle=_ede.connect(_ef8,"onMoving",this,this._movingHandler);this._stopHandle=_ede.connect(_ef8,"onMoveStop",this,this._moveStopHandler);return _ef8;},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0);},_getInfo:function(){return {graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()};},_moveStartHandler:function(_ef9){var map=this.map;if(map.snappingManager){map.snappingManager._setUpSnapping();}_ef9.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo());},_firstMoveHandler:function(_efa){var _efb=_efa.shape;var _efc=this._getControlEdges();var _efd=this._scratchGL._div;var i,_efe=[],_eff=_efa.host.shape._wrapOffsets[0]||0;for(i=0;i<_efc.length;i++){var edge=_efc[i];edge.x1+=_eff;edge.x2+=_eff;_efe.push([_efd.createLine({x1:edge.x1,y1:edge.y1,x2:edge.x2,y2:edge.y2}).setStroke(this.editor._lineStroke),edge.x1,edge.y1,edge.x2,edge.y2]);}_efb._lines=_efe;_efa.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo());},_movingHandler:function(_f00){var _f01=_f00.shape,tx=_f01.getTransform();var i,_f02=_f01._lines;for(i=0;i<_f02.length;i++){var line=_f02[i];line[0].setShape({x1:line[1]+tx.dx,y1:line[2]+tx.dy,x2:line[3],y2:line[4]});}this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),tx);},_moveStopHandler:function(_f03){var _f04=_f03.shape,_f05=this.editor.toolbar,tx=_f04.getTransform(),map=this.map,host=this.graphic,_f06=_f05._geo?_ee5.geographicToWebMercator(host.geometry):host.geometry;var i,_f07=_f04._lines;if(_f07){for(i=0;i<_f07.length;i++){_f07[i][0].removeShape();}_f04._lines=null;}var ph=false,_f08=true,info=this._getInfo();if(tx&&(tx.dx||tx.dy)){if(this._placeholder){this._placeholder=false;ph=true;}}else{_f08=false;}var _f09;if(map.snappingManager){_f09=map.snappingManager._snappingPoint;}var _f0a=_f09||map.toMap(map.toScreen(_f06).offset(tx.dx,tx.dy));if(map.snappingManager){map.snappingManager._killOffSnapping();}_f04.setTransform(null);host.setGeometry(_f05._geo?_ee5.webMercatorToGeographic(_f0a,true):_f0a);this.constructor.onMoveStop(this,tx);_f05.onVertexMoveStop(this.relatedGraphic,info,tx);if(!_f08){_f05.onVertexClick(this.relatedGraphic,info);}if(ph){_f05.onVertexAdd(this.relatedGraphic,this._getInfo());}},_getControlEdges:function(){var map=this.map;var _f0b=this.relatedGraphic.geometry;var _f0c=this.segIndex,_f0d=this.ptIndex,_f0e=this.segLength;var _f0f=this._scratchGL._div;var _f10=_f0f.getTransform();var sdx=_f10.dx,sdy=_f10.dy;var pt=map.toScreen(this.graphic.geometry);var x=pt.x-sdx,y=pt.y-sdy;var _f11=[];var _f12=this.editor._getControlPoints(this,_f0b,_f0c,_f0d,_f0e);if(_f12[0]){_f11.push({x1:x,y1:y,x2:_f12[0].x-sdx,y2:_f12[0].y-sdy});}if(_f12[1]){_f11.push({x1:x,y1:y,x2:_f12[1].x-sdx,y2:_f12[1].y-sdy});}return _f11;}});if(has("extend-esri")){lang.setObject("toolbars.VertexMover",VM,_ee2);}lang.mixin(VM,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}});return VM;});},"dijit/CalendarLite":function(){require({cache:{"url:dijit/templates/Calendar.html":"<table cellspacing=\"0\" cellpadding=\"0\" class=\"dijitCalendarContainer\" role=\"grid\" aria-labelledby=\"${id}_mddb ${id}_year\">\n\t<thead>\n\t\t<tr class=\"dijitReset dijitCalendarMonthContainer\" valign=\"top\">\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"decrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarDecrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"decreaseArrowNode\" class=\"dijitA11ySideArrow\">-</span>\n\t\t\t</th>\n\t\t\t<th class='dijitReset' colspan=\"5\">\n\t\t\t\t<div data-dojo-attach-point=\"monthNode\">\n\t\t\t\t</div>\n\t\t\t</th>\n\t\t\t<th class='dijitReset dijitCalendarArrow' data-dojo-attach-point=\"incrementMonth\">\n\t\t\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitCalendarIncrementControl dijitCalendarIncrease\" role=\"presentation\"/>\n\t\t\t\t<span data-dojo-attach-point=\"increaseArrowNode\" class=\"dijitA11ySideArrow\">+</span>\n\t\t\t</th>\n\t\t</tr>\n\t\t<tr role=\"row\">\n\t\t\t${!dayCellsHtml}\n\t\t</tr>\n\t</thead>\n\t<tbody data-dojo-attach-point=\"dateRowsNode\" data-dojo-attach-event=\"onclick: _onDayClick\" class=\"dijitReset dijitCalendarBodyContainer\">\n\t\t\t${!dateRowsHtml}\n\t</tbody>\n\t<tfoot class=\"dijitReset dijitCalendarYearContainer\">\n\t\t<tr>\n\t\t\t<td class='dijitReset' valign=\"top\" colspan=\"7\" role=\"presentation\">\n\t\t\t\t<div class=\"dijitCalendarYearLabel\">\n\t\t\t\t\t<span data-dojo-attach-point=\"previousYearLabelNode\" class=\"dijitInline dijitCalendarPreviousYear\" role=\"button\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"currentYearLabelNode\" class=\"dijitInline dijitCalendarSelectedYear\" role=\"button\" id=\"${id}_year\"></span>\n\t\t\t\t\t<span data-dojo-attach-point=\"nextYearLabelNode\" class=\"dijitInline dijitCalendarNextYear\" role=\"button\"></span>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t</tfoot>\n</table>\n"}});define("dijit/CalendarLite",["dojo/_base/array","dojo/_base/declare","dojo/cldr/supplemental","dojo/date","dojo/date/locale","dojo/date/stamp","dojo/dom","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/sniff","dojo/string","./_WidgetBase","./_TemplatedMixin","dojo/text!./templates/Calendar.html","./hccss"],function(_f13,_f14,_f15,date,_f16,_f17,dom,_f18,_f19,lang,has,_f1a,_f1b,_f1c,_f1d){var _f1e=_f14("dijit.CalendarLite",[_f1b,_f1c],{templateString:_f1d,dowTemplateString:"<th class=\"dijitReset dijitCalendarDayLabelTemplate\" role=\"columnheader\"><span class=\"dijitCalendarDayLabel\">${d}</span></th>",dateTemplateString:"<td class=\"dijitReset\" role=\"gridcell\" data-dojo-attach-point=\"dateCells\"><span class=\"dijitCalendarDateLabel\" data-dojo-attach-point=\"dateLabels\"></span></td>",weekTemplateString:"<tr class=\"dijitReset dijitCalendarWeekTemplate\" role=\"row\">${d}${d}${d}${d}${d}${d}${d}</tr>",value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date(),baseClass:"dijitCalendar",_isValidDate:function(_f1f){return _f1f&&!isNaN(_f1f)&&typeof _f1f=="object"&&_f1f.toString()!=this.constructor.prototype.value.toString();},_getValueAttr:function(){if(this.value&&!isNaN(this.value)){var _f20=new this.dateClassObj(this.value);_f20.setHours(0,0,0,0);if(_f20.getDate()<this.value.getDate()){_f20=this.dateModule.add(_f20,"hour",1);}return _f20;}else{return null;}},_setValueAttr:function(_f21,_f22){if(typeof _f21=="string"){_f21=_f17.fromISOString(_f21);}_f21=this._patchDate(_f21);if(this._isValidDate(_f21)&&!this.isDisabledDate(_f21,this.lang)){this._set("value",_f21);this.set("currentFocus",_f21);this._markSelectedDates([_f21]);if(this._created&&(_f22||typeof _f22=="undefined")){this.onChange(this.get("value"));}}else{this._set("value",null);this._markSelectedDates([]);}},_patchDate:function(_f23){if(_f23){_f23=new this.dateClassObj(_f23);_f23.setHours(1,0,0,0);}return _f23;},_setText:function(node,text){while(node.firstChild){node.removeChild(node.firstChild);}node.appendChild(node.ownerDocument.createTextNode(text));},_populateGrid:function(){var _f24=new this.dateClassObj(this.currentFocus);_f24.setDate(1);var _f25=_f24.getDay(),_f26=this.dateModule.getDaysInMonth(_f24),_f27=this.dateModule.getDaysInMonth(this.dateModule.add(_f24,"month",-1)),_f28=new this.dateClassObj(),_f29=_f15.getFirstDayOfWeek(this.lang);if(_f29>_f25){_f29-=7;}this._date2cell={};_f13.forEach(this.dateCells,function(_f2a,idx){var i=idx+_f29;var date=new this.dateClassObj(_f24),_f2b,_f2c="dijitCalendar",adj=0;if(i<_f25){_f2b=_f27-_f25+i+1;adj=-1;_f2c+="Previous";}else{if(i>=(_f25+_f26)){_f2b=i-_f25-_f26+1;adj=1;_f2c+="Next";}else{_f2b=i-_f25+1;_f2c+="Current";}}if(adj){date=this.dateModule.add(date,"month",adj);}date.setDate(_f2b);if(!this.dateModule.compare(date,_f28,"date")){_f2c="dijitCalendarCurrentDate "+_f2c;}if(this.isDisabledDate(date,this.lang)){_f2c="dijitCalendarDisabledDate "+_f2c;_f2a.setAttribute("aria-disabled","true");}else{_f2c="dijitCalendarEnabledDate "+_f2c;_f2a.removeAttribute("aria-disabled");_f2a.setAttribute("aria-selected","false");}var _f2d=this.getClassForDate(date,this.lang);if(_f2d){_f2c=_f2d+" "+_f2c;}_f2a.className=_f2c+"Month dijitCalendarDateTemplate";var _f2e=date.valueOf();this._date2cell[_f2e]=_f2a;_f2a.dijitDateValue=_f2e;this._setText(this.dateLabels[idx],date.getDateLocalized?date.getDateLocalized(this.lang):date.getDate());},this);},_populateControls:function(){var _f2f=new this.dateClassObj(this.currentFocus);_f2f.setDate(1);this.monthWidget.set("month",_f2f);var y=_f2f.getFullYear()-1;var d=new this.dateClassObj();_f13.forEach(["previous","current","next"],function(name){d.setFullYear(y++);this._setText(this[name+"YearLabelNode"],this.dateLocaleModule.format(d,{selector:"year",locale:this.lang}));},this);},goToToday:function(){this.set("value",new this.dateClassObj());},constructor:function(_f30){this.dateModule=_f30.datePackage?lang.getObject(_f30.datePackage,false):date;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=_f30.datePackage?lang.getObject(_f30.datePackage+".locale",false):_f16;},_createMonthWidget:function(){return _f1e._MonthWidget({id:this.id+"_mw",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode);},buildRendering:function(){var d=this.dowTemplateString,_f31=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),_f32=_f15.getFirstDayOfWeek(this.lang);this.dayCellsHtml=_f1a.substitute([d,d,d,d,d,d,d].join(""),{d:""},function(){return _f31[_f32++%7];});var r=_f1a.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[r,r,r,r,r,r].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);dom.setSelectable(this.domNode,false);var _f33=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",_f33,false);},postCreate:function(){this.inherited(arguments);this._connectControls();},_connectControls:function(){var _f34=lang.hitch(this,function(_f35,part,_f36){this.connect(this[_f35],"onclick",function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,part,_f36));});});_f34("incrementMonth","month",1);_f34("decrementMonth","month",-1);_f34("nextYearLabelNode","year",1);_f34("previousYearLabelNode","year",-1);},_setCurrentFocusAttr:function(date,_f37){var _f38=this.currentFocus,_f39=this._getNodeByDate(_f38);date=this._patchDate(date);this._set("currentFocus",date);if(!this._date2cell||this.dateModule.difference(_f38,date,"month")!=0){this._populateGrid();this._populateControls();this._markSelectedDates([this.value]);}var _f3a=this._getNodeByDate(date);_f3a.setAttribute("tabIndex",this.tabIndex);if(this.focused||_f37){_f3a.focus();}if(_f39&&_f39!=_f3a){if(has("webkit")){_f39.setAttribute("tabIndex","-1");}else{_f39.removeAttribute("tabIndex");}}},focus:function(){this._setCurrentFocusAttr(this.currentFocus,true);},_onDayClick:function(evt){_f19.stop(evt);for(var node=evt.target;node&&!node.dijitDateValue;node=node.parentNode){}if(node&&!_f18.contains(node,"dijitCalendarDisabledDate")){this.set("value",node.dijitDateValue);}},_getNodeByDate:function(_f3b){_f3b=this._patchDate(_f3b);return _f3b&&this._date2cell?this._date2cell[_f3b.valueOf()]:null;},_markSelectedDates:function(_f3c){function mark(_f3d,cell){_f18.toggle(cell,"dijitCalendarSelectedDate",_f3d);cell.setAttribute("aria-selected",_f3d?"true":"false");};_f13.forEach(this._selectedCells||[],lang.partial(mark,false));this._selectedCells=_f13.filter(_f13.map(_f3c,this._getNodeByDate,this),function(n){return n;});_f13.forEach(this._selectedCells,lang.partial(mark,true));},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});_f1e._MonthWidget=_f14("dijit.CalendarLite._MonthWidget",_f1b,{_setMonthAttr:function(_f3e){var _f3f=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,_f3e),_f40=(has("ie")==6?"":"<div class='dijitSpacer'>"+_f13.map(_f3f,function(s){return "<div>"+s+"</div>";}).join("")+"</div>");this.domNode.innerHTML=_f40+"<div class='dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'>"+_f3f[_f3e.getMonth()]+"</div>";}});return _f1e;});},"esri/toolbars/_VertexEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/has","dijit/Menu","dijit/MenuItem","esri/kernel","esri/toolbars/_VertexMover","esri/geometry/Point","esri/geometry/jsonUtils","dojo/i18n!esri/nls/jsapi"],function(_f41,lang,_f42,_f43,has,Menu,_f44,_f45,_f46,_f47,_f48,_f49){var GVE=_f41(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(_f4a,map,_f4b){this.graphic=_f4a;this.map=map;this.toolbar=_f4b;var _f4c=_f4b._options;this._symbol1=_f4c.vertexSymbol;this._symbol2=_f4c.ghostVertexSymbol;var _f4d=_f4c.ghostLineSymbol;this._lineStroke={style:_f4d.style,width:_f4d.width,color:_f4d.color};this._canDel=_f4c.allowDeleteVertices;this._canAdd=_f4c.allowAddVertices;this._addControllers();},destroy:function(){this._removeControllers();},refresh:function(_f4e){if(_f4e){this._removeControllers();this._addControllers();}else{this._refresh(this._vertexMovers);this._refresh(this._mpVertexMovers);}},suspend:function(){if(!this._suspended){this._removeControllers();}this._suspended=true;},resume:function(){if(this._suspended){this._addControllers();}this._suspended=false;},_addControllers:function(){this._firstMoveHandle=_f42.connect(_f46,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=_f42.connect(_f46,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);if(this._canAdd){this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,true);}var _f4f=this._getGraphicsLayer();this._mouseOverHandle=_f42.connect(_f4f,"onMouseOver",this,this._mouseOverHandler);this._mouseOutHandle=_f42.connect(_f4f,"onMouseOut",this,this._mouseOutHandler);if(this._canDel){this._ctxMenu=new Menu({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"});var _f50=(this._ctxDelete=new _f44({label:_f49.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}));this._deleteHandle=_f42.connect(_f50,"onClick",this,this._deleteHandler);this._ctxMenu.addChild(_f50);this._ctxMenu.startup();}},_removeControllers:function(){_f42.disconnect(this._firstMoveHandle);_f42.disconnect(this._moveStopHandle);_f42.disconnect(this._mouseOverHandle);_f42.disconnect(this._mouseOutHandle);_f42.disconnect(this._deleteHandle);if(this._ctxMenu){this._ctxDelete=null;this._unbindCtxNode();this._ctxMenu.destroyRecursive();}this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null;},_add:function(_f51,_f52,_f53){var i,j,_f54=this.graphic,_f55=[];for(i=0;i<_f51.length;i++){var _f56=_f51[i],_f57=[];for(j=0;j<_f56.length;j++){_f57.push(new _f46(_f56[j],_f52,_f54,i,j,_f56.length,this,_f53));}_f55.push(_f57);}return _f55;},_remove:function(_f58){if(_f58){_f43.forEach(_f58,function(_f59){_f43.forEach(_f59,function(_f5a){_f5a.destroy();});});}},_refresh:function(_f5b){if(_f5b){_f43.forEach(_f5b,function(_f5c){_f43.forEach(_f5c,function(_f5d){_f5d.refresh();});});}},_isNew:function(_f5e){return (_f43.indexOf(this._vertexMovers[_f5e.segIndex],_f5e)===-1)?true:false;},_getGraphicsLayer:function(){return this.toolbar._scratchGL;},_deleteHandler:function(evt){var _f5f=this._selectedMover,_f60=_f5f.ptIndex;this._updateRelatedGraphic(_f5f,_f5f.relatedGraphic,_f5f.graphic.geometry,_f5f.segIndex,_f5f.ptIndex,_f5f.segLength,false,true);if(this._canAdd){this._deleteMidpoints(_f5f);}this._deleteVertex(_f5f);this.toolbar._endOperation("VERTICES");},_mouseOverHandler:function(evt){var _f61=evt.graphic,_f62=this._findMover(_f61);if(_f62){this.toolbar.onVertexMouseOver(this.graphic,_f62._getInfo());if(!_f62._placeholder){this._selectedMover=_f62;if(this._canDel){this._bindCtxNode(_f61.getDojoShape().getNode());}}}},_mouseOutHandler:function(evt){var _f63=evt.graphic,_f64=this._findMover(_f63);if(_f64){this.toolbar.onVertexMouseOut(this.graphic,_f64._getInfo());}},_bindCtxNode:function(node){this._unbindCtxNode();this._ctxDelete.set("disabled",(this._selectedMover.segLength<=this.minLength)?true:false);this._ctxMenu.bindDomNode(node);this._bindNode=node;},_unbindCtxNode:function(){var node=this._bindNode;if(node){this._ctxMenu.unBindDomNode(node);}},_findMover:function(_f65){var i,_f66=[],_f67=this._mpVertexMovers;_f43.forEach(this._vertexMovers,function(_f68){_f66=_f66.concat(_f68);});if(_f67){_f43.forEach(_f67,function(_f69){_f66=_f66.concat(_f69);});}for(i=0;i<_f66.length;i++){var _f6a=_f66[i];if(_f6a.graphic===_f65){return _f6a;}}},_firstMoveHandler:function(_f6b){if(!this._isNew(_f6b)&&this._canAdd){this._hideRelatedMidpoints(_f6b);}this.toolbar._beginOperation("VERTICES");},_moveStopHandler:function(_f6c,tx){var add=this._isNew(_f6c);if(!tx||!tx.dx&&!tx.dy){if(!add&&this._canAdd){this._showRelatedMidpoints(_f6c);}return;}this._updateRelatedGraphic(_f6c,_f6c.relatedGraphic,_f6c.graphic.geometry,_f6c.segIndex,_f6c.ptIndex,_f6c.segLength,add);if(this._canAdd){if(add){this._addMidpoints(_f6c);}else{this._repositionRelatedMidpoints(_f6c);this._showRelatedMidpoints(_f6c);}}this.toolbar._endOperation("VERTICES");},_showRelatedMidpoints:function(_f6d){var i,_f6e=this._getAdjacentMidpoints(_f6d.ptIndex,_f6d.segLength),_f6f=this._mpVertexMovers[_f6d.segIndex];for(i=0;i<_f6e.length;i++){var mvr=_f6f[_f6e[i]];mvr.graphic.show();mvr.refresh();}},_hideRelatedMidpoints:function(_f70){var i,_f71=this._getAdjacentMidpoints(_f70.ptIndex,_f70.segLength),_f72=this._mpVertexMovers[_f70.segIndex];for(i=0;i<_f71.length;i++){_f72[_f71[i]].graphic.hide();}},_repositionRelatedMidpoints:function(_f73){var i,_f74=this._getAdjacentMidpoints(_f73.ptIndex,_f73.segLength),_f75=this._mpVertexMovers[_f73.segIndex];for(i=0;i<_f74.length;i++){var _f76=this._getAdjacentVertices(_f74[i],_f73.segLength);var _f77=_f73.relatedGraphic.geometry.getPoint(_f73.segIndex,_f76[0]),_f78=_f73.relatedGraphic.geometry.getPoint(_f73.segIndex,_f76[1]);var _f79=new _f47({x:(_f77.x+_f78.x)/2,y:(_f77.y+_f78.y)/2,spatialReference:_f77.spatialReference.toJson()});_f75[_f74[i]].graphic.setGeometry(_f79);}},_addMidpoints:function(_f7a){var _f7b=_f7a.segIndex,_f7c=_f7a.ptIndex,_f7d=_f7a.segLength;var _f7e=_f7c+1;var i,_f7f=_f7d+1;this._mpVertexMovers[_f7b].splice(_f7c,1);var _f80=this._vertexMovers[_f7b];for(i=0;i<_f7e;i++){_f80[i].segLength+=1;}for(i=_f7e;i<_f80.length;i++){_f80[i].ptIndex+=1;_f80[i].segLength+=1;}_f7a.ptIndex=_f7e;_f7a.segLength=_f80.length+1;_f80.splice(_f7e,0,_f7a);_f7a.graphic.setSymbol(this._symbol1);_f80=this._mpVertexMovers[_f7b];for(i=0;i<_f7c;i++){_f80[i].segLength+=1;}for(i=_f7c;i<_f7d-1;i++){_f80[i].ptIndex+=1;_f80[i].segLength+=1;}var _f81=this._getAdjacentVertices(_f7c,_f7f);var _f82=this._getAdjacentVertices(_f7c+1,_f7f);var _f83,_f84;_f83=_f7a.relatedGraphic.geometry.getPoint(_f7a.segIndex,_f81[0]);_f84=_f7a.relatedGraphic.geometry.getPoint(_f7a.segIndex,_f81[1]);var _f85=new _f47({x:(_f83.x+_f84.x)/2,y:(_f83.y+_f84.y)/2,spatialReference:_f83.spatialReference.toJson()});_f83=_f7a.relatedGraphic.geometry.getPoint(_f7a.segIndex,_f82[0]);_f84=_f7a.relatedGraphic.geometry.getPoint(_f7a.segIndex,_f82[1]);var _f86=new _f47({x:(_f83.x+_f84.x)/2,y:(_f83.y+_f84.y)/2,spatialReference:_f83.spatialReference.toJson()});var mvr1=new _f46(_f85,this._symbol2,this.graphic,_f7a.segIndex,_f7c,_f7f,this,true);var mvr2=new _f46(_f86,this._symbol2,this.graphic,_f7a.segIndex,_f7c+1,_f7f,this,true);_f80.splice(_f7c,0,mvr1,mvr2);},_deleteVertex:function(_f87){var i,_f88=_f87.segIndex,_f89=_f87.ptIndex;var _f8a=this._vertexMovers[_f88];for(i=0;i<_f89;i++){_f8a[i].segLength-=1;}for(i=_f89+1;i<_f8a.length;i++){var mvr=_f8a[i];mvr.ptIndex-=1;mvr.segLength-=1;}_f8a.splice(_f89,1);var info=_f87._getInfo();_f87.destroy();this.toolbar.onVertexDelete(this.graphic,info);}});lang.mixin(GVE,{create:function(_f8b,map,_f8c){var type=_f8b.geometry.type;switch(type){case "multipoint":return new GVE.MultipointVertexEditor(_f8b,map,_f8c);break;case "polyline":return new GVE.PolylineVertexEditor(_f8b,map,_f8c);break;case "polygon":return new GVE.PolygonVertexEditor(_f8b,map,_f8c);break;}}});GVE.MultipointVertexEditor=_f41(GVE,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=_f42.connect(_f46,"onMoveStart",this,this._moveStartHandler);_f42.disconnect(this._firstMoveHandle);},destroy:function(){this.inherited(arguments);_f42.disconnect(this._moveStartHandle);},_getSegments:function(_f8d){var i,_f8e=_f8d.points,_f8f=[],sr=_f8d.spatialReference;for(i=0;i<_f8e.length;i++){var _f90=_f8e[i];_f8f.push(new _f47({x:_f90[0],y:_f90[1],spatialReference:sr.toJson()}));}return [_f8f];},_getMidpointSegments:function(_f91){return [];},_getControlPoints:function(_f92,_f93,_f94,_f95,_f96){return [];},_getGraphicsLayer:function(){return this.graphic._graphicsLayer;},_mouseOverHandler:function(evt){var _f97=evt.graphic,_f98=this._findMover(evt);if(_f98){this.toolbar.onVertexMouseOver(_f97,_f98._getInfo());this._selectedMover=_f98;if(this._canDel){this._bindCtxNode(_f98.graphic.getDojoShape().getNode());}}},_mouseOutHandler:function(evt){var _f99=evt.graphic,_f9a=this._findMover(evt);if(_f9a){this.toolbar.onVertexMouseOut(_f99,_f9a._getInfo());}},_findMover:function(evt){var i,_f9b=[].concat(this._vertexMovers[0]),_f9c=evt.target;for(i=0;i<_f9b.length;i++){var _f9d=_f9b[i];if(_f9d.graphic.getDojoShape().getNode()===_f9c){return _f9d;}}},_moveStartHandler:function(_f9e){var geom=_f9e.relatedGraphic.geometry,_f9f=_f9e.ptIndex;var _fa0=_f9e.segLength-1;var _fa1=geom.points;var _fa2=_fa1.splice(_f9f,1);_fa1.push(_fa2[0]);var j,_fa3=this._vertexMovers[0];for(j=_fa0;j>_f9f;j--){_fa3[j].ptIndex-=1;}_fa2=_fa3.splice(_f9f,1);_fa3.push(_fa2[0]);_fa2[0].ptIndex=_fa0;},_moveStopHandler:function(_fa4){this._updateRelatedGraphic(_fa4,_fa4.relatedGraphic,_fa4.graphic.geometry,_fa4.segIndex,_fa4.ptIndex,_fa4.segLength);this.toolbar._endOperation("VERTICES");},_updateRelatedGraphic:function(_fa5,_fa6,_fa7,_fa8,_fa9,_faa,add,del){var geom=_fa6.geometry;if(del){geom.removePoint(_fa9);}else{geom.setPoint(_fa9,_fa7);}_fa6.setGeometry(geom);},_deleteMidpoints:function(_fab){}});GVE.PolylineVertexEditor=_f41(GVE,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(_fac){var i,j,_fad=_fac.paths,_fae=[];for(i=0;i<_fad.length;i++){var path=_fad[i],_faf=[];for(j=0;j<path.length;j++){_faf.push(_fac.getPoint(i,j));}_fae.push(_faf);}return _fae;},_getMidpointSegments:function(_fb0){var i,j,_fb1=_fb0.paths,_fb2=[],sr=_fb0.spatialReference;for(i=0;i<_fb1.length;i++){var path=_fb1[i],_fb3=[];for(j=0;j<path.length-1;j++){var _fb4=_fb0.getPoint(i,j),_fb5=_fb0.getPoint(i,j+1);var midX=(_fb4.x+_fb5.x)/2,midY=(_fb4.y+_fb5.y)/2;var _fb6=new _f47({x:midX,y:midY,spatialReference:sr.toJson()});_fb3.push(_fb6);}_fb2.push(_fb3);}return _fb2;},_getControlPoints:function(_fb7,_fb8,_fb9,_fba,_fbb){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_fb7)){idx1=_fba;idx2=_fba+1;if(idx1>=0){pt1=map.toScreen(_fb8.getPoint(_fb9,idx1));}if(idx2<=_fbb){pt2=map.toScreen(_fb8.getPoint(_fb9,idx2));}}else{idx1=_fba-1;idx2=_fba+1;if(idx1>=0){pt1=map.toScreen(_fb8.getPoint(_fb9,idx1));}if(idx2<_fbb){pt2=map.toScreen(_fb8.getPoint(_fb9,idx2));}}return [pt1,pt2];},_getAdjacentMidpoints:function(_fbc,_fbd){var _fbe=[];var idx1=_fbc-1;if(idx1>=0){_fbe.push(idx1);}var idx2=_fbc;if(idx2<_fbd-1){_fbe.push(idx2);}return _fbe;},_getAdjacentVertices:function(_fbf,_fc0){return [_fbf,_fbf+1];},_deleteMidpoints:function(_fc1){var _fc2=_fc1.segIndex,_fc3=_fc1.ptIndex,_fc4=_fc1.segLength;var _fc5=this._mpVertexMovers[_fc2],_fc6=_fc5.length-1;var _fc7=this._getAdjacentMidpoints(_fc3,_fc4).sort();var i,min=_fc7[0];for(i=0;i<min;i++){_fc5[i].segLength-=1;}for(i=min+1;i<_fc5.length;i++){var mvr=_fc5[i];mvr.ptIndex-=1;mvr.segLength-=1;}if(_fc7.length===1){_fc5.splice(min,1)[0].destroy();}else{var _fc8=this._getAdjacentVertices(min,_fc6);var _fc9=_fc1.relatedGraphic.geometry.getPoint(_fc1.segIndex,_fc8[0]);var _fca=_fc1.relatedGraphic.geometry.getPoint(_fc1.segIndex,_fc8[1]);var _fcb=new _f47({x:(_fc9.x+_fca.x)/2,y:(_fc9.y+_fca.y)/2,spatialReference:_fc9.spatialReference.toJson()});var mvr1=new _f46(_fcb,this._symbol2,this.graphic,_fc1.segIndex,min,_fc6,this,true);var _fcc=_fc5.splice(min,_fc7.length,mvr1);for(i=0;i<_fcc.length;i++){_fcc[i].destroy();}}},_updateRelatedGraphic:function(_fcd,_fce,_fcf,_fd0,_fd1,_fd2,add,del){var geom=_fce.geometry;if(add){geom.insertPoint(_fd0,_fd1+1,_f48.fromJson(_fcf.toJson()));}else{if(del){geom.removePoint(_fd0,_fd1);}else{geom.setPoint(_fd0,_fd1,_f48.fromJson(_fcf.toJson()));}}_fce.setGeometry(geom);}});GVE.PolygonVertexEditor=_f41(GVE,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(_fd3){var i,j,_fd4=_fd3.rings,_fd5=[];for(i=0;i<_fd4.length;i++){var ring=_fd4[i],_fd6=[];for(j=0;j<ring.length-1;j++){_fd6.push(_fd3.getPoint(i,j));}_fd5.push(_fd6);}return _fd5;},_getMidpointSegments:function(_fd7){var i,j,_fd8=_fd7.rings,_fd9=[],sr=_fd7.spatialReference;for(i=0;i<_fd8.length;i++){var ring=_fd8[i],_fda=[];for(j=0;j<ring.length-1;j++){var _fdb=_fd7.getPoint(i,j),_fdc=_fd7.getPoint(i,j+1);var midX=(_fdb.x+_fdc.x)/2,midY=(_fdb.y+_fdc.y)/2;var _fdd=new _f47({x:midX,y:midY,spatialReference:sr.toJson()});_fda.push(_fdd);}_fd9.push(_fda);}return _fd9;},_getControlPoints:function(_fde,_fdf,_fe0,_fe1,_fe2){var map=this.map,idx1,idx2,pt1,pt2;if(this._isNew(_fde)){idx1=_fe1;idx2=(_fe1+1)%_fe2;}else{idx1=_fe1-1;idx1=idx1<0?(_fe2+idx1)%_fe2:idx1;idx2=(_fe1+1)%_fe2;}pt1=map.toScreen(_fdf.getPoint(_fe0,idx1));pt2=map.toScreen(_fdf.getPoint(_fe0,idx2));return [pt1,pt2];},_getAdjacentMidpoints:function(_fe3,_fe4){var idx1=_fe3-1;idx1=idx1<0?(_fe4+idx1)%_fe4:idx1;var idx2=_fe3;return [idx1,idx2];},_getAdjacentVertices:function(_fe5,_fe6){return [_fe5,(_fe5+1)%_fe6];},_deleteMidpoints:function(_fe7){var _fe8=_fe7.segIndex,_fe9=_fe7.ptIndex,_fea=_fe7.segLength;var _feb=this._mpVertexMovers[_fe8],_fec=_feb.length-1,_fed=this._getAdjacentMidpoints(_fe9,_fea).sort(),_fee,_fef,_ff0,_ff1,i,mvr1,mvr,min=_fed[0],max=_fed[_fed.length-1];if(_fe9===0){_fee=this._getAdjacentVertices(_fec-1,_fec);_fef=_fe7.relatedGraphic.geometry.getPoint(_fe7.segIndex,_fee[0]);_ff0=_fe7.relatedGraphic.geometry.getPoint(_fe7.segIndex,_fee[1]);_ff1=new _f47({x:(_fef.x+_ff0.x)/2,y:(_fef.y+_ff0.y)/2,spatialReference:_fef.spatialReference.toJson()});mvr1=new _f46(_ff1,this._symbol2,this.graphic,_fe7.segIndex,_fec-1,_fec,this,true);_feb.splice(max,1,mvr1)[0].destroy();_feb.splice(min,1)[0].destroy();for(i=0;i<_feb.length-1;i++){mvr=_feb[i];mvr.ptIndex-=1;mvr.segLength-=1;}}else{_fee=this._getAdjacentVertices(min,_fec);_fef=_fe7.relatedGraphic.geometry.getPoint(_fe7.segIndex,_fee[0]);_ff0=_fe7.relatedGraphic.geometry.getPoint(_fe7.segIndex,_fee[1]);_ff1=new _f47({x:(_fef.x+_ff0.x)/2,y:(_fef.y+_ff0.y)/2,spatialReference:_fef.spatialReference.toJson()});mvr1=new _f46(_ff1,this._symbol2,this.graphic,_fe7.segIndex,min,_fec,this,true);var _ff2=_feb.splice(min,_fed.length,mvr1);for(i=0;i<_ff2.length;i++){_ff2[i].destroy();}for(i=0;i<min;i++){_feb[i].segLength-=1;}for(i=min+1;i<_feb.length;i++){mvr=_feb[i];mvr.ptIndex-=1;mvr.segLength-=1;}}},_updateRelatedGraphic:function(_ff3,_ff4,_ff5,_ff6,_ff7,_ff8,add,del){var geom=_ff4.geometry;if(add){geom.insertPoint(_ff6,_ff7+1,_f48.fromJson(_ff5.toJson()));}else{if(del){geom.removePoint(_ff6,_ff7);if(_ff7===0){geom.setPoint(_ff6,_ff8-1,_f48.fromJson(geom.getPoint(_ff6,0).toJson()));}}else{geom.setPoint(_ff6,_ff7,_f48.fromJson(_ff5.toJson()));if(_ff7===0){geom.setPoint(_ff6,_ff8,_f48.fromJson(_ff5.toJson()));}}}_ff4.setGeometry(geom);}});if(has("extend-esri")){lang.setObject("toolbars._GraphicVertexEditor",GVE,_f45);lang.setObject("toolbars._MultipointVertexEditor",GVE.MultipointVertexEditor,_f45);lang.setObject("toolbars._PolylineVertexEditor",GVE.PolylineVertexEditor,_f45);lang.setObject("toolbars._PolygonVertexEditor",GVE.PolygonVertexEditor,_f45);}return GVE;});},"*now":function(r){r(["dojo/i18n!*preload*esri/dijit/editing/nls/Editor-all*[\"ar\",\"az\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ro\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);},"*noref":1}});define("esri/dijit/editing/Editor-all",["esri/layers/FeatureLayer","esri/toolbars/_toolbar","esri/toolbars/draw","esri/toolbars/edit","esri/tasks/geometry","esri/dijit/AttributeInspector","esri/dijit/editing/AttachmentEditor","esri/dijit/editing/Editor","esri/dijit/editing/TemplatePicker","esri/dijit/editing/Util","esri/dijit/editing/SelectionHelper"],function(_ff9,_ffa,Draw,Edit,_ffb,_ffc,_ffd,_ffe,_fff,Util,_1000){return {};});